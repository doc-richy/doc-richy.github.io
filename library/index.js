import{game as I}from"./engine.js";import*as C from"./level.js";import*as B from"./move.js";import*as a from"./sounds.js";import*as i from"./gamesounds.js";import"./typedef.js";let O=document.getElementById("main"),R=document.getElementById("infodiv"),W=document.getElementById("infoframe"),j=document.getElementById("wait-video"),r={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>r.boxSize/512,quota:void 0},g={t:0,s:0,b:-1},n={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},M=void 0,J=void 0,D=void 0,H=!1,V=!1,q=!1,U=!1,t=document.getElementById("btn-1"),s=document.getElementById("btn-2"),G=document.getElementsByClassName("floating-menu")[0];let o=!1,Q={value:!0},K=1920,Z=1080,ee=90,te=90,se=12,ae=12,p=.2,ie=.75,ne=[[{s:70,t:15.23,csec:15234},{s:106,t:80.02,csec:15930},{s:146,t:609.34,csec:60934},{s:116,t:385.03,csec:38503},{s:114,t:410.32,csec:41032},{s:163,t:1042.31,csec:104231},{s:142,t:646.3,csec:64630},{s:233,t:1017.17,csec:101717},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:267,t:2518.64,csec:251864},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}]];let oe,re,ge,e,pe,le,l,c,d,ce,de,h,he,_e,ue,_,u,ve,me,xe,v,ye,be,fe,we,ke,Se,Te,ze,Ye,$e,Fe,Xe,Ee,Le,Ne,Pe,Ae,Ie,Ce,m,x,Be,Oe,Re,We,je,Me=100,y,b,f,Je,De,He,Ve,qe,Ue,w,k,S,Ge,Qe,Ke,Ze,et,tt,st,at,it,nt,ot,rt,gt,pt,lt,ct,dt,ht,_t,ut=["12x12","14x14","16x16"],vt,mt,xt,yt,bt,T,z,Y={},$=[],F=[],X=1,E=1,ft=C.level[X-1][E-1],wt=1,kt=1,St=setInterval(()=>P.progressBar.update(),5),Tt=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),zt=[],Yt,$t=[],L,Ft,Xt,Et,Lt,N,Nt,Pt,At,It,Ct=/Mobile/i.test(navigator.userAgent),Bt=window.devicePixelRatio.toFixed(2),Ot=!1,P=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(Ot=!0),Ct&&(kt=3.5<=Bt&&Bt<=4.2?wt=1.2:2.8<=Bt&&Bt<3.5?(wt=1.5,1.2):(wt=1.6,1.5)),new I(K,Z,function(){document.body.removeChild(j),P.progressBar.remove(),clearInterval(St),t.src=P.assets["images/fullscreen_on_512_up.png"].src,t.style.width="64px",s.src=P.assets["images/sound_no_240_up.png"].src,s.style.width="64px",t.onpointerdown=e=>(o&&a.playAllNonTransform(i.fullscreen_sound),document.fullscreenElement?(document.exitFullscreen(),t.src=P.assets["images/fullscreen_on_512_up.png"].src):(O.requestFullscreen().catch(e=>console.log(e)),t.src=P.assets["images/fullscreen_off_512_up.png"].src),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),t.addEventListener("mouseover",()=>{ce?t.src=P.assets["images/fullscreen_off_512_over.png"].src:t.src=P.assets["images/fullscreen_on_512_over.png"].src}),t.addEventListener("mouseleave",()=>{ce?t.src=P.assets["images/fullscreen_off_512_up.png"].src:t.src=P.assets["images/fullscreen_on_512_up.png"].src}),s.onpointerdown=e=>((o=!o)&&a.playAllNonTransform(i.sound_sound),B.setSound(o),P.actx=new AudioContext,o?s.src=P.assets["images/sound_yes_240_up.png"].src:s.src=P.assets["images/sound_no_240_up.png"].src,e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{o?s.src=P.assets["images/sound_yes_240_over.png"].src:s.src=P.assets["images/sound_no_240_over.png"].src}),s.addEventListener("mouseleave",()=>{o?s.src=P.assets["images/sound_yes_240_up.png"].src:s.src=P.assets["images/sound_no_240_up.png"].src}),ye=[P.assets["walkDownRight.png"],P.assets["images/road_512.png"],P.assets["images/forest_512.png"],P.assets["images/box_512.png"],P.assets["images/bananas_0_512.png"],P.assets["walkUpRight.png"],P.assets["walkUpLeft.png"],P.assets["walkUpRightPush.png"],P.assets["walkUpLeftPush.png"],P.assets["walkDownRight.png"],P.assets["walkDownLeft.png"],P.assets["walkDownRightPush.png"],P.assets["walkDownLeftPush.png"],P.assets["walkRightRight.png"],P.assets["walkRightLeft.png"],P.assets["walkRightRightPush.png"],P.assets["walkRightLeftPush.png"],P.assets["walkLeftRight.png"],P.assets["walkLeftLeft.png"],P.assets["walkLeftRightPush.png"],P.assets["walkLeftLeftPush.png"]],Y.setVisible=()=>{$.forEach(e=>{e===Y.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},Y.layer=3,Y.bananasToEat=0,Y.move=B.moveScene,re=P.assets["sounds/bounce.wav"],(oe=P.assets["sounds/music.wav"]).loop=!0,function(){(Le=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-135,(Ne=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-90,(Pe=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-45;(e=P.sprite(P.assets["images/fond_ecran_950.jpg"])).x=(P.canvas.width-e.width)/2,e.y=(P.canvas.height-e.height)/2,X=X||1;E=E||1;(d=P.button([P.assets["images/menu_open_512_up.png"],P.assets["images/menu_open_512_over.png"],P.assets["images/menu_open_512_up.png"]])).x=10,d.y=10,d.pivotX=0,d.pivotY=0,d.scaleX=p,d.scaleY=p,d.layer=20,d.visible=!1,d.interactive=!1,d.press=()=>is(),(c=P.button([P.assets["images/menu_512_up.png"],P.assets["images/menu_512_over.png"],P.assets["images/menu_512_up.png"]])).x=10,c.y=10,c.pivotX=0,c.pivotY=0,c.scaleX=p,c.scaleY=p,c.layer=20,c.press=()=>is(),_=P.sprite(P.assets["images/info_level_box.png"]),(u=P.text("12x12","50px puzzler","black",20,40)).content=ut[X-1],u.x=_.width/4,u.y=_.height/2-25,(ve=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).x=_.width/2-ve.width/2,ve.y=_.height/4-ve.height/2,ve.press=()=>{o&&a.playAllNonTransform(i.scene_sound),X<3&&(os(X+=1,E),P.slide(u,u.x,u.y-40,10,["smoothstep"]),P.fadeOut(u,10),setTimeout(()=>{u.content=ut[X-1],u.y+=80,P.slide(u,u.x,_.height/2-25,15,["smoothstep"]),P.fadeIn(u,15)},100))},(me=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=_.width/2-me.width/2,me.y=3*_.height/4-ve.height/2,me.press=()=>{o&&a.playAllNonTransform(i.scene_sound),1<X&&(os(--X,E),P.slide(u,u.x,u.y+40,10,["smoothstep"]),P.fadeOut(u,10),setTimeout(()=>{u.content=ut[X-1],u.y-=80,P.slide(u,u.x,_.height/2-25,15,["smoothstep"]),P.fadeIn(u,15)},200))},(xe=P.group(_,u,ve,me)).x=-P.canvas.width,xe.y=-P.canvas.height,de=P.sprite(P.assets["images/info_level_box.png"]),(h=P.text("Level "+E,"50px puzzler","black",20,40)).x=_.width/4,h.y=_.height/2-25,(he=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.level_sound),E<9&&(E+=1,os(X,E),P.slide(h,h.x,h.y-40,10,["smoothstep"]),P.fadeOut(h,10),setTimeout(()=>{h.content="Level "+E,h.y+=80,P.slide(h,h.x,de.height/2-25,15,["smoothstep"]),P.fadeIn(h,15)},100))},he.x=de.width/2-he.width/2,he.y=de.height/4-he.height/2,(_e=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=de.width/2-_e.width/2,_e.y=3*de.height/4-he.height/2,_e.press=()=>{o&&a.playAllNonTransform(i.level_sound),1<E&&(--E,os(X,E),P.slide(h,h.x,h.y+40,10,["smoothstep"]),P.fadeOut(h,10),setTimeout(()=>{h.content="Level "+E,h.y-=80,P.slide(h,h.x,de.height/2-25,15,["smoothstep"]),P.fadeIn(h,15)},100))},h.y=de.height/2-25,(ue=P.group(de,h,he,_e)).x=P.canvas.width,ue.y=-P.canvas.height,(l=P.button([P.assets["images/b_info_up.png"],P.assets["images/b_info_over.png"],P.assets["images/b_info_up.png"]])).x=(P.canvas.width-e.width)/4-.5*l.width*wt/2,l.y=Z-l.width,l.scaleX=.5*wt,l.scaleY=.5*wt,l.press=()=>{o&&a.playAllNonTransform(i.info_sound),Q.value=!1,window.about(),Q.value=!0;let e=P.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=l.x+l.width/2,e.y=l.y+l.height/2;var t=P.slide(e,e.x,100,30);P.tweenProperty(e,"scaleX",e.scaleX,180,30),P.tweenProperty(e,"scaleY",e.scaleY,80,30);t.onComplete=()=>{R.classList.remove("hide"),R.classList.add("show"),hs(),P.remove(e)}},(le=P.button([P.assets["images/b_reset.png"],P.assets["images/b_reset.png"],P.assets["images/b_reset.png"]])).x=P.canvas.width-le.width*wt,le.y=0,le.scaleX=wt,le.scaleY=wt,le.press=()=>{o&&a.playAllNonTransform(i.reload_sound);for(let t=1;t<4;t++)for(let e=1;e<10;e++)localStorage.removeItem(`data${t}${e}_g`),localStorage.removeItem(`data${t}${e}_gl`),localStorage.removeItem(`data${t}${e}_s`),localStorage.removeItem("data"+t+e)},(pe=P.button([P.assets["images/b_play_up.png"],P.assets["images/b_play_over.png"],P.assets["images/b_play_up.png"]])).x=K,pe.y=Z,pe.scaleX=wt,pe.scaleY=wt,pe.press=()=>{o&&a.playAllNonTransform(i.play_sound),G.classList.contains("show")&&(G.classList.remove("show"),G.classList.add("hide"),is()),Le.visible=!1,Ne.visible=!1,Pe.visible=!1,P.slide(ge,P.canvas.width,P.canvas.height,30,["decelerationCubed"]),P.slide(yt,0,0,30,["decelerationCubed"]).onComplete=()=>{ls()},X=X||1,E=E||1,u.content=ut[X-1],h.content="Level "+E,os(X,E),rs(X,E),M=JSON.parse(localStorage.getItem(`data${X}${E}_g`)),J=JSON.parse(localStorage.getItem(`data${X}${E}_gl`)),D=JSON.parse(localStorage.getItem(`data${X}${E}_s`)),n=J?{...J}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},P.state=ss},P.slide(pe,P.canvas.width-(P.canvas.width-e.width)/4-pe.width/2,.75*P.canvas.height-pe.width/2,30,["decelerationCubed"]),P.slide(xe,(P.canvas.width-e.width)/4-xe.width/2,e.y+xe.height/2,30,["decelerationCubed"]),P.slide(ue,P.canvas.width-(P.canvas.width-e.width)/4-ue.width/2,e.y+ue.height/2,30,["decelerationCubed"]),ge=P.group(e,l,pe,le,ue,xe,c,d)}(),function(){(function(){bt=P.sprite(P.assets["images/infogame.png"]),z=P.group(bt);var e="60px puzzler";(T=[[P.text("First",e,"black",355,337),P.text("First",e,"black",621,337),P.text("First",e,"black",789,337),P.text("First",e,"black",1077,337),P.text("First",e,"black",1240,337),P.text("First",e,"black",1489,337),P.text("First",e,"black",1656,337)],[P.text("First",e,"black",355,564),P.text("First",e,"black",621,564),P.text("First",e,"black",789,564),P.text("First",e,"black",1077,564),P.text("First",e,"black",1240,564),P.text("First",e,"black",1489,564),P.text("First",e,"black",1656,564)],[P.text("First",e,"black",355,786),P.text("First",e,"black",621,786),P.text("First",e,"black",789,786),P.text("First",e,"black",1077,786),P.text("First",e,"black",1240,786),P.text("First",e,"black",1489,786),P.text("First",e,"black",1656,786)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),T[0][0].content="23.82",T[0][1].content="=";for(let t=0;t<3;t++)for(let e=0;e<7;e++)z.add(T[t][e]);z.visible=!1})(),z.x=(P.canvas.width-1888)/2,z.y=c.y+c.height*p+10,(Ae=P.button([P.assets["images/home_512_up.png"],P.assets["images/home_512_over.png"],P.assets["images/home_512_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.home_sound),Le.visible=!0,Ne.visible=!0,Pe.visible=!0,z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0)),os(X,E),rs(X,E),P.slide(yt,-P.canvas.width,P.canvas.height,30,["decelerationCubed"]).onComplete=()=>{ls()},P.slide(ge,0,0,30,["decelerationCubed"]),P.endGame()},Ae.x=P.canvas.width-1.1*Ae.width*p,Ae.y=10,Ae.scaleX=p,Ae.scaleY=p,(ot=P.button([P.assets["images/infogame_512_up.png"],P.assets["images/infogame_512_over.png"],P.assets["images/infogame_512_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.info_sound),z.visible?(z.visible=!1,zt.forEach(e=>e.interactive=!0)):(z.visible=!0,us("infoBtn"),zt.forEach(e=>e.interactive=!1))},ot.x=Ae.x-1.1*ot.width*p,ot.y=10,ot.scaleX=p,ot.scaleY=p,ot.visible=!1,ot.interactive=!1,$t.push(ot),(m=P.button([P.assets["images/pause_512_up.png"],P.assets["images/pause_512_over.png"],P.assets["images/pause_512_up.png"]])).press=()=>ns(),z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0));m.x=c.x,m.y=10,m.scaleX=p,m.scaleY=p,(x=P.button([P.assets["images/pause_on_512_up.png"],P.assets["images/pause_on_512_over.png"],P.assets["images/pause_on_512_up.png"]])).press=()=>ns(),z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0));x.x=c.x,x.y=10,x.scaleX=p,x.scaleY=p,x.visible=!1,x.interactive=!1,(Ie=P.button([P.assets["images/restart_512_up.png"],P.assets["images/restart_512_over.png"],P.assets["images/restart_512_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.reload_sound),z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0)),os(X,E),P.slide(yt,0,0,30,["decelerationCubed"]),P.state=ss},Ie.x=c.x+1.1*c.width*p,Ie.y=10,Ie.scaleX=p,Ie.scaleY=p,Ie.visible=!1,Ie.interactive=!1,$t.push(Ie),(Be=P.button([P.assets["images/save_512_up.png"],P.assets["images/save_512_over.png"],P.assets["images/save_512_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.save_sound),z.visible&&(z.visible=!1),vs(),P.slide(Ue,.5*P.canvas.width-380,.5*P.canvas.height-256,30)},Be.x=Ie.x+1.1*Be.width*p,Be.y=10,Be.scaleX=p,Be.scaleY=p,Be.visible=!1,Be.interactive=!1,$t.push(Be),(Ce=P.button([P.assets["images/b_about_up_128.png"],P.assets["images/b_about_over_128.png"],P.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:Ct,is_T:Ot,DPI:Bt,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:r.scaleCanvas.toFixed(2),S_X:r.scaleX.toFixed(2),S_Y:r.scaleY.toFixed(2),Q:r.quota},t={scene:X,level:E},s=[],e=(s.push(e,t,g,F),`Yo_${ut[X-1]}_Level_`+E);t=document.createElement("a"),s=new Blob([JSON.stringify(s)],{type:"text/plain"});t.setAttribute("href",URL.createObjectURL(s)),t.setAttribute("download",e.toLowerCase()+".json"),t.click(),URL.revokeObjectURL(t.href)}(),Ce.x=Ie.x,Ce.y=P.canvas.height-Ce.height-10,we=P.sprite(P.assets["images/view_420x1080.png"]),(ke=P.sprite(P.assets["images/view_420x1080.png"])).x=1500,(Ye=P.sprite(P.assets["images/step_512_neutral.png"])).x=0,Ye.y=0,Ye.scaleX=p,Ye.scaleY=p,(Fe=P.text(" : "+(F.length-1),"60px puzzler","black")).x=Ye.width*p+10,Fe.y=Ye.height*p/2-30,Fe.pivotX=0,Fe.pivotY=0,Fe.scaleX=kt,Fe.scaleY=kt,P.pushMessage(Fe),(gt=P.sprite(P.assets["images/time_512_neutral.png"])).x=0,gt.y=0,gt.scaleX=p,gt.scaleY=p,(Xe=P.text(" : ","60px puzzler","black")).x=gt.width*p+10,Xe.y=gt.height*p/2-30,Xe.pivotX=0,Xe.pivotY=0,Xe.scaleX=kt,Xe.scaleY=kt,P.pushMessage(Xe),(ct=P.sprite(P.assets["images/bananas_512_neutral.png"])).x=0,ct.y=0,ct.scaleX=p,ct.scaleY=p,(Ee=P.text(" : "+Y.bananasToEat,"60px puzzler","black")).x=ct.width*p+10,Ee.y=ct.height*p/2-30,Ee.pivotX=0,Ee.pivotY=0,Ee.scaleX=kt,Ee.scaleY=kt,P.pushMessage(Ee),(ht=P.sprite(P.assets["images/yo_level_512.png"])).x=0,ht.y=0,ht.scaleX=p,ht.scaleY=p,(_t=P.text("","40px puzzler","black")).x=ht.width*p+10,_t.y=ht.height*p/2-40,_t.pivotX=0,_t.pivotY=0,_t.scaleX=kt,_t.scaleY=kt,(vt=P.text("","40px puzzler","black")).x=ht.width*p+10,vt.y=ht.height*p/2+10,vt.pivotX=0,vt.pivotY=0,vt.scaleX=kt,vt.scaleY=kt,ps(),gs(),(rt=P.group(Ye,Fe)).x=0,rt.y=0,(lt=P.group(gt,Xe)).x=0,lt.y=0,(dt=P.group(ct,Ee)).x=0,dt.y=rt.height*p*1.1+rt.y,dt.visible=!1,$t.push(dt),(mt=P.group(ht,_t,vt)).x=0,mt.y=lt.height*p*1.1+lt.y,mt.visible=!1,$t.push(mt),(Ft=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{jt.press()},(Xt=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{Ht.press()},(Et=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{Jt.press()},(Lt=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{Rt.press()},(L=P.group(Ft,Xt,Et,Lt)).x=10,L.y=P.canvas.height/2-L.height/4*ie,L.scaleX=L.scaleY=ie,(Nt=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{jt.press()},(Pt=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{Ht.press()},(At=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{Jt.press()},(It=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{Rt.press()},(N=P.group(Nt,Pt,At,It)).x=P.canvas.width-N.width*ie-10,N.y=P.canvas.height/2-N.height/4*ie,N.scaleX=ie,N.scaleY=ie,zt.push(Ft,Xt,Et,Lt,Nt,Pt,At,It),($e=P.group(rt,dt)).x=10,$e.y=1.1*c.height*p,(pt=P.group(lt,mt)).x=P.canvas.width-we.width+10,pt.y=1.1*ot.height*p,(xt=P.group(we,ke,$e,pt,Ae,ot,Ie,m,x,Be,L,N,z,Ce)).layer=5,ls()}(),function(e,t){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(t<1&&9<t)throw new Error(`This level : ${t} is not developped yet.`);se=ae=12}else if(2===e){if(t<1&&9<t)throw new Error(`This levelToSet : ${t} is not developped yet.`);se=ae=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(t<1&&9<t)throw new Error(`This levelToSet : ${t} is not developped yet.`);se=ae=16}if(ft=C.level[e-1][t-1],E=t,X=e,v=P.gridSpecial(se,ae,ee,te,ft,ye,Y,$,r.scaleFactor(),!1,0,0),Y.activeSprite=$[4],Y.setVisible(),F=[],P.setYo(Y),P.setStepArray(F),g.b=Y.bananasToEat,P.setGameInfo(g),(be=P.sprite(P.assets["images/forest24.jpg"])).layer=-1,be.pivotX=0,be.pivotY=0,Se=P.sprite(P.assets["images/blocksBorder_12x12.png"]),Te=P.sprite(P.assets["images/blocksBorder_14x14.png"]),ze=P.sprite(P.assets["images/blocksBorder_16x16.png"]),Se.layer=Te.layer=ze.layer=4,1===X)Se.visible=!0,Te.visible=!1,ze.visible=!1,v.addChild(Se);else if(2===X)Se.visible=!1,Te.visible=!0,ze.visible=!1,v.addChild(Te);else{if(3!==X)throw new Error(`Scene playing : ${X} not possible.`);Se.visible=!1,Te.visible=!1,ze.visible=!0,v.addChild(ze)}(fe=P.group(be,v)).x=420,fe.layer=2,(yt=P.group(fe,xt)).x=-P.canvas.width,yt.y=P.canvas.height,yt.layer=-1,ls(),B.setScene(e,r),is()}(1,1),function(){k=P.sprite(P.assets["images/save_img.png"]),S=P.sprite(P.assets["images/save_img_in.png"]),Ge=P.text("temp","30px puzzler","black"),Qe=P.text("temp","30px puzzler","black"),Ke=P.text("temp","30px puzzler","black"),Ze=P.text("temp","30px puzzler","black"),et=P.text("temp","30px puzzler","black"),tt=P.text("temp","30px puzzler","black"),st=P.text("temp","30px puzzler","black"),at=P.text("temp","30px puzzler","black"),vs(),(nt=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.25*S.width-.5*nt.width*p,nt.y=S.height-1.2*nt.height*p-32,nt.scaleX=p,nt.scaleY=p,(it=P.button([P.assets["images/save_ok_512_up.png"],P.assets["images/save_ok_512_over.png"],P.assets["images/save_ok_512_up.png"]])).x=.75*S.width-.5*it.width*p,it.y=S.height-1.2*it.height*p-32,it.scaleX=p,it.scaleY=p,it.press=()=>{if(o&&a.playAllNonTransform(i.save_second_sound),U)localStorage.removeItem(`data${X}${E}_s`),localStorage.setItem(`data${X}${E}_g`,JSON.stringify(g)),localStorage.setItem(`data${X}${E}_gl`,JSON.stringify(n)),localStorage.setItem(`data${X}${E}_s`,JSON.stringify(F));else{if(M=JSON.parse(localStorage.getItem(`data${X}${E}_g`)),J=JSON.parse(localStorage.getItem(`data${X}${E}_gl`)),D=JSON.parse(localStorage.getItem(`data${X}${E}_s`)),!M)return os(X,E),void P.slide(w,w.x,P.canvas.height,30);if(os(X,E),g={...M},n={...J},F=[...D],P.setGameInfo(g),P.setStepArray(F),ps(),1===F.length)return void P.slide(w,w.x,P.canvas.height,30);{var t=F;let e=1;P.setReplayMode(!0),St=setInterval(()=>{"u"===t[e].d?Y.move("up",v,Y,$):"d"===t[e].d?Y.move("down",v,Y,$):"r"===t[e].d?Y.move("right",v,Y,$):"l"===t[e].d&&Y.move("left",v,Y,$),++e===t.length&&(clearInterval(St),P.setReplayMode(!1))},Me)}}P.slide(w,w.x,P.canvas.height,30)},nt.press=()=>{o&&a.playAllNonTransform(i.save_cancel_sound),P.slide(w,w.x,P.canvas.height,30)};var e="30px puzzler";je=P.text("Replay > ",e,"black"),y=P.text(" Slow: ",e,"black"),b=P.text(" Fast: ",e,"black"),f=P.text(" Faster: ",e,"black"),Je=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),De=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),He=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),Ve=P.sprite(P.assets["images/checked_512_up.png"]),Je.press=()=>{o&&a.playAllNonTransform(i.checkbox_sound),Ve.x=y.x+y.width,Me=200},De.press=()=>{o&&a.playAllNonTransform(i.checkbox_sound),Ve.x=b.x+b.width,Me=100},He.press=()=>{o&&a.playAllNonTransform(i.checkbox_sound),Ve.x=f.x+f.width,Me=50},qe=P.group(je,Ve,y,Je,b,De,f,He),(w=P.group(S,tt,st,at,qe,it,nt)).x=.5*P.canvas.width-.5*S.width,w.y=P.canvas.height,w.layer=50,(Oe=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.5*k.width-.5*Oe.width*p,Oe.y=k.height-1.2*Oe.height*p-32,Oe.scaleX=p,Oe.scaleY=p,Oe.press=()=>{o&&a.playAllNonTransform(i.save_cancel_sound),P.slide(Ue,Ue.x,-P.canvas.height,30)},(Re=P.button([P.assets["images/save_512_in_up.png"],P.assets["images/save_512_in_over.png"],P.assets["images/save_512_in_up.png"]])).press=()=>{o&&a.playAllNonTransform(i.save_sound);let e,t,s;q=!1,U=!0,P.slide(w,w.x,.5*P.canvas.height-.5*S.height,30),P.slide(Ue,Ue.x,-P.canvas.height,30),qe.visible=!1,s=H?(e="Already saved",t="Want to save anyway !","The last saved game will be lost."):(e="Save !",t="First time saved.","Only one saved game at a time."),ms(e,t,s)},Re.x=.25*k.width-.5*Re.width*p,Re.y=k.height-1.2*Re.height*p-32,Re.scaleX=p,Re.scaleY=p,(We=P.button([P.assets["images/save_512_out_up.png"],P.assets["images/save_512_out_over.png"],P.assets["images/save_512_out_up.png"]])).x=.75*k.width-.5*We.width*p,We.y=k.height-1.2*We.height*p-32,We.scaleX=p,We.scaleY=p,We.press=()=>{o&&a.playAllNonTransform(i.save_sound);let e,t,s;q=!0,U=!1,P.slide(w,w.x,.5*P.canvas.height-.5*S.height,30),P.slide(Ue,Ue.x,-P.canvas.height,30),H?(e="Load the game !",t="Present data will be lost.",s="Load anyway !",qe.visible=!0):(e="Can't open this game !",t="Not saved yet.",s="Only saved game can be opened.",qe.visible=!1),ms(e,t,s)},(Ue=P.group(k,Ge,Qe,Ke,Ze,et,Re,Oe,We)).x=.5*P.canvas.width-.5*k.width,Ue.y=-P.canvas.height}(),ds(),Jt.press=Dt.press=Qt.press=ts.press=()=>{Y.move("right",v,Y,$),F.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},jt.press=Mt.press=qt.press=Kt.press=()=>{Y.move("up",v,Y,$),F.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},Rt.press=Wt.press=Ut.press=Zt.press=()=>{Y.move("left",v,Y,$),F.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},Ht.press=Vt.press=Gt.press=es.press=()=>{Y.move("down",v,Y,$),F.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},Yt=[jt,Mt,qt,Kt,Ht,Vt,Gt,es,Jt,Dt,Ut,Zt,Rt,Wt,Qt,ts,Ft,Xt,Et,Lt,Nt,Pt,At,It],P.setButtonsMove(Yt,m,Q)},["images/walk_512.json","images/info_box.png","images/info_level_box.png","images/view_420x1080.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/infogame.png","images/yo_level_512.png","images/save_img.png","images/save_img_in.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","sounds/bounce.wav","sounds/music.wav","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png"],function(){0===P.progressBar.counter&&(P.progressBar.setBackgroundColor("#FFA80F"),P.progressBar.setForegroundColor("#FFEC4B"),P.progressBar.create(P.canvas,P.assets,P.canvas.width/2,100));P.progressBar.update()})),Rt=(O.appendChild(P.canvas),window.infoHide=e=>{o&&a.playAllNonTransform(i.button_sound),R.classList.remove("show"),R.classList.add("hide")},window.about=e=>{o&&Q.value&&a.playAllNonTransform(i.button_sound),W.src="./html_page/about.html"},window.general=e=>{o&&a.playAllNonTransform(i.button_sound),W.src="./html_page/general.html"},window.buttonsExplained=e=>{o&&a.playAllNonTransform(i.button_sound),W.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{o&&a.playAllNonTransform(i.button_sound),W.src="./html_page/sparebutton.html"},P.keyboard(37)),Wt=P.keyboard(100),jt=P.keyboard(38),Mt=P.keyboard(104),Jt=P.keyboard(39),Dt=P.keyboard(102),Ht=P.keyboard(40),Vt=P.keyboard(98),qt=P.keyboard(87),Ut=P.keyboard(65),Gt=P.keyboard(83),Qt=P.keyboard(68),Kt=P.keyboard(73),Zt=P.keyboard(74),es=P.keyboard(75),ts=P.keyboard(76);function ss(){0===Y.bananasToEat&&(P.pause(),P.endGame(),P.wait(1e3).then(()=>as()))}function as(){oe.volume=.3,us("end")}function is(){o&&a.playAllNonTransform(i.menu_sound),z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0)),setTimeout(()=>{c.visible?(c.visible=!1,c.interactive=!1,d.visible=!0,d.interactive=!0,P.fadeIn(d,30),P.fadeOut(c,30),G.classList.remove("hide"),G.classList.add("show")):(c.visible=!0,c.interactive=!0,d.visible=!1,d.interactive=!1,P.fadeIn(c,30),P.fadeOut(d,30),G.classList.remove("show"),G.classList.add("hide"))},200)}function ns(){o&&Q.value&&a.playAllNonTransform(i.pause_sound),z.visible&&(z.visible=!1,zt.forEach(e=>e.interactive=!0)),m.visible?(m.visible=!1,x.visible=!0,setTimeout(()=>{m.interactive=!1,P.isPlaying&&P.pause(),x.interactive=!0,$t.forEach((e,t)=>{t<=2?(e.visible=!0,e.interactive=!0):e.visible=!0})},200)):(m.visible=!0,x.visible=!1,setTimeout(()=>{m.interactive=!0,x.interactive=!1,$t.forEach((e,t)=>{t<=2?(e.visible=!1,e.interactive=!1):e.visible=!1})},200))}function os(e,t){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(t<1&&9<t)throw new Error(`This level : ${t} is not developped yet.`);se=ae=12}else if(2===e){if(t<1&&9<t)throw new Error(`This levelToSet : ${t} is not developped yet.`);se=ae=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(t<1&&9<t)throw new Error(`This levelToSet : ${t} is not developped yet.`);se=ae=16}if(ft=C.level[e-1][t-1],E=t,X=e,1e3<g.t&&(n.t=Object.values(g)[0],n.s=Object.values(g)[1],n.b=Object.values(g)[2]),fe.remove(v),Y.bananasToEat=0,v=P.gridSpecial(se,ae,ee,te,ft,ye,Y,$,r.scaleFactor(),!1,0,0),Y.activeSprite=$[4],Y.setVisible(),(F=[]).push({x:Y.activeSprite.gridX,y:Y.activeSprite.gridY,d:"s"}),P.setYo(Y),P.setStepArray(F),us("resetAll"),g.t=0,g.s=0,g.b=Y.bananasToEat,P.setGameInfo(g),ps(),1===X)Se.visible=!0,Te.visible=!1,ze.visible=!1,v.addChild(Se);else if(2===X)Se.visible=!1,Te.visible=!0,ze.visible=!1,v.addChild(Te);else{if(3!==X)throw new Error(`Scene playing : ${X} not possible.`);Se.visible=!1,Te.visible=!1,ze.visible=!0,v.addChild(ze)}fe.addChild(v),B.setScene(e,r),Fe.content=" "+(F.length-1),Ee.content=" "+Y.bananasToEat}function rs(e,t){X=e,E=t,u.content=ut[X-1],h.content="Level "+E}function gs(){Le.layer=100,Ne.layer=100,Pe.layer=100,Le.content=`is_M=${Ct} & is_T=${Ot} | DPI=${Bt} `,Ne.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,Ne.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,Ne.content+=` | VW=${visualViewport.width},VH=`+visualViewport.height,Pe.content=`S_C=${r.scaleCanvas.toFixed(2)} & S_X= ${r.scaleX.toFixed(2)} & S_Y= `+r.scaleY.toFixed(2)}function ps(){Fe.content=" "+(F.length-1),Xe.content=g.t<=0?" : .....":_s(g.t),Ee.content=" "+g.b,_t.content=ut[X-1],vt.content="     "+E}function ls(){var e=Tt*ie;Ft.points=[{x:L.gx+.406*e,y:L.gy+.406*e},{x:L.gx+0*e,y:L.gy+0*e},{x:L.gx+e,y:L.gy+0*e},{x:L.gx+.6*e,y:L.gy+.406*e}],Xt.points=[{x:L.gx+.406*e,y:L.gy+.6*e},{x:L.gx+.6*e,y:L.gy+.6*e},{x:L.gx+e,y:L.gy+e},{x:L.gx+0*e,y:L.gy+e}],Et.points=[{x:L.gx+.6*e,y:L.gy+.406*e},{x:L.gx+e,y:L.gy+0*e},{x:L.gx+e,y:L.gy+e},{x:L.gx+.6*e,y:L.gy+.6*e}],Lt.points=[{x:L.gx+.406*e,y:L.gy+.406*e},{x:L.gx+.406*e,y:L.gy+.6*e},{x:L.gx+0*e,y:L.gy+e},{x:L.gx+0*e,y:L.gy+0*e}],Nt.points=[{x:N.gx+.406*e,y:N.gy+.406*e},{x:N.gx+0*e,y:N.gy+0*e},{x:N.gx+e,y:N.gy+0*e},{x:N.gx+.6*e,y:N.gy+.406*e}],Pt.points=[{x:N.gx+.406*e,y:N.gy+.6*e},{x:N.gx+.6*e,y:N.gy+.6*e},{x:N.gx+e,y:N.gy+e},{x:N.gx+0*e,y:N.gy+e}],At.points=[{x:N.gx+.6*e,y:N.gy+.406*e},{x:N.gx+e,y:N.gy+0*e},{x:N.gx+e,y:N.gy+e},{x:N.gx+.6*e,y:N.gy+.6*e}],It.points=[{x:N.gx+.406*e,y:N.gy+.406*e},{x:N.gx+.406*e,y:N.gy+.6*e},{x:N.gx+0*e,y:N.gy+e},{x:N.gx+0*e,y:N.gy+0*e}]}function cs(){var e=document.querySelector(":root");j.width=P.canvas.width*r.scaleCanvas,e.style.setProperty("--wait-width",j.width+"px"),e.style.setProperty("--wait-left",P.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",P.canvas.offsetTop+"px")}function ds(){var e=document.querySelector(":root"),t=(getComputedStyle(e),Math.floor(c.width*p*r.scaleCanvas)),s=Math.floor(c.width*p*r.scaleCanvas),a=(P.canvas.offsetTop,10*r.scaleCanvas);let i=10;var n=P.canvas.offsetTop+c.y*r.scaleY,o=P.canvas.offsetLeft+(c.width*p+10)*r.scaleX;Ct&&(i=5),e.style.setProperty("--btn-width",t+"px"),e.style.setProperty("--btn-height",s+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",a+"px"),e.style.setProperty("--border-iframe",i+"px")}function hs(){var e=P.canvas.offsetTop+c.height*p*r.scaleCanvas+10,t=.95*(window.innerHeight-e),s=.8*window.innerWidth,a=document.getElementById("infoframe").contentWindow.document.querySelector(":root"),a=(Ct&&(a.style.setProperty("--font-p","15px"),a.style.setProperty("--margin-p-v","5px"),a.style.setProperty("--margin-p-h","10px"),a.style.setProperty("--font-header","15px"),a.style.setProperty("--font-footer","15px"),a.style.setProperty("--font-buttons","12px"),a.style.setProperty("--btn-width","80px"),a.style.setProperty("--bnt-height","25px"),a.style.setProperty("--img-w","64px"),a.style.setProperty("--img-h","64px"),a.style.setProperty("--margin-flex","5%"),a.style.setProperty("--margin-line","5px")),.1*window.innerWidth);R.style.top=e+"px",R.style.width=s+"px",R.style.height=t+"px",R.style.margin=`0  ${a}px`}function _s(e){var e=(e/1e3).toFixed(1),t=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),s=Math.floor(e/60);let a="0",i=9<s?"":"0";return 9<e%60&&(a=""),s<=0?""+a+e%60+"."+t:""+i+s+`:${a}${e%60}.`+t}function us(e){let t={};function s(i,n){if(0===i){let e=void 0,t=void 0,s=void 0,a=void 0;n.first<=0?(T[i][0].content="?",T[i][0].x=400,T[i][1].content="?"):(e=+(n.first/1e3).toFixed(1),T[i][0].content=_s(n.first),T[i][0].x=415-15*_s(n.first).length),n.second<0?(T[i][2].content="?",T[i][2].x=849,T[i][3].content="?"):(t=+(n.second/1e3).toFixed(1),T[i][2].content=_s(n.second),T[i][2].x=864-15*_s(n.second).length),void 0!==e&&void 0!==t&&(e===t?T[i][1].content="=":e<t?T[i][1].content="<":T[i][1].content=">"),n.third<=0?(T[i][4].content="?",T[i][4].x=1285,T[i][3].content="?",T[i][5].content="?"):(s=+(n.third/1e3).toFixed(1),T[i][4].content=_s(n.third),T[i][4].x=1300-15*_s(n.third).length),void 0!==t&&void 0!==s&&(t===s?T[i][3].content="=":t<s?T[i][3].content="<":T[i][3].content=">"),n.fourth<=0?(T[i][6].content="?",T[i][6].x=1701):(a=+(n.fourth/1e3).toFixed(1),T[i][6].content=_s(n.fourth),T[i][6].x=1716-15*_s(n.fourth).length),void 0!==s&&void 0!==a&&(s===a?T[i][5].content="=":s<a?T[i][5].content="<":T[i][5].content=">")}else if(1===i){let e=void 0,t=void 0,s=void 0,a=void 0;n.first<=0?(T[i][0].content="?",T[i][0].x=400,T[i][1].content="?"):(e=n.first,T[i][0].content=n.first.toString(),T[i][0].x=415-15*n.first.toString().length),n.second<0?(T[i][2].content="?",T[i][2].x=849):(t=n.second,T[i][2].content=n.second.toString(),T[i][2].x=864-15*n.second.toString().length),void 0!==e&&void 0!==t&&(n.first===n.second?T[i][1].content="=":n.first<n.second?T[i][1].content="<":T[i][1].content=">"),n.third<=0?(T[i][4].content="?",T[i][4].x=1285,T[i][3].content="?",T[i][5].content="?"):(s=n.third,T[i][4].content=n.third.toString(),T[i][4].x=1300-15*n.third.toString().length),void 0!==t&&void 0!==s&&(n.second===n.third?T[i][3].content="=":n.second<n.third?T[i][3].content="<":T[i][3].content=">"),n.fourth<=0?(T[i][6].content="?",T[i][6].x=1701,T[i][5].content="?"):(a=n.fourth,T[i][6].content=n.fourth.toString(),T[i][6].x=1716-15*n.fourth.toString().length),void 0!==s&&void 0!==a&&(n.third===n.fourth?T[i][5].content="=":n.third<n.fourth?T[i][5].content="<":T[i][5].content=">")}else if(2===i){let e=void 0,t=void 0,s=void 0,a=void 0;n.first<0?(T[i][0].content="?",T[i][0].x=400,T[i][1].content="?"):(e=n.first,T[i][0].content=n.first.toString(),T[i][0].x=415-15*n.first.toString().length),n.second<0?(T[i][2].content="?",T[i][2].x=849):(t=n.second,T[i][2].content=n.second.toString(),T[i][2].x=864-15*n.second.toString().length),void 0!==e&&void 0!==t&&(n.first===n.second?T[i][1].content="=":n.first<n.second?T[i][1].content="<":T[i][1].content=">"),n.third<0?(T[i][4].content="?",T[i][4].x=1285,T[i][3].content="?",T[i][5].content="?"):(s=n.third,T[i][4].content=n.third.toString(),T[i][4].x=1300-15*n.third.toString().length),void 0!==t&&void 0!==s&&(n.second===n.third?T[i][3].content="=":n.second<n.third?T[i][3].content="<":T[i][3].content=">"),n.fourth<0?(T[i][6].content="?",T[i][6].x=1701,T[i][5].content="?"):(a=n.fourth,T[i][6].content=n.fourth.toString(),T[i][6].x=1716-15*n.fourth.toString().length),void 0!==s&&void 0!==a&&(n.third===n.fourth?T[i][5].content="=":n.third<n.fourth?T[i][5].content="<":T[i][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,r.quota=(e/1024/1024).toFixed(1))}();function a(){t.first=n.t,t.second=g.t,t.third=n.bt,t.fourth=ne[X-1][E-1].csec,s(0,t),t.first=n.s,t.second=g.s,t.third=n.bs,t.fourth=ne[X-1][E-1].s,s(1,t),t.first=n.b,t.second=g.b,t.third=n.bb,t.fourth=0,s(2,t)}"restart"===e||"infoBtn"===e?a():"end"===e&&(n.bt=Math.min(n.bt<=0?1/0:n.bt,g.t),n.bs=Math.min(n.bs<=0?1/0:n.bs,g.s),n.bb=Math.min(n.bb<=0?1/0:n.bb,g.b),localStorage.setItem(`data${X}${E}_gl`,JSON.stringify(n)),a())}function A(e,t){return P.canvas.ctx.font=e,{width:P.canvas.ctx.measureText(t).width,height:P.canvas.ctx.measureText("M").width}}function vs(e,t,s,a,i){let n="40px puzzler",o="60px puzzler";Ct&&(n="40px puzzler",o="50px puzzler"),q=U=!1,M=JSON.parse(localStorage.getItem(`data${X}${E}_g`)),J=JSON.parse(localStorage.getItem(`data${X}${E}_gl`)),D=JSON.parse(localStorage.getItem(`data${X}${E}_s`)),i=M?(H=!0,V=!0,e="Open the game !",t=ut[X-1]+" Level:"+E,s="Time : "+_s(M.t),a="Steps : "+M.s,"Bananas : "+M.b):(H=!1,V=!1,e="Save the game !",t=ut[X-1]+" Level:"+E,s="Time : "+_s(g.t),a="Steps : "+g.s,"Bananas : "+g.b),Ge.font=o,Ge.content=e,Ge.width=A(o,e).width,Ge.height=A(o,e).height,Ge.x=.5*k.width-.5*Ge.width,Ge.y=32,Qe.font=o,Qe.content=t,Qe.width=A(o,t).width,Qe.height=A(o,t).height,Qe.x=.5*k.width-.5*Qe.width,Qe.y=Ge.y+Ge.height+10,Ke.content=s,Ke.font=n,Ke.width=A(n,s).width,Ke.height=A(n,s).height,Ke.x=.5*k.width-.5*Ke.width,Ke.y=Qe.y+Qe.height+20,Ze.content=a,Ze.font=n,Ze.width=A(n,a).width,Ze.height=A(n,a).height,Ze.x=.5*k.width-.5*Ze.width,Ze.y=Ke.y+Ke.height+10,et.content=i,et.font=n,et.width=A(n,i).width,et.height=A(n,i).height,et.x=.5*k.width-.5*et.width,et.y=Ze.y+Ze.height+10}function ms(e,t,s){let a="40px puzzler",i="60px puzzler";var n="30px puzzler",e=(Ct&&(a="40px puzzler",i="50px puzzler"),tt.font=i,tt.content=e,tt.width=A(i,e).width,tt.height=A(i,e).height,tt.x=.5*S.width-.5*tt.width,tt.y=32,st.font=i,st.content=t,st.width=A(i,t).width,st.height=A(i,t).height,st.x=.5*S.width-.5*st.width,st.y=tt.y+tt.height+10,at.content=s,at.font=a,at.width=A(a,s).width,at.height=A(a,s).height,at.x=.5*S.width-.5*at.width,at.y=st.y+st.height+20,je.font=n,je.width=A(n,"Replay > ").width,je.height=A(n,"Replay > ").height,y.font=n,y.width=A(n," Slow: ").width,y.height=A(n," Slow: ").height,b.font=n,b.width=A(n," Fast: ").width,b.height=A(n," Fast: ").height,f.font=n,f.width=A(n," Faster: ").width,f.height=A(n," Faster: ").height,Je.scaleX=Je.scaleY=.5*p,De.scaleX=De.scaleY=.5*p,He.scaleX=He.scaleY=.5*p,Ve.scaleX=Ve.scaleY=.5*p,y.x=je.width,Je.x=y.x+y.width,b.x=y.x+y.width+Je.width*p*.5,De.x=b.x+b.width,0===Ve.x&&(Ve.x=De.x),f.x=b.x+b.width+De.width*p*.5,He.x=f.x+f.width,je.y=y.y=b.y=f.y=Je.height*p*.5*.5-.5*je.height,qe.y=at.y+at.height+20,je.width+y.width+b.width+f.width+3*De.width*p*.5);qe.x=.5*S.width-.5*e}P.start(),P.scaleToWindow(r),cs(),window.addEventListener("resize",e=>{P.scaleToWindow(r),gs(),ds(),hs(),cs()}),document.addEventListener("fullscreenchange",e=>{P.scaleToWindow(r),gs(),(ce=!ce)?t.src=P.assets["images/fullscreen_off_512_over.png"].src:t.src=P.assets["images/fullscreen_on_512_over.png"].src});