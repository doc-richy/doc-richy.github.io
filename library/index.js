import{game as B}from"./engine.js";import*as O from"./level.js";import*as A from"./move.js";import*as R from"./sounds.js";import*as M from"./gamesounds.js";import{sol as N}from"./solutions.js";import"./typedef.js";let W=document.getElementById("main"),j=document.getElementById("infodiv"),D=document.getElementById("infoframe");let J=document.getElementById("logindiv"),V=document.getElementById("loginframe"),H=!1,G=document.getElementById("wait-video"),d={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>d.boxSize/512,quota:void 0};let g={t:0,s:0,b:-1},a={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},q=void 0,U=void 0,Q=void 0,K=!1,Z=!1,ee=!1,se=!1,te=!1,ie=1,ae=0,ne,oe=!1,s=document.getElementById("btn-1"),ge=document.getElementById("btn-2"),re=document.getElementById("btn-3");document.getElementById("focusp");let pe=document.getElementsByClassName("floating-menu")[0],le,de=!1,ce={value:!0},he=!1,_e=1920,ue=1080,ve=90,me=90,xe=12,we=12,c=.2,be=.75,ye=[[{s:70,t:159.01,csec:15901},{s:106,t:254.67,csec:25467},{s:133,t:405.66,csec:40566},{s:113,t:320,csec:32e3},{s:105,t:265.18,csec:26518},{s:148,t:398.34,csec:39834},{s:123,t:386.33,csec:38633},{s:191,t:682.34,csec:68234},{s:188,t:771.34,csec:77134}],[{s:176,t:673.17,csec:67317},{s:208,t:648.18,csec:64818},{s:171,t:498.68,csec:49868},{s:171,t:611.18,csec:61118},{s:123,t:328.01,csec:32801},{s:228,t:618.16,csec:61816},{s:181,t:497.84,csec:49784},{s:265,t:808.02,csec:80802},{s:213,t:549.34,csec:54934}],[{s:334,t:810.34,csec:81034},{s:346,t:1030.19,csec:103019},{s:471,t:1417.01,csec:141701},{s:358,t:1403.69,csec:140369},{s:371,t:1449.86,csec:144986},{s:626,t:2843.71,csec:284371},{s:658,t:1947.86,csec:194786},{s:576,t:2095.69,csec:209569},{s:558,t:1894.69,csec:189469}]];let fe,Se,ke,ze,Ye,Ee,Xe,$e,Le,Ce,t,h,e,Ie,Te,i,Fe,Pe,Be,Oe,n,Ae,Re,Me,o,Ne,We,je,De,Je,Ve,He,Ge,qe,Ue,Qe,Ke,Ze,es,ss,ts,is,as,r,ns,os,p,gs,rs,l,ps,ls,ds,cs,hs,_s=100,_,u,us,vs,ms,xs,ws,bs,ys,v,m,x,fs,Ss,ks,zs,Ys,Es,Xs,$s,Ls,Cs,Is,Ts,Fs,Ps,Bs,Os,As,Rs,Ms=["12x12","14x14","16x16"],Ns,Ws,js,Ds,Js,Vs,Hs,Gs,w,qs,b,Us,y,f,S,k,z,Y,E={},Qs=[],X=[],$=1,L=1,Ks=O.level[$-1][L-1],Zs=1,et=1,st=setInterval(()=>T.progressBar.update(),5),tt=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),it=[],at,nt=[],C,ot,gt,rt,pt,I,lt,dt,ct,ht,_t=/Mobile/i.test(navigator.userAgent),ut=window.devicePixelRatio.toFixed(2),vt=!1,T=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(vt=!0,document.body.classList.add("is-touch")),_t&&(et=3.5<=ut&&ut<=4.2?Zs=1.2:2.8<=ut&&ut<3.5?(Zs=1.5,1.2):(Zs=1.6,1.5)),new B(_e,ue,function(){document.body.removeChild(G),T.progressBar.remove(),clearInterval(st),s.src=T.assets["images/fullscreen_on_512_up.png"].src,s.style.width="64px",ge.src=T.assets["images/sound_no_240_up.png"].src,ge.style.width="64px",re.src=T.assets["images/b_music_512_up.png"].src,re.style.width="64px",s.onpointerdown=e=>(P(),Ie=document.fullscreenElement?(document.exitFullscreen(),s.src=T.assets["images/fullscreen_on_512_up.png"].src,!1):(W.requestFullscreen().catch(e=>console.log(e)),s.src=T.assets["images/fullscreen_off_512_up.png"].src,!0),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{Ie?s.src=T.assets["images/fullscreen_off_512_over.png"].src:s.src=T.assets["images/fullscreen_on_512_over.png"].src}),s.addEventListener("mouseleave",()=>{Ie?s.src=T.assets["images/fullscreen_off_512_up.png"].src:s.src=T.assets["images/fullscreen_on_512_up.png"].src}),ge.onpointerdown=e=>(le?"suspended"===T.actx.state&&T.actx.resume():(le=new(window.AudioContext||window.webkitAudioContext),T.setActx(le),T.actx.resume()),(de=!de)?("suspended"===T.actx.state&&T.actx.resume(),Ot(),ge.src=T.assets["images/sound_yes_240_up.png"].src,P(),A.setSoundEffect(Se)):(ge.src=T.assets["images/sound_no_240_up.png"].src,P()),A.setSound(de),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),ge.addEventListener("mouseover",()=>{de?ge.src=T.assets["images/sound_yes_240_over.png"].src:ge.src=T.assets["images/sound_no_240_over.png"].src}),ge.addEventListener("mouseleave",()=>{de?ge.src=T.assets["images/sound_yes_240_up.png"].src:ge.src=T.assets["images/sound_no_240_up.png"].src}),re.onpointerdown=e=>(le?"suspended"===T.actx.state&&T.actx.resume():(le=new(window.AudioContext||window.webkitAudioContext),T.setActx(le),T.actx.resume()),(he=!he)?("suspended"===T.actx.state&&T.actx.resume(),Ot(),fe.play(),re.src=T.assets["images/b_music_512_on_up.png"].src,P()):(re.src=T.assets["images/b_music_512_up.png"].src,P(),fe.pause()),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),re.addEventListener("mouseover",()=>{he?re.src=T.assets["images/b_music_512_on_over.png"].src:re.src=T.assets["images/b_music_512_over.png"].src}),re.addEventListener("mouseleave",()=>{he?re.src=T.assets["images/b_music_512_on_up.png"].src:re.src=T.assets["images/b_music_512_up.png"].src}),Ne=[T.assets["walkDownRight.png"],T.assets["images/road_512.png"],T.assets["images/forest_512.png"],T.assets["images/box_512.png"],T.assets["images/bananas_0_512.png"],T.assets["walkUpRight.png"],T.assets["walkUpLeft.png"],T.assets["walkUpRightPush.png"],T.assets["walkUpLeftPush.png"],T.assets["walkDownRight.png"],T.assets["walkDownLeft.png"],T.assets["walkDownRightPush.png"],T.assets["walkDownLeftPush.png"],T.assets["walkRightRight.png"],T.assets["walkRightLeft.png"],T.assets["walkRightRightPush.png"],T.assets["walkRightLeftPush.png"],T.assets["walkLeftRight.png"],T.assets["walkLeftLeft.png"],T.assets["walkLeftRightPush.png"],T.assets["walkLeftLeftPush.png"]],E.setVisible=()=>{Qs.forEach(e=>{e===E.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},E.layer=3,E.bananasToEat=0,E.move=A.moveScene,function(){(function(){y=T.sprite(T.assets["images/box_msg_border_960xx540_convert.png"]),(f=T.sprite(T.assets["images/box_msg_back_960xx540_10.png"])).pivotX=.5*f.width,f.pivotY=.5*f.height;var e="60px puzzler";(Y=T.button([T.assets["images/box_msg_ok_512_up.png"],T.assets["images/box_msg_ok_512_over.png"],T.assets["images/box_msg_ok_512_up.png"]])).scaleX=Y.scaleY=c,Y.x=.5*y.width-.5*Y.width*c,Y.y=y.height-Y.height*c-96,Y.interactive=!1,Y.press=()=>{P(),Us.visible=!1,Y.interactive=!1},(S=T.text("msg_1",e,"black")).width=F(e," msg_1: ").width,S.height=F(e," msg_1: ").height,S.x=.5*y.width-.5*S.width,S.y=100,(k=T.text("msg_2",e,"black")).width=F(e," msg_2: ").width,k.height=F(e," msg_2: ").height,k.x=.5*y.width-.5*k.width,k.y=S.y+S.height+30,(z=T.text("msg_3",e,"black")).width=F(e," msg_3: ").width,z.height=F(e," msg_3: ").height,z.x=.5*y.width-.5*z.width,z.y=k.y+k.height+30,(Us=T.group(y,f,S,k,z,Y)).x=.5*T.canvas.width-.5*y.width,Us.y=.5*T.canvas.height-.5*y.height,Us.layer=100,Us.visible=!1})(),(ss=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-135,(ts=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-90,(is=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-45;(Xe=T.sprite(T.assets["images/fond_ecran_950.jpg"])).x=(T.canvas.width-Xe.width)/2,Xe.y=(T.canvas.height-Xe.height)/2,$=$||1;L=L||1;(e=T.button([T.assets["images/menu_open_512_up.png"],T.assets["images/menu_open_512_over.png"],T.assets["images/menu_open_512_up.png"]])).x=10,e.y=10,e.pivotX=0,e.pivotY=0,e.scaleX=c,e.scaleY=c,e.layer=20,e.visible=!1,e.interactive=!1,e.press=()=>Pt(),(h=T.button([T.assets["images/menu_512_up.png"],T.assets["images/menu_512_over.png"],T.assets["images/menu_512_up.png"]])).x=.1*h.width*c,h.y=.1*h.width*c,h.pivotX=0,h.pivotY=0,h.scaleX=c,h.scaleY=c,h.layer=20,h.press=()=>Pt(),(Oe=T.sprite(T.assets["images/info_level_box.png"])).width=300,(n=T.text("12x12","50px puzzler","black",20,40)).content=Ms[$-1],n.x=Oe.width/4,n.y=Oe.height/2-25,(Ae=T.button([T.assets["images/b_scene_top_up.png"],T.assets["images/b_scene_top_over.png"],T.assets["images/b_scene_top_up.png"]])).x=Oe.width/2-Ae.width/2,Ae.y=Oe.height/4-Ae.height/2,Ae.press=()=>{P(),$<3&&($+=1,L=1,At($,L),Bt($,L),T.slide(n,n.x,n.y-40,10,["smoothstep"]),T.fadeOut(n,10),setTimeout(()=>{n.content=Ms[$-1],n.y+=80,T.slide(n,n.x,Oe.height/2-25,15,["smoothstep"]),T.fadeIn(n,15)},100))},(Re=T.button([T.assets["images/b_scene_up.png"],T.assets["images/b_scene_over.png"],T.assets["images/b_scene_up.png"]])).x=Oe.width/2-Re.width/2,Re.y=3*Oe.height/4-Ae.height/2,Re.press=()=>{P(),1<$&&(--$,L=1,At($,L),Bt($,L),T.slide(n,n.x,n.y+40,10,["smoothstep"]),T.fadeOut(n,10),setTimeout(()=>{n.content=Ms[$-1],n.y-=80,T.slide(n,n.x,Oe.height/2-25,15,["smoothstep"]),T.fadeIn(n,15)},200))},(Me=T.group(Oe,n,Ae,Re)).x=-T.canvas.width,Me.y=-T.canvas.height,Te=T.sprite(T.assets["images/info_level_box.png"]),(i=T.text("Level "+L,"50px puzzler","black",20,40)).x=Oe.width/4,i.y=Oe.height/2-25,(Fe=T.button([T.assets["images/b_scene_top_up.png"],T.assets["images/b_scene_top_over.png"],T.assets["images/b_scene_top_up.png"]])).press=()=>{P(),L<9&&(L+=1,Bt($,L),T.slide(i,i.x,i.y-40,10,["smoothstep"]),T.fadeOut(i,10),setTimeout(()=>{i.content="Level "+L,i.y+=80,T.slide(i,i.x,Te.height/2-25,15,["smoothstep"]),T.fadeIn(i,15)},100))},Fe.x=Te.width/2-Fe.width/2,Fe.y=Te.height/4-Fe.height/2,(Pe=T.button([T.assets["images/b_scene_up.png"],T.assets["images/b_scene_over.png"],T.assets["images/b_scene_up.png"]])).x=Te.width/2-Pe.width/2,Pe.y=3*Te.height/4-Fe.height/2,Pe.press=()=>{P(),1<L&&(--L,Bt($,L),T.slide(i,i.x,i.y+40,10,["smoothstep"]),T.fadeOut(i,10),setTimeout(()=>{i.content="Level "+L,i.y-=80,T.slide(i,i.x,Te.height/2-25,15,["smoothstep"]),T.fadeIn(i,15)},100))},i.y=Te.height/2-25,(Be=T.group(Te,i,Fe,Pe)).x=T.canvas.width,Be.y=-T.canvas.height,(t=T.button([T.assets["images/b_info_up.png"],T.assets["images/b_info_over.png"],T.assets["images/b_info_up.png"]])).x=(T.canvas.width-Xe.width)/4-.5*t.width*Zs/2,t.y=ue-t.width,t.scaleX=.5*Zs,t.scaleY=.5*Zs,t.press=()=>{P(),ce.value=!1,window.about(),ce.value=!0;let e=T.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=t.x+t.width/2,e.y=t.y+t.height/2;var s=T.slide(e,e.x,100,30);T.tweenProperty(e,"scaleX",e.scaleX,180,30),T.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{j.classList.remove("hide"),j.classList.add("show"),T.remove(e)}},(Le=T.button([T.assets["images/b_reset.png"],T.assets["images/b_reset.png"],T.assets["images/b_reset.png"]])).x=T.canvas.width-Le.width*Zs,Le.y=0,Le.scaleX=Zs,Le.scaleY=Zs,Le.press=()=>{P();for(let s=1;s<4;s++)for(let e=1;e<10;e++)localStorage.removeItem(`data${s}${e}_g`),localStorage.removeItem(`data${s}${e}_gl`),localStorage.removeItem(`data${s}${e}_s`),localStorage.removeItem("data"+s+e)},(Ce=T.button([T.assets["images/b_login.png"],T.assets["images/b_login.png"],T.assets["images/b_login.png"]])).x=Le.x,Ce.y=T.canvas.height-Ce.height,Ce.scaleX=Zs,Ce.scaleY=Zs,Ce.press=()=>{P(),ce.value=!1,window.login(),ce.value=!0;let e=T.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=t.x+t.width/2,e.y=t.y+t.height/2;var s=T.slide(e,e.x,100,30);T.tweenProperty(e,"scaleX",e.scaleX,180,30),T.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{J.classList.remove("hide"),J.classList.add("show"),T.remove(e)}},($e=T.button([T.assets["images/b_play_up.png"],T.assets["images/b_play_over.png"],T.assets["images/b_play_up.png"]])).x=_e,$e.y=ue,$e.scaleX=Zs,$e.scaleY=Zs,$e.press=()=>{ae=0,P(),pe.classList.contains("show")&&(pe.classList.remove("show"),pe.classList.add("hide"),Pt()),ss.visible=!1,ts.visible=!1,is.visible=!1,T.slide(Ee,T.canvas.width,T.canvas.height,30,["decelerationCubed"]),T.slide(Vs,0,0,30,["decelerationCubed"]).onComplete=()=>{Nt()},$=$||1,L=L||1,n.content=Ms[$-1],i.content="Level "+L,Bt($,L),At($,L),Dt(),T.state=Tt},T.slide($e,T.canvas.width-(T.canvas.width-Xe.width)/4-$e.width/2,.75*T.canvas.height-$e.width/2,30,["decelerationCubed"]),T.slide(Me,(T.canvas.width-Xe.width)/4-Me.width/2,Xe.y+Me.height/2,30,["decelerationCubed"]),T.slide(Be,T.canvas.width-(T.canvas.width-Xe.width)/4-Be.width/2,Xe.y+Be.height/2,30,["decelerationCubed"]),Ee=T.group(Xe,t,$e,Le,Ce,Be,Me,h,e)}(),function(){(function(){(Hs=T.sprite(T.assets["images/infogame_1024x511_1.png"])).height=525,Gs=T.sprite(T.assets["images/infogame_1024x511_border_1.png"]),qs=T.group(Hs);var e="40px puzzler";(w=[[T.text("First",e,"black",216,236),T.text("First",e,"black",470,236),T.text("First",e,"black",622,236)],[T.text("First",e,"black",216,396),T.text("First",e,"black",470,396),T.text("First",e,"black",622,396)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),w[0][0].content="23.82",w[0][1].content="=",(p=T.button([T.assets["images/restart_512_up.png"],T.assets["images/restart_512_over.png"],T.assets["images/restart_512_up.png"]])).press=()=>{os.press()},p.x=896-p.width*c*.5,p.y=160-p.width*c*.5,p.scaleX=c,p.scaleY=c,p.interactive=!1,qs.add(p),(r=T.button([T.assets["images/next_512_up.png"],T.assets["images/next_512_over.png"],T.assets["images/next_512_up.png"]])).press=()=>{ae=0,P(),b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1),localStorage.getItem(`ended_${$}_`+L)?$<=2&&L<=8&&(L+=1,Bt($,L),Dt(),T.state=Tt):Ut(`Level ${L} must be completed`,"before playing the next one.","See you soon !")},r.x=896-r.width*c*.5,r.y=330-r.width*c*.5,r.scaleX=c,r.scaleY=c,r.interactive=!1,qs.add(r);for(let s=0;s<2;s++)for(let e=0;e<3;e++)qs.add(w[s][e]);qs.x=96,qs.y=90,(b=T.group(Gs,qs)).visible=!1})(),b.x=.5*T.canvas.width-.5*Gs.width,b.y=.5*T.canvas.height-.5*Gs.height,(as=T.button([T.assets["images/home_512_up.png"],T.assets["images/home_512_over.png"],T.assets["images/home_512_up.png"]])).press=()=>{P(),ss.visible=!0,ts.visible=!0,is.visible=!0,b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0)),Bt($,L),At($,L),T.slide(Vs,-T.canvas.width,T.canvas.height,30,["decelerationCubed"]).onComplete=()=>{Nt()},T.slide(Ee,0,0,30,["decelerationCubed"]),T.endGame()},as.x=T.canvas.width-1.1*as.width*c,as.y=10,as.scaleX=c,as.scaleY=c,(Is=T.button([T.assets["images/infogame_512_up.png"],T.assets["images/infogame_512_over.png"],T.assets["images/infogame_512_up.png"]])).press=()=>{P(),Vt("infoBtn"),b.visible=!b.visible,b.visible?(r.interactive=!0,p.interactive=!0):(r.interactive=!1,p.interactive=!1)},Is.x=as.x-1.1*Is.width*c,Is.y=10,Is.scaleX=c,Is.scaleY=c,Is.visible=!1,Is.interactive=!1,nt.push(Is),(ns=T.button([T.assets["images/solution_512_up.png"],T.assets["images/solution_512_over.png"],T.assets["images/solution_512_up.png"]])).press=()=>{b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1),Gt("Replay ",Ms[$-1]+" Level "+L,"Choose the speed !"),bs.visible=!0,te=!0,T.slide(v,v.x,.5*T.canvas.height-.5*x.height,30)},ns.x=Is.x-1.1*ns.width*c,ns.y=10,ns.scaleX=c,ns.scaleY=c,ns.visible=!1,ns.interactive=!1,nt.push(ns),(rs=T.button([T.assets["images/pause_512_up.png"],T.assets["images/pause_512_over.png"],T.assets["images/pause_512_up.png"]])).press=()=>{X.length>ye[$-1][L-1].s/2&&E.bananasToEat<=Math.floor(ne/2)&&++ae>=ie&&(oe=!0),b.visible&&(b.visible=!1,it.forEach(e=>e.interactive=!0)),T.isPlaying&&T.pause(),rs.visible=!1,rs.interactive=!1,l.visible=!0,setTimeout(()=>{l.interactive=!0},200),nt.forEach((e,s)=>{e.visible=!0,e.interactive=!0}),P()},b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0));rs.x=h.x,rs.y=10,rs.scaleX=c,rs.scaleY=c,(l=T.button([T.assets["images/pause_on_512_up.png"],T.assets["images/pause_on_512_over.png"],T.assets["images/pause_on_512_up.png"]])).press=()=>{b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0)),rs.visible=!0,l.visible=!1,l.interactive=!1,setTimeout(()=>{rs.interactive=!0},200),nt.forEach((e,s)=>{e.visible=!1,e.interactive=!1}),P()},b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0));l.x=h.x,l.y=10,l.scaleX=c,l.scaleY=c,l.visible=!1,l.interactive=!1,(os=T.button([T.assets["images/restart_512_up.png"],T.assets["images/restart_512_over.png"],T.assets["images/restart_512_up.png"]])).press=()=>{P(),b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0)),Bt($,L),T.slide(Vs,0,0,30,["decelerationCubed"]),T.state=Tt},os.x=h.x+1.1*h.width*c,os.y=10,os.scaleX=c,os.scaleY=c,os.visible=!1,os.interactive=!1,nt.push(os),(ps=T.button([T.assets["images/save_512_up.png"],T.assets["images/save_512_over.png"],T.assets["images/save_512_up.png"]])).press=()=>{P(),b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1),Ht(),T.slide(ys,.5*T.canvas.width-380,.5*T.canvas.height-256,30)},ps.x=os.x+1.1*ps.width*c,ps.y=10,ps.scaleX=c,ps.scaleY=c,ps.visible=!1,ps.interactive=!1,nt.push(ps),(gs=T.button([T.assets["images/b_about_up_128.png"],T.assets["images/b_about_over_128.png"],T.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:_t,is_T:vt,DPI:ut,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:d.scaleCanvas.toFixed(2),S_X:d.scaleX.toFixed(2),S_Y:d.scaleY.toFixed(2),Q:d.quota},s={scene:$,level:L},t=[],e=(t.push(e,s,g,X),`Yo_${Ms[$-1]}_Level_`+L);s=document.createElement("a"),t=new Blob([JSON.stringify(t)],{type:"text/plain"});s.setAttribute("href",URL.createObjectURL(t)),s.setAttribute("download",e.toLowerCase()+".json"),s.click(),URL.revokeObjectURL(s.href)}(),gs.x=os.x,gs.y=T.canvas.height-gs.height-10,(Ve=T.sprite(T.assets["images/border_200x400.png"])).layer=5,(He=T.sprite(T.assets["images/border_200x400.png"])).layer=5,De=T.sprite(T.assets["images/view_420x1080_10.png"]),Je=T.sprite(T.assets["images/view_420x1080_10.png"]),De.width=Je.width=420,Je.x=1500,(Qe=T.sprite(T.assets["images/step_512_neutral.png"])).x=0,Qe.y=10,Qe.scaleX=.8*c,Qe.scaleY=.8*c,(Ke=T.text(" : "+(X.length-1),"60px puzzler","black")).x=Qe.width*c*.8+10,Ke.y=Qe.height*c/2-30,Ke.pivotX=0,Ke.pivotY=0,Ke.scaleX=et,Ke.scaleY=et,T.pushMessage(Ke),(Fs=T.sprite(T.assets["images/time_512_neutral.png"])).x=0,Fs.y=10,Fs.scaleX=.8*c,Fs.scaleY=.8*c,(Ze=T.text(" : ","60px puzzler","black")).x=Fs.width*c*.8+10,Ze.y=Fs.height*c/2-30,Ze.pivotX=0,Ze.pivotY=0,Ze.scaleX=et,Ze.scaleY=et,T.pushMessage(Ze),(Bs=T.sprite(T.assets["images/bananas_512_neutral.png"])).x=0,Bs.y=0,Bs.scaleX=.8*c,Bs.scaleY=.8*c,(es=T.text(" : "+E.bananasToEat,"60px puzzler","black")).x=Bs.width*c*.8+10,es.y=Bs.height*c*.8/2-30,es.pivotX=0,es.pivotY=0,es.scaleX=et,es.scaleY=et,T.pushMessage(es),(As=T.sprite(T.assets["images/yo_level_512.png"])).x=0,As.y=0,As.scaleX=.8*c,As.scaleY=.8*c,(Rs=T.text("","40px puzzler","black")).x=As.width*c*.8+10,Rs.y=As.height*c/2-40,Rs.pivotX=0,Rs.pivotY=0,Rs.scaleX=et,Rs.scaleY=et,(Ns=T.text("","40px puzzler","black")).x=As.width*c*.8+10,Ns.y=As.height*c*.8/2+5,Ns.pivotX=0,Ns.pivotY=0,Ns.scaleX=et,Ns.scaleY=et,Mt(),Rt(),(Ts=T.group(Qe,Ke)).x=10,Ts.y=0,(Ps=T.group(Fs,Ze)).x=10,Ps.y=0,(Os=T.group(Bs,es)).x=10,Os.y=Ts.height*c*1.1+Ts.y,(Ws=T.group(As,Rs,Ns)).x=10,Ws.y=Ps.height*c*1.1+Ps.y,(ot=T.button([T.assets["images/pad_512_up_up.png"],T.assets["images/pad_512_up_over.png"],T.assets["images/pad_512_up_up.png"]],[])).press=()=>{wt.press()},(gt=T.button([T.assets["images/pad_512_down_up.png"],T.assets["images/pad_512_down_over.png"],T.assets["images/pad_512_down_up.png"]],[])).press=()=>{St.press()},(rt=T.button([T.assets["images/pad_512_right_up.png"],T.assets["images/pad_512_right_over.png"],T.assets["images/pad_512_right_up.png"]],[])).press=()=>{yt.press()},(pt=T.button([T.assets["images/pad_512_left_up.png"],T.assets["images/pad_512_left_over.png"],T.assets["images/pad_512_left_up.png"]],[])).press=()=>{mt.press()},(C=T.group(ot,gt,rt,pt)).x=10,C.y=T.canvas.height/2-C.height/4*be,C.scaleX=C.scaleY=be,(lt=T.button([T.assets["images/pad_512_up_up.png"],T.assets["images/pad_512_up_over.png"],T.assets["images/pad_512_up_up.png"]],[])).press=()=>{wt.press()},(dt=T.button([T.assets["images/pad_512_down_up.png"],T.assets["images/pad_512_down_over.png"],T.assets["images/pad_512_down_up.png"]],[])).press=()=>{St.press()},(ct=T.button([T.assets["images/pad_512_right_up.png"],T.assets["images/pad_512_right_over.png"],T.assets["images/pad_512_right_up.png"]],[])).press=()=>{yt.press()},(ht=T.button([T.assets["images/pad_512_left_up.png"],T.assets["images/pad_512_left_over.png"],T.assets["images/pad_512_left_up.png"]],[])).press=()=>{mt.press()},(I=T.group(lt,dt,ct,ht)).x=T.canvas.width-I.width*be-10,I.y=T.canvas.height/2-I.height/4*be,I.scaleX=be,I.scaleY=be,it.push(ot,gt,rt,pt,lt,dt,ct,ht),Ve.height=He.height=2*Ts.height*c+10,(js=T.group(Ts,Os,Ve)).x=10,js.y=1.1*h.height*c,(Ds=T.group(Ps,Ws,He)).x=T.canvas.width-De.width+10,Ds.y=1.1*Is.height*c,(Js=T.group(De,Je,js,Ds,as,Is,ns,os,rs,l,ps,C,I,b,gs)).layer=5,Nt()}(),function(e,s){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1&&9<s)throw new Error(`This level : ${s} is not developped yet.`);xe=we=12}else if(2===e){if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);xe=we=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);xe=we=16}if(Ks=O.level[e-1][s-1],L=s,$=e,o=T.gridSpecial(xe,we,ve,me,Ks,Ne,E,Qs,d.scaleFactor(),!1,0,0),E.activeSprite=Qs[4],E.setVisible(),X=[],T.setYo(E),T.setStepArray(X),g.b=E.bananasToEat,T.setGameInfo(g),(We=T.sprite(T.assets["images/forest24.jpg"])).layer=-1,We.pivotX=0,We.pivotY=0,Ge=T.sprite(T.assets["images/blocksBorder_12x12.png"]),qe=T.sprite(T.assets["images/blocksBorder_14x14.png"]),Ue=T.sprite(T.assets["images/blocksBorder_16x16.png"]),Ge.layer=qe.layer=Ue.layer=4,1===$)Ge.visible=!0,qe.visible=!1,Ue.visible=!1,o.addChild(Ge);else if(2===$)Ge.visible=!1,qe.visible=!0,Ue.visible=!1,o.addChild(qe);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);Ge.visible=!1,qe.visible=!1,Ue.visible=!0,o.addChild(Ue)}(je=T.group(We,o)).x=420,je.layer=2,(Vs=T.group(je,Js)).x=-T.canvas.width,Vs.y=T.canvas.height,Vs.layer=-1,Nt(),A.setScene(e,d),Pt()}(1,1),function(){m=T.sprite(T.assets["images/save_img_1.png"]),x=T.sprite(T.assets["images/save_img_in_1.png"]),fs=T.text("temp","30px puzzler","black"),Ss=T.text("temp","30px puzzler","black"),ks=T.text("temp","30px puzzler","black"),zs=T.text("temp","30px puzzler","black"),Ys=T.text("temp","30px puzzler","black"),Es=T.text("temp","30px puzzler","black"),Xs=T.text("temp","30px puzzler","black"),$s=T.text("temp","30px puzzler","black"),Ht(),(Cs=T.button([T.assets["images/save_cancel_512_up.png"],T.assets["images/save_cancel_512_over.png"],T.assets["images/save_cancel_512_up.png"]])).x=.25*x.width-.5*Cs.width*c,Cs.y=x.height-1.2*Cs.height*c-32,Cs.scaleX=c,Cs.scaleY=c,(Ls=T.button([T.assets["images/save_ok_512_up.png"],T.assets["images/save_ok_512_over.png"],T.assets["images/save_ok_512_up.png"]])).x=.75*x.width-.5*Ls.width*c,Ls.y=x.height-1.2*Ls.height*c-32,Ls.scaleX=c,Ls.scaleY=c,Ls.press=()=>{var e,s;if(P(),te)return ae<ie?(s=ae+" Attemp(s)",e="Need "+ie,T.slide(v,v.x,T.canvas.height,30),void Ut("Can't replay !",s,e)):(s=N.find(e=>e[1].scene===$&&e[1].level===L))?(Bt($,L),g={...s[2]},X=[...s[3]],T.slide(v,v.x,T.canvas.height,30),U=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),T.setGameInfo(g),T.setStepArray(X),Mt(),1===X.length?void T.slide(v,v.x,T.canvas.height,30):void qt(X)):(Ut("Not available yet !","Come back later.","A+"),void T.slide(v,v.x,T.canvas.height,30));if(se){if(X.length<=1)return void T.slide(v,v.x,T.canvas.height,30);localStorage.removeItem(`data${$}${L}_s`),localStorage.setItem(`data${$}${L}_g`,JSON.stringify(g)),localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`data${$}${L}_s`,JSON.stringify(X))}else{if(q=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),U=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),Q=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),!q)return Bt($,L),void T.slide(v,v.x,T.canvas.height,30);if(Bt($,L),g={...q},a={...U},X=[...Q],T.setGameInfo(g),T.setStepArray(X),Mt(),1===X.length)return void T.slide(v,v.x,T.canvas.height,30);qt(X)}T.slide(v,v.x,T.canvas.height,30)},Cs.press=()=>{P(),T.slide(v,v.x,T.canvas.height,30)};var e="30px puzzler";hs=T.text("Replay > ",e,"black"),_=T.text(" Slow: ",e,"black"),u=T.text(" Fast: ",e,"black"),us=T.text(" Faster: ",e,"black"),vs=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),ms=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),xs=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),ws=T.sprite(T.assets["images/checked_512_up.png"]),vs.press=()=>{P(),ws.x=_.x+_.width,_s=200},ms.press=()=>{P(),ws.x=u.x+u.width,_s=100},xs.press=()=>{P(),ws.x=us.x+us.width,_s=25},bs=T.group(hs,ws,_,vs,u,ms,us,xs),(v=T.group(x,Es,Xs,$s,bs,Ls,Cs)).x=.5*T.canvas.width-.5*x.width,v.y=T.canvas.height,v.layer=50,(ls=T.button([T.assets["images/save_cancel_512_up.png"],T.assets["images/save_cancel_512_over.png"],T.assets["images/save_cancel_512_up.png"]])).x=.5*m.width-.5*ls.width*c,ls.y=m.height-1.2*ls.height*c-32,ls.scaleX=c,ls.scaleY=c,ls.press=()=>{P(),T.slide(ys,ys.x,-T.canvas.height,30)},(ds=T.button([T.assets["images/save_512_in_up.png"],T.assets["images/save_512_in_over.png"],T.assets["images/save_512_in_up.png"]])).press=()=>{P();let e,s,t;ee=!1,se=!0,T.slide(v,v.x,.5*T.canvas.height-.5*x.height,30),T.slide(ys,ys.x,-T.canvas.height,30),bs.visible=!1,t=K&&1<X.length?(e="Already saved",s="Want to save anyway !","The last saved game will be lost."):X.length<=1?(e="Must have some steps !",s="Steps : "+(X.length-1),"Try again !"):(e="Save !",s="First time saved.","Only one saved game at a time."),Gt(e,s,t)},ds.x=.25*m.width-.5*ds.width*c,ds.y=m.height-1.2*ds.height*c-32,ds.scaleX=c,ds.scaleY=c,(cs=T.button([T.assets["images/save_512_out_up.png"],T.assets["images/save_512_out_over.png"],T.assets["images/save_512_out_up.png"]])).x=.75*m.width-.5*cs.width*c,cs.y=m.height-1.2*cs.height*c-32,cs.scaleX=c,cs.scaleY=c,cs.press=()=>{P();let e,s,t;ee=!0,se=!1,T.slide(v,v.x,.5*T.canvas.height-.5*x.height,30),T.slide(ys,ys.x,-T.canvas.height,30),K?(e="Load the game !",s="Present data will be lost.",t="Load anyway !",bs.visible=!0):(e="Can't open this game !",s="Not saved yet.",t="Only saved game can be opened.",bs.visible=!1),Gt(e,s,t)},(ys=T.group(m,fs,Ss,ks,zs,Ys,ds,ls,cs)).x=.5*T.canvas.width-.5*m.width,ys.y=-T.canvas.height}(),jt(),yt.press=ft.press=Xt.press=It.press=()=>{E.move("right",o,E,Qs),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},wt.press=bt.press=zt.press=$t.press=()=>{E.move("up",o,E,Qs),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},mt.press=xt.press=Yt.press=Lt.press=()=>{E.move("left",o,E,Qs),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},St.press=kt.press=Et.press=Ct.press=()=>{E.move("down",o,E,Qs),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},at=[wt,bt,zt,$t,St,kt,Et,Ct,yt,ft,Yt,Lt,mt,xt,Xt,It,ot,gt,rt,pt,lt,dt,ct,ht],T.setButtonsMove(at,l,ce)},["images/walk_512.json","images/info_level_box.png","images/view_420x1080_10.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/b_login.png","images/infogame_1024x511_1.png","images/infogame_1024x511_border_1.png","images/yo_level_512.png","images/save_img_1.png","images/save_img_in_1.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/next_512_up.png","images/next_512_over.png","images/solution_512_up.png","images/solution_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/b_music_512_up.png","images/b_music_512_over.png","images/b_music_512_on_up.png","images/b_music_512_on_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png","images/border_200x400.png","images/box_msg_border_960xx540_convert.png","images/box_msg_back_960xx540_10.png","images/box_msg_ok_512_up.png","images/box_msg_ok_512_over.png","sounds/tamtam.mp3","sounds/eatbananas.wav","sounds/hit_wall.wav","sounds/push.wav","sounds/push2.wav"],function(){0===T.progressBar.counter&&(T.progressBar.setBackgroundColor("#FFA80F"),T.progressBar.setForegroundColor("#FFEC4B"),T.progressBar.create(T.canvas,T.assets,T.canvas.width/2,100));T.progressBar.update()})),mt=(W.appendChild(T.canvas),window.login=e=>{P(),V.src="./html_page/login.html"},window.loginHide=(e,s,t)=>{P(),J.classList.remove("show"),J.classList.add("hide"),W.focus(),"yotesteur"===s&&"Yo&Testeur"===t?(H=!0,Ut("Good username","Good password","Let's go!")):(Ut("Something goes wrong","Not a valid user","Retry!"),H=!1)},window.infoHide=e=>{P(),j.classList.remove("show"),j.classList.add("hide"),W.focus()},window.about=e=>{P(),D.src="./html_page/about.html"},window.general=e=>{P(),D.src="./html_page/general.html"},window.buttonsExplained=e=>{P(),D.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{P(),D.src="./html_page/sparebutton.html",P()},T.keyboard(37)),xt=T.keyboard(100),wt=T.keyboard(38),bt=T.keyboard(104),yt=T.keyboard(39),ft=T.keyboard(102),St=T.keyboard(40),kt=T.keyboard(98),zt=T.keyboard(87),Yt=T.keyboard(65),Et=T.keyboard(83),Xt=T.keyboard(68),$t=T.keyboard(73),Lt=T.keyboard(74),Ct=T.keyboard(75),It=T.keyboard(76);function Tt(){0===E.bananasToEat&&(T.pause(),T.endGame(),T.wait(1e3).then(()=>Ft()))}function Ft(){te?te=!1:(Vt("end"),ce.value=!1,rs.visible&&rs.press(),ce.value=!0,b.visible=!0,p.interactive=!0,r.interactive=!0)}function Pt(){P(),b.visible&&(b.visible=!1,p.interactive=!1,r.interactive=!1,it.forEach(e=>e.interactive=!0)),setTimeout(()=>{h.visible?(h.visible=!1,h.interactive=!1,e.visible=!0,e.interactive=!0,T.fadeIn(e,30),T.fadeOut(h,30),pe.classList.remove("hide"),pe.classList.add("show")):(h.visible=!0,h.interactive=!0,e.visible=!1,e.interactive=!1,T.fadeIn(h,30),T.fadeOut(e,30),pe.classList.remove("show"),pe.classList.add("hide"))},200)}function Bt(e,s){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1||9<s)throw new Error(`This level : ${s} is not developped yet.`);xe=we=12}else if(2===e){if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);xe=we=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);xe=we=16}if(Ks=O.level[e-1][s-1],L=s,$=e,1<s&&2<=e&&!H)Ut("You are not allowed","to continue.","Not a tester."),--L;else{if(1e3<g.t&&(a.t=Object.values(g)[0],a.s=Object.values(g)[1],a.b=Object.values(g)[2]),je.remove(o),E.bananasToEat=0,o=T.gridSpecial(xe,we,ve,me,Ks,Ne,E,Qs,d.scaleFactor(),!1,0,0),E.activeSprite=Qs[4],E.setVisible(),(X=[]).push({x:E.activeSprite.gridX,y:E.activeSprite.gridY,d:"s"}),T.setYo(E),T.setStepArray(X),Vt("resetAll"),g.t=0,g.s=0,g.b=E.bananasToEat,ne=E.bananasToEat,Dt(),T.setGameInfo(g),Mt(),1===$)Ge.visible=!0,qe.visible=!1,Ue.visible=!1,o.addChild(Ge);else if(2===$)Ge.visible=!1,qe.visible=!0,Ue.visible=!1,o.addChild(qe);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);Ge.visible=!1,qe.visible=!1,Ue.visible=!0,o.addChild(Ue)}je.addChild(o),A.setScene(e,d),Ke.content=" "+(X.length-1),es.content=" "+E.bananasToEat}}function Ot(){0<T.soundsArrayGlobal.length&&(T.soundsArrayGlobal.length=0),(Se=T.assets["sounds/eatbananas.wav"]).volume=10,(ke=T.assets["sounds/hit_wall.wav"]).loop=!1,ke.volume=1,(ze=T.assets["sounds/push.wav"]).loop=!1,ze.volume=10,(Ye=T.assets["sounds/push2.wav"]).loop=!1,Ye.volume=10,setTimeout(()=>{A.setSoundEffect(Se,ke,ze,Ye)},2e3),(fe=T.assets["sounds/tamtam.mp3"]).loop=!0,fe.volume=.2;["eat_bananas_sound","button_sound","move_block_sound","elephan_sound","wall_sound","tiger_sound"].forEach(e=>{T.addSoundsArray(M[e])})}function At(e,s){$=e,L=s,n.content=Ms[$-1],i.content="Level "+L}function Rt(){ss.layer=100,ts.layer=100,is.layer=100,ss.content=`is_M=${_t} & is_T=${vt} | DPI=${ut} `,ts.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,ts.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,ts.content+=` | VW=${visualViewport.width.toFixed(2)},VH=`+visualViewport.height.toFixed(2),is.content=`S_C=${d.scaleCanvas.toFixed(2)} & S_X= ${d.scaleX.toFixed(2)} & S_Y= `+d.scaleY.toFixed(2)}function Mt(){Ke.content=" "+(X.length-1),Ze.content=g.t<=0?" : .....":Jt(g.t),es.content=" "+g.b,Rs.content=Ms[$-1],Ns.content="     "+L}function Nt(){var e=tt*be;ot.points=[{x:C.gx+.406*e,y:C.gy+.406*e},{x:C.gx+0*e,y:C.gy+0*e},{x:C.gx+e,y:C.gy+0*e},{x:C.gx+.6*e,y:C.gy+.406*e}],gt.points=[{x:C.gx+.406*e,y:C.gy+.6*e},{x:C.gx+.6*e,y:C.gy+.6*e},{x:C.gx+e,y:C.gy+e},{x:C.gx+0*e,y:C.gy+e}],rt.points=[{x:C.gx+.6*e,y:C.gy+.406*e},{x:C.gx+e,y:C.gy+0*e},{x:C.gx+e,y:C.gy+e},{x:C.gx+.6*e,y:C.gy+.6*e}],pt.points=[{x:C.gx+.406*e,y:C.gy+.406*e},{x:C.gx+.406*e,y:C.gy+.6*e},{x:C.gx+0*e,y:C.gy+e},{x:C.gx+0*e,y:C.gy+0*e}],lt.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+0*e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+.6*e,y:I.gy+.406*e}],dt.points=[{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+.6*e,y:I.gy+.6*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+e}],ct.points=[{x:I.gx+.6*e,y:I.gy+.406*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+.6*e,y:I.gy+.6*e}],ht.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+0*e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+0*e}]}function Wt(){var e=document.querySelector(":root");G.width=T.canvas.width*d.scaleCanvas,e.style.setProperty("--wait-width",G.width+"px"),e.style.setProperty("--wait-left",T.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",T.canvas.offsetTop+"px")}function jt(){var e=document.querySelector(":root"),s=(getComputedStyle(e),Math.floor(h.width*c*d.scaleCanvas)),t=Math.floor(h.width*c*d.scaleCanvas),i=10*d.scaleCanvas,a=.2*s,n=T.canvas.offsetTop+h.y*d.scaleCanvas,o=T.canvas.offsetLeft+(h.width*c+10)*d.scaleCanvas,g=T.canvas.offsetTop+h.width*c*d.scaleCanvas*1.15,r=.95*(window.innerHeight-n-h.width*c*d.scaleCanvas),p=.95*window.innerWidth,l=.025*window.innerWidth;e.style.setProperty("--btn-width",s+"px"),e.style.setProperty("--btn-height",t+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",i+"px"),e.style.setProperty("--border-iframe",a+"px"),e.style.setProperty("--iframe-top",g+"px"),e.style.setProperty("--iframe-width",p+"px"),e.style.setProperty("--iframe-left",l+"px"),e.style.setProperty("--iframe-right",l+"px"),e.style.setProperty("--iframe-height",r+"px")}function Dt(){q=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),U=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),Q=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=U?{...U}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1}}function Jt(e){var e=(e/1e3).toFixed(1),s=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),t=Math.floor(e/60);let i="0",a=9<t?"":"0";return 9<e%60&&(i=""),t<=0?""+i+e%60+"."+s:""+a+t+`:${i}${e%60}.`+s}function Vt(e){let s={};function t(a,n){var e="40px puzzler";let s=void 0,t=void 0,i=void 0;if(0===a)n.first<0?(w[a][0].content="?",w[a][0].x=272-.5*F(e,"?").width):(s=+(n.first/1e3).toFixed(1),w[a][0].content=Jt(n.first),w[a][0].x=272-.5*F(e,Jt(n.first)).width),n.second<=0?(w[a][1].content="?",w[a][1].x=480-.5*F(e,"?").width):(t=+(n.second/1e3).toFixed(1),w[a][1].content=Jt(n.second),w[a][1].x=480-.5*F(e,Jt(n.second)).width),n.third<=0?(w[a][2].content="?",w[a][2].x=672-.5*F(e,"?").width):(i=+(n.third/1e3).toFixed(1),w[a][2].content=Jt(n.third),w[a][2].x=672-.5*F(e,Jt(n.third)).width);else if(1===a)n.first<0?(w[a][0].content="?",w[a][0].x=272-.5*F(e,"?").width):(s=n.first,w[a][0].content=n.first.toString(),w[a][0].x=272-.5*F(e,n.first.toString()).width),n.second<=0?(w[a][1].content="?",w[a][1].x=480-.5*F(e,"?").width):(t=n.second,w[a][1].content=n.second.toString(),w[a][1].x=480-.5*F(e,n.second.toString()).width),n.third<=0?(w[a][2].content="?",w[a][2].x=672-.5*F(e,"?").width):(i=n.third,w[a][2].content=n.third.toString(),w[a][2].x=672-.5*F(e,n.third.toString()).width);else if(2===a){let e=void 0,s=void 0,t=void 0,i=void 0;n.first<0?(w[a][0].content="?",w[a][0].x=405,w[a][1].content="?"):(e=n.first,w[a][0].content=n.first.toString(),w[a][0].x=415-10*n.first.toString().length),n.second<0?(w[a][2].content="?",w[a][2].x=854):(s=n.second,w[a][2].content=n.second.toString(),w[a][2].x=864-10*n.second.toString().length),void 0!==e&&void 0!==s&&(n.first===n.second?w[a][1].content="=":n.first<n.second?w[a][1].content="<":w[a][1].content=">"),n.third<0?(w[a][4].content="?",w[a][4].x=1290,w[a][3].content="?",w[a][5].content="?"):(t=n.third,w[a][4].content=n.third.toString(),w[a][4].x=1300-10*n.third.toString().length),void 0!==s&&void 0!==t&&(n.second===n.third?w[a][3].content="=":n.second<n.third?w[a][3].content="<":w[a][3].content=">"),n.fourth<0?(w[a][6].content="?",w[a][6].x=1706,w[a][5].content="?"):(i=n.fourth,w[a][6].content=n.fourth.toString(),w[a][6].x=1716-10*n.fourth.toString().length),void 0!==t&&void 0!==i&&(n.third===n.fourth?w[a][5].content="=":n.third<n.fourth?w[a][5].content="<":w[a][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,d.quota=(e/1024/1024).toFixed(1))}();function i(){s.first=g.t,s.second=a.bt,s.third=ye[$-1][L-1].csec,t(0,s),s.first=g.s,s.second=a.bs,s.third=ye[$-1][L-1].s,t(1,s)}"restart"===e||"infoBtn"===e?i():"end"===e&&(a.bt=Math.min(a.bt<=0?1/0:a.bt,g.t),a.bs=Math.min(a.bs<=0?1/0:a.bs,g.s),a.bb=Math.min(a.bb<=0?1/0:a.bb,g.b),a.t=g.t,a.s=g.s,a.b=g.b,localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`ended_${$}_`+L,"1"),i())}function F(e,s){return T.canvas.ctx.font=e,{width:T.canvas.ctx.measureText(s).width,height:T.canvas.ctx.measureText("M").width}}function Ht(e,s,t,i,a){let n="40px puzzler",o="60px puzzler";_t&&(n="40px puzzler",o="50px puzzler"),ee=se=!1,q=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),U=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),Q=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=q?(K=!0,Z=!0,e="Open the game !",s=Ms[$-1]+" Level:"+L,t="Time : "+Jt(q.t),i="Steps : "+q.s,"Bananas : "+q.b):(K=!1,Z=!1,e="Save the game !",s=Ms[$-1]+" Level:"+L,t="Time : "+Jt(g.t),i="Steps : "+g.s,"Bananas : "+g.b),fs.font=o,fs.content=e,fs.width=F(o,e).width,fs.height=F(o,e).height,fs.x=.5*m.width-.5*fs.width,fs.y=32,Ss.font=o,Ss.content=s,Ss.width=F(o,s).width,Ss.height=F(o,s).height,Ss.x=.5*m.width-.5*Ss.width,Ss.y=fs.y+fs.height+10,ks.content=t,ks.font=n,ks.width=F(n,t).width,ks.height=F(n,t).height,ks.x=.5*m.width-.5*ks.width,ks.y=Ss.y+Ss.height+20,zs.content=i,zs.font=n,zs.width=F(n,i).width,zs.height=F(n,i).height,zs.x=.5*m.width-.5*zs.width,zs.y=ks.y+ks.height+10,Ys.content=a,Ys.font=n,Ys.width=F(n,a).width,Ys.height=F(n,a).height,Ys.x=.5*m.width-.5*Ys.width,Ys.y=zs.y+zs.height+10}function Gt(e,s,t){let i="40px puzzler",a="60px puzzler";var n="30px puzzler",e=(_t&&(i="40px puzzler",a="50px puzzler"),Es.font=a,Es.content=e,Es.width=F(a,e).width,Es.height=F(a,e).height,Es.x=.5*x.width-.5*Es.width,Es.y=32,Xs.font=a,Xs.content=s,Xs.width=F(a,s).width,Xs.height=F(a,s).height,Xs.x=.5*x.width-.5*Xs.width,Xs.y=Es.y+Es.height+10,$s.content=t,$s.font=i,$s.width=F(i,t).width,$s.height=F(i,t).height,$s.x=.5*x.width-.5*$s.width,$s.y=Xs.y+Xs.height+20,hs.font=n,hs.width=F(n,"Replay > ").width,hs.height=F(n,"Replay > ").height,_.font=n,_.width=F(n," Slow: ").width,_.height=F(n," Slow: ").height,u.font=n,u.width=F(n," Fast: ").width,u.height=F(n," Fast: ").height,us.font=n,us.width=F(n," Faster: ").width,us.height=F(n," Faster: ").height,vs.scaleX=vs.scaleY=.5*c,ms.scaleX=ms.scaleY=.5*c,xs.scaleX=xs.scaleY=.5*c,ws.scaleX=ws.scaleY=.5*c,_.x=hs.width,vs.x=_.x+_.width,u.x=_.x+_.width+vs.width*c*.5,ms.x=u.x+u.width,0===ws.x&&(ws.x=ms.x),us.x=u.x+u.width+ms.width*c*.5,xs.x=us.x+us.width,hs.y=_.y=u.y=us.y=vs.height*c*.5*.5-.5*hs.height,bs.y=$s.y+$s.height+20,hs.width+_.width+u.width+us.width+3*ms.width*c*.5);bs.x=.5*x.width-.5*e}function qt(e){de&&A.setSound(!1);let s=1;T.setReplayMode(!0),st=setInterval(()=>{T.tweens.length<=0&&("u"===e[s].d?E.move("up",o,E,Qs):"d"===e[s].d?E.move("down",o,E,Qs):"r"===e[s].d?E.move("right",o,E,Qs):"l"===e[s].d&&E.move("left",o,E,Qs),++s===e.length)&&(clearInterval(st),T.setReplayMode(!1),de&&A.setSound(!0),te)&&setTimeout(()=>{te=!1,Bt($,L)},2e3)},_s)}function Ut(e="Message 1",s="Message 2",t="Message 3"){var i="60px puzzler",e=(Y.visible=!1,Us.visible=!0,S.content=e,S.font=i,S.width=F(i,e).width,S.height=F(i,e).height,S.x=.5*y.width-.5*S.width,S.y=100,S.visible=!1,k.content=s,k.font=i,k.width=F(i,s).width,k.height=F(i,s).height,k.x=.5*y.width-.5*k.width,k.y=S.y+S.height+30,k.visible=!1,z.content=t,z.font=i,z.width=F(i,t).width,z.height=F(i,t).height,z.x=.5*y.width-.5*z.width,z.y=k.y+k.height+30,z.visible=!1,f.width=y.width,f.x=y.x,f.height=y.height,f.y=y.y,T.tweenProperty(f,"width",f.width,f.width-192,60));T.tweenProperty(f,"height",f.height,f.height-192,60),T.tweenProperty(f,"x",f.x,f.x+96,60),T.tweenProperty(f,"y",f.y,f.y+96,60),e.onComplete=()=>{Y.visible=!0,Y.interactive=!0,S.visible=!0,k.visible=!0,z.visible=!0}}function P(){de&&ce.value&&R.playSoundsArray(M.button_sound)}T.start(),T.scaleToWindow(d),Wt(),window.addEventListener("resize",e=>{T.scaleToWindow(d),Rt(),jt(),Wt()}),document.addEventListener("fullscreenchange",e=>{T.scaleToWindow(d),Rt(),(Ie=!Ie)?s.src=T.assets["images/fullscreen_off_512_over.png"].src:s.src=T.assets["images/fullscreen_on_512_over.png"].src});