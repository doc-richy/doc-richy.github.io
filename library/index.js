import{game as B}from"./engine.js";import*as O from"./level.js";import*as A from"./move.js";import*as R from"./sounds.js";import*as M from"./gamesounds.js";import{sol as W}from"./solutions.js";import"./typedef.js";let N=document.getElementById("main"),j=document.getElementById("infodiv"),D=document.getElementById("infoframe");let J=document.getElementById("logindiv");document.getElementById("loginframe");let V=!1,H=document.getElementById("wait-video"),g={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>g.boxSize/512,quota:void 0};let r={t:0,s:0,b:-1},a={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},q=void 0,G=void 0,U=void 0,Q=!1,K=!1,Z=!1,ee=!1,se=!1,te=1,ie=0,ae,ne=!1,s=document.getElementById("btn-1"),oe=document.getElementById("btn-2"),ge=document.getElementById("btn-3"),re=document.getElementsByClassName("floating-menu")[0],pe,le=!1,de={value:!0},ce=!1,he=1920,_e=1080,ue=90,me=90,ve=12,xe=12,p=.2,we=.75,ye=[[{s:70,t:159.01,csec:15901},{s:106,t:254.67,csec:25467},{s:133,t:405.66,csec:40566},{s:113,t:320,csec:32e3},{s:111,t:358.17,csec:35817},{s:148,t:398.34,csec:39834},{s:123,t:386.33,csec:38633},{s:191,t:682.34,csec:68234},{s:188,t:771.34,csec:77134}],[{s:176,t:673.17,csec:67317},{s:218,t:759.52,csec:75952},{s:171,t:498.68,csec:49868},{s:365,t:4185.79,csec:418579},{s:65,t:18.02,csec:15930},{s:272,t:2850.8,csec:285080},{s:65,t:18.02,csec:15930},{s:305,t:5113.09,csec:511309},{s:335,t:3441.87,csec:344187}],[{s:334,t:810.34,csec:81034},{s:65,t:18.02,csec:15930},{s:471,t:1417.01,csec:141701},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}]];let be,fe,Se,ke,ze,Ye,Ee,$e,Xe,Le,Ie,l,e,Te,Pe,t,Ce,Fe,Be,Oe,i,Ae,Re,Me,n,We,Ne,je,De,Je,Ve,He,qe,Ge,Ue,Qe,Ke,Ze,es,ss,ts,is,as,o,ns,os,d,gs,rs,c,ps,ls,ds,cs,hs,_s=100,h,_,us,ms,vs,xs,ws,ys,bs,u,m,v,fs,Ss,ks,zs,Ys,Es,$s,Xs,Ls,Is,Ts,Ps,Cs,Fs,Bs,Os,As,Rs,Ms=["12x12","14x14","16x16"],Ws,Ns,js,Ds,Js,Vs,Hs,qs,x,Gs,w,Us,y,b,f,S,k,z,Y={},E=[],$=[],X=1,L=1,Qs=O.level[X-1][L-1],Ks=1,Zs=1,et=setInterval(()=>P.progressBar.update(),5),st=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),tt=[],it,at=[],I,nt,ot,gt,rt,T,pt,lt,dt,ct,ht=/Mobile/i.test(navigator.userAgent),_t=window.devicePixelRatio.toFixed(2),ut=!1,P=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(ut=!0,document.body.classList.add("is-touch")),ht&&(Zs=3.5<=_t&&_t<=4.2?Ks=1.2:2.8<=_t&&_t<3.5?(Ks=1.5,1.2):(Ks=1.6,1.5)),new B(he,_e,function(){document.body.removeChild(H),P.progressBar.remove(),clearInterval(et),s.src=P.assets["images/fullscreen_on_512_up.png"].src,s.style.width="64px",oe.src=P.assets["images/sound_no_240_up.png"].src,oe.style.width="64px",ge.src=P.assets["images/b_music_512_up.png"].src,ge.style.width="64px",s.onpointerdown=e=>(F(),Te=document.fullscreenElement?(document.exitFullscreen(),s.src=P.assets["images/fullscreen_on_512_up.png"].src,!1):(N.requestFullscreen().catch(e=>console.log(e)),s.src=P.assets["images/fullscreen_off_512_up.png"].src,!0),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{Te?s.src=P.assets["images/fullscreen_off_512_over.png"].src:s.src=P.assets["images/fullscreen_on_512_over.png"].src}),s.addEventListener("mouseleave",()=>{Te?s.src=P.assets["images/fullscreen_off_512_up.png"].src:s.src=P.assets["images/fullscreen_on_512_up.png"].src}),oe.onpointerdown=e=>(pe?"suspended"===P.actx.state&&P.actx.resume():(pe=new(window.AudioContext||window.webkitAudioContext),P.setActx(pe),P.actx.resume()),(le=!le)?("suspended"===P.actx.state&&P.actx.resume(),Bt(),oe.src=P.assets["images/sound_yes_240_up.png"].src,F(),A.setSoundEffect(fe)):(oe.src=P.assets["images/sound_no_240_up.png"].src,F()),A.setSound(le),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),oe.addEventListener("mouseover",()=>{le?oe.src=P.assets["images/sound_yes_240_over.png"].src:oe.src=P.assets["images/sound_no_240_over.png"].src}),oe.addEventListener("mouseleave",()=>{le?oe.src=P.assets["images/sound_yes_240_up.png"].src:oe.src=P.assets["images/sound_no_240_up.png"].src}),ge.onpointerdown=e=>(pe?"suspended"===P.actx.state&&P.actx.resume():(pe=new(window.AudioContext||window.webkitAudioContext),P.setActx(pe),P.actx.resume()),(ce=!ce)?("suspended"===P.actx.state&&P.actx.resume(),Bt(),be.play(),ge.src=P.assets["images/b_music_512_on_up.png"].src,F()):(ge.src=P.assets["images/b_music_512_up.png"].src,F(),be.pause()),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),ge.addEventListener("mouseover",()=>{ce?ge.src=P.assets["images/b_music_512_on_over.png"].src:ge.src=P.assets["images/b_music_512_over.png"].src}),ge.addEventListener("mouseleave",()=>{ce?ge.src=P.assets["images/b_music_512_on_up.png"].src:ge.src=P.assets["images/b_music_512_up.png"].src}),We=[P.assets["walkDownRight.png"],P.assets["images/road_512.png"],P.assets["images/forest_512.png"],P.assets["images/box_512.png"],P.assets["images/bananas_0_512.png"],P.assets["walkUpRight.png"],P.assets["walkUpLeft.png"],P.assets["walkUpRightPush.png"],P.assets["walkUpLeftPush.png"],P.assets["walkDownRight.png"],P.assets["walkDownLeft.png"],P.assets["walkDownRightPush.png"],P.assets["walkDownLeftPush.png"],P.assets["walkRightRight.png"],P.assets["walkRightLeft.png"],P.assets["walkRightRightPush.png"],P.assets["walkRightLeftPush.png"],P.assets["walkLeftRight.png"],P.assets["walkLeftLeft.png"],P.assets["walkLeftRightPush.png"],P.assets["walkLeftLeftPush.png"]],Y.setVisible=()=>{E.forEach(e=>{e===Y.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},Y.layer=3,Y.bananasToEat=0,Y.move=A.moveScene,function(){(function(){y=P.sprite(P.assets["images/box_msg_border_960xx540_convert.png"]),(b=P.sprite(P.assets["images/box_msg_back_960xx540_10.png"])).pivotX=.5*b.width,b.pivotY=.5*b.height;var e="60px puzzler";(z=P.button([P.assets["images/box_msg_ok_512_up.png"],P.assets["images/box_msg_ok_512_over.png"],P.assets["images/box_msg_ok_512_up.png"]])).scaleX=z.scaleY=p,z.x=.5*y.width-.5*z.width*p,z.y=y.height-z.height*p-96,z.interactive=!1,z.press=()=>{F(),Us.visible=!1,z.interactive=!1},(f=P.text("msg_1",e,"black")).width=C(e," msg_1: ").width,f.height=C(e," msg_1: ").height,f.x=.5*y.width-.5*f.width,f.y=100,(S=P.text("msg_2",e,"black")).width=C(e," msg_2: ").width,S.height=C(e," msg_2: ").height,S.x=.5*y.width-.5*S.width,S.y=f.y+f.height+30,(k=P.text("msg_3",e,"black")).width=C(e," msg_3: ").width,k.height=C(e," msg_3: ").height,k.x=.5*y.width-.5*k.width,k.y=S.y+S.height+30,(Us=P.group(y,b,f,S,k,z)).x=.5*P.canvas.width-.5*y.width,Us.y=.5*P.canvas.height-.5*y.height,Us.layer=100,Us.visible=!1})(),(ss=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-135,(ts=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-90,(is=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-45;(Ee=P.sprite(P.assets["images/fond_ecran_950.jpg"])).x=(P.canvas.width-Ee.width)/2,Ee.y=(P.canvas.height-Ee.height)/2,X=X||1;L=L||1;(e=P.button([P.assets["images/menu_open_512_up.png"],P.assets["images/menu_open_512_over.png"],P.assets["images/menu_open_512_up.png"]])).x=10,e.y=10,e.pivotX=0,e.pivotY=0,e.scaleX=p,e.scaleY=p,e.layer=20,e.visible=!1,e.interactive=!1,e.press=()=>Ct(),(l=P.button([P.assets["images/menu_512_up.png"],P.assets["images/menu_512_over.png"],P.assets["images/menu_512_up.png"]])).x=10,l.y=10,l.pivotX=0,l.pivotY=0,l.scaleX=p,l.scaleY=p,l.layer=20,l.press=()=>Ct(),(Oe=P.sprite(P.assets["images/info_level_box.png"])).width=300,(i=P.text("12x12","50px puzzler","black",20,40)).content=Ms[X-1],i.x=Oe.width/4,i.y=Oe.height/2-25,(Ae=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).x=Oe.width/2-Ae.width/2,Ae.y=Oe.height/4-Ae.height/2,Ae.press=()=>{F(),X<3&&(X+=1,L=1,Ot(X,L),Ft(X,L),P.slide(i,i.x,i.y-40,10,["smoothstep"]),P.fadeOut(i,10),setTimeout(()=>{i.content=Ms[X-1],i.y+=80,P.slide(i,i.x,Oe.height/2-25,15,["smoothstep"]),P.fadeIn(i,15)},100))},(Re=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=Oe.width/2-Re.width/2,Re.y=3*Oe.height/4-Ae.height/2,Re.press=()=>{F(),1<X&&(--X,L=1,Ot(X,L),Ft(X,L),P.slide(i,i.x,i.y+40,10,["smoothstep"]),P.fadeOut(i,10),setTimeout(()=>{i.content=Ms[X-1],i.y-=80,P.slide(i,i.x,Oe.height/2-25,15,["smoothstep"]),P.fadeIn(i,15)},200))},(Me=P.group(Oe,i,Ae,Re)).x=-P.canvas.width,Me.y=-P.canvas.height,Pe=P.sprite(P.assets["images/info_level_box.png"]),(t=P.text("Level "+L,"50px puzzler","black",20,40)).x=Oe.width/4,t.y=Oe.height/2-25,(Ce=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).press=()=>{F(),L<9&&(L+=1,Ft(X,L),P.slide(t,t.x,t.y-40,10,["smoothstep"]),P.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y+=80,P.slide(t,t.x,Pe.height/2-25,15,["smoothstep"]),P.fadeIn(t,15)},100))},Ce.x=Pe.width/2-Ce.width/2,Ce.y=Pe.height/4-Ce.height/2,(Fe=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=Pe.width/2-Fe.width/2,Fe.y=3*Pe.height/4-Ce.height/2,Fe.press=()=>{F(),1<L&&(--L,Ft(X,L),P.slide(t,t.x,t.y+40,10,["smoothstep"]),P.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y-=80,P.slide(t,t.x,Pe.height/2-25,15,["smoothstep"]),P.fadeIn(t,15)},100))},t.y=Pe.height/2-25,(Be=P.group(Pe,t,Ce,Fe)).x=P.canvas.width,Be.y=-P.canvas.height,(Ie=P.button([P.assets["images/b_info_up.png"],P.assets["images/b_info_over.png"],P.assets["images/b_info_up.png"]])).x=(P.canvas.width-Ee.width)/4-.5*Ie.width*Ks/2,Ie.y=_e-Ie.width,Ie.scaleX=.5*Ks,Ie.scaleY=.5*Ks,Ie.press=()=>{F(),de.value=!1,window.about(),de.value=!0,jt("infoframe");let e=P.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=Ie.x+Ie.width/2,e.y=Ie.y+Ie.height/2;var s=P.slide(e,e.x,100,30);P.tweenProperty(e,"scaleX",e.scaleX,180,30),P.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{j.classList.remove("hide"),j.classList.add("show"),P.remove(e)}},(Xe=P.button([P.assets["images/b_reset.png"],P.assets["images/b_reset.png"],P.assets["images/b_reset.png"]])).x=P.canvas.width-Xe.width*Ks,Xe.y=0,Xe.scaleX=Ks,Xe.scaleY=Ks,Xe.press=()=>{F();for(let s=1;s<4;s++)for(let e=1;e<10;e++)localStorage.removeItem(`data${s}${e}_g`),localStorage.removeItem(`data${s}${e}_gl`),localStorage.removeItem(`data${s}${e}_s`),localStorage.removeItem("data"+s+e)},(Le=P.button([P.assets["images/b_login.png"],P.assets["images/b_login.png"],P.assets["images/b_login.png"]])).x=Xe.x,Le.y=P.canvas.height-Le.height,Le.scaleX=Ks,Le.scaleY=Ks,Le.press=()=>{F(),jt("loginframe"),J.classList.contains("hide")?(J.classList.remove("hide"),J.classList.add("show")):(J.classList.remove("show"),J.classList.add("hide"))},($e=P.button([P.assets["images/b_play_up.png"],P.assets["images/b_play_over.png"],P.assets["images/b_play_up.png"]])).x=he,$e.y=_e,$e.scaleX=Ks,$e.scaleY=Ks,$e.press=()=>{ie=0,F(),re.classList.contains("show")&&(re.classList.remove("show"),re.classList.add("hide"),Ct()),ss.visible=!1,ts.visible=!1,is.visible=!1,P.slide(Ye,P.canvas.width,P.canvas.height,30,["decelerationCubed"]),P.slide(Vs,0,0,30,["decelerationCubed"]).onComplete=()=>{Mt()},X=X||1,L=L||1,i.content=Ms[X-1],t.content="Level "+L,Ft(X,L),Ot(X,L),Dt(),P.state=Tt},P.slide($e,P.canvas.width-(P.canvas.width-Ee.width)/4-$e.width/2,.75*P.canvas.height-$e.width/2,30,["decelerationCubed"]),P.slide(Me,(P.canvas.width-Ee.width)/4-Me.width/2,Ee.y+Me.height/2,30,["decelerationCubed"]),P.slide(Be,P.canvas.width-(P.canvas.width-Ee.width)/4-Be.width/2,Ee.y+Be.height/2,30,["decelerationCubed"]),Ye=P.group(Ee,Ie,$e,Xe,Le,Be,Me,l,e)}(),function(){(function(){(Hs=P.sprite(P.assets["images/infogame_1024x511_1.png"])).height=525,qs=P.sprite(P.assets["images/infogame_1024x511_border_1.png"]),Gs=P.group(Hs);var e="40px puzzler";(x=[[P.text("First",e,"black",216,236),P.text("First",e,"black",470,236),P.text("First",e,"black",622,236)],[P.text("First",e,"black",216,396),P.text("First",e,"black",470,396),P.text("First",e,"black",622,396)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),x[0][0].content="23.82",x[0][1].content="=",(d=P.button([P.assets["images/restart_512_up.png"],P.assets["images/restart_512_over.png"],P.assets["images/restart_512_up.png"]])).press=()=>{os.press()},d.x=896-d.width*p*.5,d.y=160-d.width*p*.5,d.scaleX=p,d.scaleY=p,d.interactive=!1,Gs.add(d),(o=P.button([P.assets["images/next_512_up.png"],P.assets["images/next_512_over.png"],P.assets["images/next_512_up.png"]])).press=()=>{ie=0,F(),w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1),localStorage.getItem(`ended_${X}_`+L)?X<=2&&L<=8&&(L+=1,Ft(X,L),Dt(),P.state=Tt):Ut(`Level ${L} must be completed`,"before playing the next one.","See you soon !")},o.x=896-o.width*p*.5,o.y=330-o.width*p*.5,o.scaleX=p,o.scaleY=p,o.interactive=!1,Gs.add(o);for(let s=0;s<2;s++)for(let e=0;e<3;e++)Gs.add(x[s][e]);Gs.x=96,Gs.y=90,(w=P.group(qs,Gs)).visible=!1})(),w.x=.5*P.canvas.width-.5*qs.width,w.y=.5*P.canvas.height-.5*qs.height,(as=P.button([P.assets["images/home_512_up.png"],P.assets["images/home_512_over.png"],P.assets["images/home_512_up.png"]])).press=()=>{F(),ss.visible=!0,ts.visible=!0,is.visible=!0,w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0)),Ft(X,L),Ot(X,L),P.slide(Vs,-P.canvas.width,P.canvas.height,30,["decelerationCubed"]).onComplete=()=>{Mt()},P.slide(Ye,0,0,30,["decelerationCubed"]),P.endGame()},as.x=P.canvas.width-1.1*as.width*p,as.y=10,as.scaleX=p,as.scaleY=p,(Ts=P.button([P.assets["images/infogame_512_up.png"],P.assets["images/infogame_512_over.png"],P.assets["images/infogame_512_up.png"]])).press=()=>{F(),Vt("infoBtn"),w.visible=!w.visible,w.visible?(o.interactive=!0,d.interactive=!0):(o.interactive=!1,d.interactive=!1)},Ts.x=as.x-1.1*Ts.width*p,Ts.y=10,Ts.scaleX=p,Ts.scaleY=p,Ts.visible=!1,Ts.interactive=!1,at.push(Ts),(ns=P.button([P.assets["images/solution_512_up.png"],P.assets["images/solution_512_over.png"],P.assets["images/solution_512_up.png"]])).press=()=>{w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1),qt("Replay ",Ms[X-1]+" Level "+L,"Choose the speed !"),ys.visible=!0,se=!0,P.slide(u,u.x,.5*P.canvas.height-.5*v.height,30)},ns.x=Ts.x-1.1*ns.width*p,ns.y=10,ns.scaleX=p,ns.scaleY=p,ns.visible=!1,ns.interactive=!1,at.push(ns),(rs=P.button([P.assets["images/pause_512_up.png"],P.assets["images/pause_512_over.png"],P.assets["images/pause_512_up.png"]])).press=()=>{$.length>ye[X-1][L-1].s/2&&Y.bananasToEat<=Math.floor(ae/2)&&++ie>=te&&(ne=!0),w.visible&&(w.visible=!1,tt.forEach(e=>e.interactive=!0)),P.isPlaying&&P.pause(),rs.visible=!1,rs.interactive=!1,c.visible=!0,setTimeout(()=>{c.interactive=!0},200),at.forEach((e,s)=>{e.visible=!0,e.interactive=!0}),F()},w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0));rs.x=l.x,rs.y=10,rs.scaleX=p,rs.scaleY=p,(c=P.button([P.assets["images/pause_on_512_up.png"],P.assets["images/pause_on_512_over.png"],P.assets["images/pause_on_512_up.png"]])).press=()=>{w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0)),rs.visible=!0,c.visible=!1,c.interactive=!1,setTimeout(()=>{rs.interactive=!0},200),at.forEach((e,s)=>{e.visible=!1,e.interactive=!1}),F()},w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0));c.x=l.x,c.y=10,c.scaleX=p,c.scaleY=p,c.visible=!1,c.interactive=!1,(os=P.button([P.assets["images/restart_512_up.png"],P.assets["images/restart_512_over.png"],P.assets["images/restart_512_up.png"]])).press=()=>{F(),w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0)),Ft(X,L),P.slide(Vs,0,0,30,["decelerationCubed"]),P.state=Tt},os.x=l.x+1.1*l.width*p,os.y=10,os.scaleX=p,os.scaleY=p,os.visible=!1,os.interactive=!1,at.push(os),(ps=P.button([P.assets["images/save_512_up.png"],P.assets["images/save_512_over.png"],P.assets["images/save_512_up.png"]])).press=()=>{F(),w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1),Ht(),P.slide(bs,.5*P.canvas.width-380,.5*P.canvas.height-256,30)},ps.x=os.x+1.1*ps.width*p,ps.y=10,ps.scaleX=p,ps.scaleY=p,ps.visible=!1,ps.interactive=!1,at.push(ps),(gs=P.button([P.assets["images/b_about_up_128.png"],P.assets["images/b_about_over_128.png"],P.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:ht,is_T:ut,DPI:_t,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:g.scaleCanvas.toFixed(2),S_X:g.scaleX.toFixed(2),S_Y:g.scaleY.toFixed(2),Q:g.quota},s={scene:X,level:L},t=[],e=(t.push(e,s,r,$),`Yo_${Ms[X-1]}_Level_`+L);s=document.createElement("a"),t=new Blob([JSON.stringify(t)],{type:"text/plain"});s.setAttribute("href",URL.createObjectURL(t)),s.setAttribute("download",e.toLowerCase()+".json"),s.click(),URL.revokeObjectURL(s.href)}(),gs.x=os.x,gs.y=P.canvas.height-gs.height-10,(Ve=P.sprite(P.assets["images/border_200x400.png"])).layer=5,(He=P.sprite(P.assets["images/border_200x400.png"])).layer=5,De=P.sprite(P.assets["images/view_420x1080_10.png"]),Je=P.sprite(P.assets["images/view_420x1080_10.png"]),De.width=Je.width=420,Je.x=1500,(Qe=P.sprite(P.assets["images/step_512_neutral.png"])).x=0,Qe.y=10,Qe.scaleX=.8*p,Qe.scaleY=.8*p,(Ke=P.text(" : "+($.length-1),"60px puzzler","black")).x=Qe.width*p*.8+10,Ke.y=Qe.height*p/2-30,Ke.pivotX=0,Ke.pivotY=0,Ke.scaleX=Zs,Ke.scaleY=Zs,P.pushMessage(Ke),(Cs=P.sprite(P.assets["images/time_512_neutral.png"])).x=0,Cs.y=10,Cs.scaleX=.8*p,Cs.scaleY=.8*p,(Ze=P.text(" : ","60px puzzler","black")).x=Cs.width*p*.8+10,Ze.y=Cs.height*p/2-30,Ze.pivotX=0,Ze.pivotY=0,Ze.scaleX=Zs,Ze.scaleY=Zs,P.pushMessage(Ze),(Bs=P.sprite(P.assets["images/bananas_512_neutral.png"])).x=0,Bs.y=0,Bs.scaleX=.8*p,Bs.scaleY=.8*p,(es=P.text(" : "+Y.bananasToEat,"60px puzzler","black")).x=Bs.width*p*.8+10,es.y=Bs.height*p*.8/2-30,es.pivotX=0,es.pivotY=0,es.scaleX=Zs,es.scaleY=Zs,P.pushMessage(es),(As=P.sprite(P.assets["images/yo_level_512.png"])).x=0,As.y=0,As.scaleX=.8*p,As.scaleY=.8*p,(Rs=P.text("","40px puzzler","black")).x=As.width*p*.8+10,Rs.y=As.height*p/2-40,Rs.pivotX=0,Rs.pivotY=0,Rs.scaleX=Zs,Rs.scaleY=Zs,(Ws=P.text("","40px puzzler","black")).x=As.width*p*.8+10,Ws.y=As.height*p*.8/2+5,Ws.pivotX=0,Ws.pivotY=0,Ws.scaleX=Zs,Ws.scaleY=Zs,Rt(),At(),(Ps=P.group(Qe,Ke)).x=10,Ps.y=0,(Fs=P.group(Cs,Ze)).x=10,Fs.y=0,(Os=P.group(Bs,es)).x=10,Os.y=Ps.height*p*1.1+Ps.y,(Ns=P.group(As,Rs,Ws)).x=10,Ns.y=Fs.height*p*1.1+Fs.y,(nt=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{xt.press()},(ot=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{ft.press()},(gt=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{yt.press()},(rt=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{mt.press()},(I=P.group(nt,ot,gt,rt)).x=10,I.y=P.canvas.height/2-I.height/4*we,I.scaleX=I.scaleY=we,(pt=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{xt.press()},(lt=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{ft.press()},(dt=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{yt.press()},(ct=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{mt.press()},(T=P.group(pt,lt,dt,ct)).x=P.canvas.width-T.width*we-10,T.y=P.canvas.height/2-T.height/4*we,T.scaleX=we,T.scaleY=we,tt.push(nt,ot,gt,rt,pt,lt,dt,ct),Ve.height=He.height=2*Ps.height*p+10,(js=P.group(Ps,Os,Ve)).x=10,js.y=1.1*l.height*p,(Ds=P.group(Fs,Ns,He)).x=P.canvas.width-De.width+10,Ds.y=1.1*Ts.height*p,(Js=P.group(De,Je,js,Ds,as,Ts,ns,os,rs,c,ps,I,T,w,gs)).layer=5,Mt()}(),function(e,s){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1&&9<s)throw new Error(`This level : ${s} is not developped yet.`);ve=xe=12}else if(2===e){if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ve=xe=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ve=xe=16}if(Qs=O.level[e-1][s-1],L=s,X=e,n=P.gridSpecial(ve,xe,ue,me,Qs,We,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),$=[],P.setYo(Y),P.setStepArray($),r.b=Y.bananasToEat,P.setGameInfo(r),(Ne=P.sprite(P.assets["images/forest24.jpg"])).layer=-1,Ne.pivotX=0,Ne.pivotY=0,qe=P.sprite(P.assets["images/blocksBorder_12x12.png"]),Ge=P.sprite(P.assets["images/blocksBorder_14x14.png"]),Ue=P.sprite(P.assets["images/blocksBorder_16x16.png"]),qe.layer=Ge.layer=Ue.layer=4,1===X)qe.visible=!0,Ge.visible=!1,Ue.visible=!1,n.addChild(qe);else if(2===X)qe.visible=!1,Ge.visible=!0,Ue.visible=!1,n.addChild(Ge);else{if(3!==X)throw new Error(`Scene playing : ${X} not possible.`);qe.visible=!1,Ge.visible=!1,Ue.visible=!0,n.addChild(Ue)}(je=P.group(Ne,n)).x=420,je.layer=2,(Vs=P.group(je,Js)).x=-P.canvas.width,Vs.y=P.canvas.height,Vs.layer=-1,Mt(),A.setScene(e,g),Ct()}(1,1),function(){m=P.sprite(P.assets["images/save_img_1.png"]),v=P.sprite(P.assets["images/save_img_in_1.png"]),fs=P.text("temp","30px puzzler","black"),Ss=P.text("temp","30px puzzler","black"),ks=P.text("temp","30px puzzler","black"),zs=P.text("temp","30px puzzler","black"),Ys=P.text("temp","30px puzzler","black"),Es=P.text("temp","30px puzzler","black"),$s=P.text("temp","30px puzzler","black"),Xs=P.text("temp","30px puzzler","black"),Ht(),(Is=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.25*v.width-.5*Is.width*p,Is.y=v.height-1.2*Is.height*p-32,Is.scaleX=p,Is.scaleY=p,(Ls=P.button([P.assets["images/save_ok_512_up.png"],P.assets["images/save_ok_512_over.png"],P.assets["images/save_ok_512_up.png"]])).x=.75*v.width-.5*Ls.width*p,Ls.y=v.height-1.2*Ls.height*p-32,Ls.scaleX=p,Ls.scaleY=p,Ls.press=()=>{var e,s;if(F(),se)return ie<te?(s=ie+" Attemp(s)",e="Need "+te,P.slide(u,u.x,P.canvas.height,30),void Ut("Can't replay !",s,e)):(s=W.find(e=>e[1].scene===X&&e[1].level===L))?(Ft(X,L),r={...s[2]},$=[...s[3]],P.slide(u,u.x,P.canvas.height,30),G=JSON.parse(localStorage.getItem(`data${X}${L}_gl`)),P.setGameInfo(r),P.setStepArray($),Rt(),1===$.length?void P.slide(u,u.x,P.canvas.height,30):void Gt($)):(Ut("Not available yet !","Come back later.","A+"),void P.slide(u,u.x,P.canvas.height,30));if(ee){if($.length<=1)return void P.slide(u,u.x,P.canvas.height,30);localStorage.removeItem(`data${X}${L}_s`),localStorage.setItem(`data${X}${L}_g`,JSON.stringify(r)),localStorage.setItem(`data${X}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`data${X}${L}_s`,JSON.stringify($))}else{if(q=JSON.parse(localStorage.getItem(`data${X}${L}_g`)),G=JSON.parse(localStorage.getItem(`data${X}${L}_gl`)),U=JSON.parse(localStorage.getItem(`data${X}${L}_s`)),!q)return Ft(X,L),void P.slide(u,u.x,P.canvas.height,30);if(Ft(X,L),r={...q},a={...G},$=[...U],P.setGameInfo(r),P.setStepArray($),Rt(),1===$.length)return void P.slide(u,u.x,P.canvas.height,30);Gt($)}P.slide(u,u.x,P.canvas.height,30)},Is.press=()=>{F(),P.slide(u,u.x,P.canvas.height,30)};var e="30px puzzler";hs=P.text("Replay > ",e,"black"),h=P.text(" Slow: ",e,"black"),_=P.text(" Fast: ",e,"black"),us=P.text(" Faster: ",e,"black"),ms=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),vs=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),xs=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),ws=P.sprite(P.assets["images/checked_512_up.png"]),ms.press=()=>{F(),ws.x=h.x+h.width,_s=200},vs.press=()=>{F(),ws.x=_.x+_.width,_s=100},xs.press=()=>{F(),ws.x=us.x+us.width,_s=80},ys=P.group(hs,ws,h,ms,_,vs,us,xs),(u=P.group(v,Es,$s,Xs,ys,Ls,Is)).x=.5*P.canvas.width-.5*v.width,u.y=P.canvas.height,u.layer=50,(ls=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.5*m.width-.5*ls.width*p,ls.y=m.height-1.2*ls.height*p-32,ls.scaleX=p,ls.scaleY=p,ls.press=()=>{F(),P.slide(bs,bs.x,-P.canvas.height,30)},(ds=P.button([P.assets["images/save_512_in_up.png"],P.assets["images/save_512_in_over.png"],P.assets["images/save_512_in_up.png"]])).press=()=>{F();let e,s,t;Z=!1,ee=!0,P.slide(u,u.x,.5*P.canvas.height-.5*v.height,30),P.slide(bs,bs.x,-P.canvas.height,30),ys.visible=!1,t=Q&&1<$.length?(e="Already saved",s="Want to save anyway !","The last saved game will be lost."):$.length<=1?(e="Must have some steps !",s="Steps : "+($.length-1),"Try again !"):(e="Save !",s="First time saved.","Only one saved game at a time."),qt(e,s,t)},ds.x=.25*m.width-.5*ds.width*p,ds.y=m.height-1.2*ds.height*p-32,ds.scaleX=p,ds.scaleY=p,(cs=P.button([P.assets["images/save_512_out_up.png"],P.assets["images/save_512_out_over.png"],P.assets["images/save_512_out_up.png"]])).x=.75*m.width-.5*cs.width*p,cs.y=m.height-1.2*cs.height*p-32,cs.scaleX=p,cs.scaleY=p,cs.press=()=>{F();let e,s,t;Z=!0,ee=!1,P.slide(u,u.x,.5*P.canvas.height-.5*v.height,30),P.slide(bs,bs.x,-P.canvas.height,30),Q?(e="Load the game !",s="Present data will be lost.",t="Load anyway !",ys.visible=!0):(e="Can't open this game !",s="Not saved yet.",t="Only saved game can be opened.",ys.visible=!1),qt(e,s,t)},(bs=P.group(m,fs,Ss,ks,zs,Ys,ds,ls,cs)).x=.5*P.canvas.width-.5*m.width,bs.y=-P.canvas.height}(),Nt(),yt.press=bt.press=Et.press=It.press=()=>{Y.move("right",n,Y,E),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},xt.press=wt.press=kt.press=$t.press=()=>{Y.move("up",n,Y,E),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},mt.press=vt.press=zt.press=Xt.press=()=>{Y.move("left",n,Y,E),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},ft.press=St.press=Yt.press=Lt.press=()=>{Y.move("down",n,Y,E),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},it=[xt,wt,kt,$t,ft,St,Yt,Lt,yt,bt,zt,Xt,mt,vt,Et,It,nt,ot,gt,rt,pt,lt,dt,ct],P.setButtonsMove(it,c,de)},["images/walk_512.json","images/info_level_box.png","images/view_420x1080_10.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/b_login.png","images/infogame_1024x511_1.png","images/infogame_1024x511_border_1.png","images/yo_level_512.png","images/save_img_1.png","images/save_img_in_1.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/next_512_up.png","images/next_512_over.png","images/solution_512_up.png","images/solution_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/b_music_512_up.png","images/b_music_512_over.png","images/b_music_512_on_up.png","images/b_music_512_on_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png","images/border_200x400.png","images/box_msg_border_960xx540_convert.png","images/box_msg_back_960xx540_10.png","images/box_msg_ok_512_up.png","images/box_msg_ok_512_over.png","sounds/tamtam.mp3","sounds/eatbananas.wav","sounds/hit_wall.wav","sounds/push.wav","sounds/push2.wav"],function(){0===P.progressBar.counter&&(P.progressBar.setBackgroundColor("#FFA80F"),P.progressBar.setForegroundColor("#FFEC4B"),P.progressBar.create(P.canvas,P.assets,P.canvas.width/2,100));P.progressBar.update()})),mt=(N.appendChild(P.canvas),window.loginHide=(e,s,t)=>{F(),J.classList.remove("show"),J.classList.add("hide"),N.focus(),"yotesteur"===s&&"Yo&Testeur"===t?(V=!0,Ut("Good username","Good password","Let's go!")):(Ut("Something goes wrong","Not a valid user","Retry!"),V=!1)},window.infoHide=e=>{F(),j.classList.remove("show"),j.classList.add("hide"),N.focus()},window.about=e=>{F(),D.src="./html_page/about.html"},window.general=e=>{F(),D.src="./html_page/general.html"},window.buttonsExplained=e=>{F(),D.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{F(),D.src="./html_page/sparebutton.html",F()},P.keyboard(37)),vt=P.keyboard(100),xt=P.keyboard(38),wt=P.keyboard(104),yt=P.keyboard(39),bt=P.keyboard(102),ft=P.keyboard(40),St=P.keyboard(98),kt=P.keyboard(87),zt=P.keyboard(65),Yt=P.keyboard(83),Et=P.keyboard(68),$t=P.keyboard(73),Xt=P.keyboard(74),Lt=P.keyboard(75),It=P.keyboard(76);function Tt(){0===Y.bananasToEat&&(P.pause(),P.endGame(),P.wait(1e3).then(()=>Pt()))}function Pt(){se?se=!1:(Vt("end"),de.value=!1,rs.visible&&rs.press(),de.value=!0,w.visible=!0,d.interactive=!0,o.interactive=!0)}function Ct(){F(),w.visible&&(w.visible=!1,d.interactive=!1,o.interactive=!1,tt.forEach(e=>e.interactive=!0)),setTimeout(()=>{l.visible?(l.visible=!1,l.interactive=!1,e.visible=!0,e.interactive=!0,P.fadeIn(e,30),P.fadeOut(l,30),re.classList.remove("hide"),re.classList.add("show")):(l.visible=!0,l.interactive=!0,e.visible=!1,e.interactive=!1,P.fadeIn(l,30),P.fadeOut(e,30),re.classList.remove("show"),re.classList.add("hide"))},200)}function Ft(e,s){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1||9<s)throw new Error(`This level : ${s} is not developped yet.`);ve=xe=12}else if(2===e){if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ve=xe=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ve=xe=16}if(Qs=O.level[e-1][s-1],L=s,X=e,1<s&&3===e&&!V)Ut("You are not allowed","to continue.","Not a tester."),--L;else{if(1e3<r.t&&(a.t=Object.values(r)[0],a.s=Object.values(r)[1],a.b=Object.values(r)[2]),je.remove(n),Y.bananasToEat=0,n=P.gridSpecial(ve,xe,ue,me,Qs,We,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),($=[]).push({x:Y.activeSprite.gridX,y:Y.activeSprite.gridY,d:"s"}),P.setYo(Y),P.setStepArray($),Vt("resetAll"),r.t=0,r.s=0,r.b=Y.bananasToEat,ae=Y.bananasToEat,Dt(),P.setGameInfo(r),Rt(),1===X)qe.visible=!0,Ge.visible=!1,Ue.visible=!1,n.addChild(qe);else if(2===X)qe.visible=!1,Ge.visible=!0,Ue.visible=!1,n.addChild(Ge);else{if(3!==X)throw new Error(`Scene playing : ${X} not possible.`);qe.visible=!1,Ge.visible=!1,Ue.visible=!0,n.addChild(Ue)}je.addChild(n),A.setScene(e,g),Ke.content=" "+($.length-1),es.content=" "+Y.bananasToEat}}function Bt(){0<P.soundsArrayGlobal.length&&(P.soundsArrayGlobal.length=0),(fe=P.assets["sounds/eatbananas.wav"]).volume=10,(Se=P.assets["sounds/hit_wall.wav"]).loop=!1,Se.volume=1,(ke=P.assets["sounds/push.wav"]).loop=!1,ke.volume=10,(ze=P.assets["sounds/push2.wav"]).loop=!1,ze.volume=10,setTimeout(()=>{A.setSoundEffect(fe,Se,ke,ze)},2e3),(be=P.assets["sounds/tamtam.mp3"]).loop=!0,be.volume=.2;["eat_bananas_sound","button_sound","move_block_sound","elephan_sound","wall_sound","tiger_sound"].forEach(e=>{P.addSoundsArray(M[e])})}function Ot(e,s){X=e,L=s,i.content=Ms[X-1],t.content="Level "+L}function At(){ss.layer=100,ts.layer=100,is.layer=100,ss.content=`is_M=${ht} & is_T=${ut} | DPI=${_t} `,ts.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,ts.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,ts.content+=` | VW=${visualViewport.width.toFixed(2)},VH=`+visualViewport.height.toFixed(2),is.content=`S_C=${g.scaleCanvas.toFixed(2)} & S_X= ${g.scaleX.toFixed(2)} & S_Y= `+g.scaleY.toFixed(2)}function Rt(){Ke.content=" "+($.length-1),Ze.content=r.t<=0?" : .....":Jt(r.t),es.content=" "+r.b,Rs.content=Ms[X-1],Ws.content="     "+L}function Mt(){var e=st*we;nt.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+0*e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+.6*e,y:I.gy+.406*e}],ot.points=[{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+.6*e,y:I.gy+.6*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+e}],gt.points=[{x:I.gx+.6*e,y:I.gy+.406*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+.6*e,y:I.gy+.6*e}],rt.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+0*e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+0*e}],pt.points=[{x:T.gx+.406*e,y:T.gy+.406*e},{x:T.gx+0*e,y:T.gy+0*e},{x:T.gx+e,y:T.gy+0*e},{x:T.gx+.6*e,y:T.gy+.406*e}],lt.points=[{x:T.gx+.406*e,y:T.gy+.6*e},{x:T.gx+.6*e,y:T.gy+.6*e},{x:T.gx+e,y:T.gy+e},{x:T.gx+0*e,y:T.gy+e}],dt.points=[{x:T.gx+.6*e,y:T.gy+.406*e},{x:T.gx+e,y:T.gy+0*e},{x:T.gx+e,y:T.gy+e},{x:T.gx+.6*e,y:T.gy+.6*e}],ct.points=[{x:T.gx+.406*e,y:T.gy+.406*e},{x:T.gx+.406*e,y:T.gy+.6*e},{x:T.gx+0*e,y:T.gy+e},{x:T.gx+0*e,y:T.gy+0*e}]}function Wt(){var e=document.querySelector(":root");H.width=P.canvas.width*g.scaleCanvas,e.style.setProperty("--wait-width",H.width+"px"),e.style.setProperty("--wait-left",P.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",P.canvas.offsetTop+"px")}function Nt(){var e=document.querySelector(":root");getComputedStyle(e);let s=Math.floor(l.width*p*g.scaleCanvas),t=Math.floor(l.width*p*g.scaleCanvas);P.canvas.offsetTop;let i=10*g.scaleCanvas,a=10;var n=P.canvas.offsetTop+l.y*g.scaleY,o=P.canvas.offsetLeft+(l.width*p+10)*g.scaleX;ht&&(jt("infoframe"),jt("loginframe"),s=32,t=32,i=5,a=5),e.style.setProperty("--btn-width",s+"px"),e.style.setProperty("--btn-height",t+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",i+"px"),e.style.setProperty("--border-iframe",a+"px")}function jt(e){var s=P.canvas.offsetTop+l.height*p*g.scaleCanvas+10,t=.95*(window.innerHeight-s),i=.8*window.innerWidth;let a;if("infoframe"===e)a=document.getElementById("infoframe").contentWindow.document.querySelector(":root");else{if("loginframe"!==e)throw new Error("Bad iframe passed to function.");a=document.getElementById("loginframe").contentWindow.document.querySelector(":root")}ht&&(a.style.setProperty("--font-p","12px"),a.style.setProperty("--margin-p-v","5px"),a.style.setProperty("--margin-p-h","12px"),a.style.setProperty("--font-header","15px"),a.style.setProperty("--font-footer","12px"),a.style.setProperty("--font-buttons","12px"),a.style.setProperty("--btn-width","100px"),a.style.setProperty("--bnt-height","25px"),a.style.setProperty("--img-w","32px"),a.style.setProperty("--img-h","32px"),a.style.setProperty("--margin-flex","5%"),a.style.setProperty("--margin-line","5px"));var n=.1*window.innerWidth;"infoframe"===e?(j.style.top=s+"px",j.style.width=i+"px",j.style.height=t+"px",j.style.margin=`0  ${n}px`):"loginframe"===e&&(J.style.top=s+"px",J.style.width=i+"px",J.style.height=t+"px",J.style.margin=`0  ${n}px`)}function Dt(){q=JSON.parse(localStorage.getItem(`data${X}${L}_g`)),G=JSON.parse(localStorage.getItem(`data${X}${L}_gl`)),U=JSON.parse(localStorage.getItem(`data${X}${L}_s`)),a=G?{...G}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1}}function Jt(e){var e=(e/1e3).toFixed(1),s=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),t=Math.floor(e/60);let i="0",a=9<t?"":"0";return 9<e%60&&(i=""),t<=0?""+i+e%60+"."+s:""+a+t+`:${i}${e%60}.`+s}function Vt(e){let s={};function t(a,n){var e="40px puzzler";let s=void 0,t=void 0,i=void 0;if(0===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*C(e,"?").width):(s=+(n.first/1e3).toFixed(1),x[a][0].content=Jt(n.first),x[a][0].x=272-.5*C(e,Jt(n.first)).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*C(e,"?").width):(t=+(n.second/1e3).toFixed(1),x[a][1].content=Jt(n.second),x[a][1].x=480-.5*C(e,Jt(n.second)).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*C(e,"?").width):(i=+(n.third/1e3).toFixed(1),x[a][2].content=Jt(n.third),x[a][2].x=672-.5*C(e,Jt(n.third)).width);else if(1===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*C(e,"?").width):(s=n.first,x[a][0].content=n.first.toString(),x[a][0].x=272-.5*C(e,n.first.toString()).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*C(e,"?").width):(t=n.second,x[a][1].content=n.second.toString(),x[a][1].x=480-.5*C(e,n.second.toString()).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*C(e,"?").width):(i=n.third,x[a][2].content=n.third.toString(),x[a][2].x=672-.5*C(e,n.third.toString()).width);else if(2===a){let e=void 0,s=void 0,t=void 0,i=void 0;n.first<0?(x[a][0].content="?",x[a][0].x=405,x[a][1].content="?"):(e=n.first,x[a][0].content=n.first.toString(),x[a][0].x=415-10*n.first.toString().length),n.second<0?(x[a][2].content="?",x[a][2].x=854):(s=n.second,x[a][2].content=n.second.toString(),x[a][2].x=864-10*n.second.toString().length),void 0!==e&&void 0!==s&&(n.first===n.second?x[a][1].content="=":n.first<n.second?x[a][1].content="<":x[a][1].content=">"),n.third<0?(x[a][4].content="?",x[a][4].x=1290,x[a][3].content="?",x[a][5].content="?"):(t=n.third,x[a][4].content=n.third.toString(),x[a][4].x=1300-10*n.third.toString().length),void 0!==s&&void 0!==t&&(n.second===n.third?x[a][3].content="=":n.second<n.third?x[a][3].content="<":x[a][3].content=">"),n.fourth<0?(x[a][6].content="?",x[a][6].x=1706,x[a][5].content="?"):(i=n.fourth,x[a][6].content=n.fourth.toString(),x[a][6].x=1716-10*n.fourth.toString().length),void 0!==t&&void 0!==i&&(n.third===n.fourth?x[a][5].content="=":n.third<n.fourth?x[a][5].content="<":x[a][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,g.quota=(e/1024/1024).toFixed(1))}();function i(){s.first=r.t,s.second=a.bt,s.third=ye[X-1][L-1].csec,t(0,s),s.first=r.s,s.second=a.bs,s.third=ye[X-1][L-1].s,t(1,s)}"restart"===e||"infoBtn"===e?i():"end"===e&&(a.bt=Math.min(a.bt<=0?1/0:a.bt,r.t),a.bs=Math.min(a.bs<=0?1/0:a.bs,r.s),a.bb=Math.min(a.bb<=0?1/0:a.bb,r.b),a.t=r.t,a.s=r.s,a.b=r.b,localStorage.setItem(`data${X}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`ended_${X}_`+L,"1"),i())}function C(e,s){return P.canvas.ctx.font=e,{width:P.canvas.ctx.measureText(s).width,height:P.canvas.ctx.measureText("M").width}}function Ht(e,s,t,i,a){let n="40px puzzler",o="60px puzzler";ht&&(n="40px puzzler",o="50px puzzler"),Z=ee=!1,q=JSON.parse(localStorage.getItem(`data${X}${L}_g`)),G=JSON.parse(localStorage.getItem(`data${X}${L}_gl`)),U=JSON.parse(localStorage.getItem(`data${X}${L}_s`)),a=q?(Q=!0,K=!0,e="Open the game !",s=Ms[X-1]+" Level:"+L,t="Time : "+Jt(q.t),i="Steps : "+q.s,"Bananas : "+q.b):(Q=!1,K=!1,e="Save the game !",s=Ms[X-1]+" Level:"+L,t="Time : "+Jt(r.t),i="Steps : "+r.s,"Bananas : "+r.b),fs.font=o,fs.content=e,fs.width=C(o,e).width,fs.height=C(o,e).height,fs.x=.5*m.width-.5*fs.width,fs.y=32,Ss.font=o,Ss.content=s,Ss.width=C(o,s).width,Ss.height=C(o,s).height,Ss.x=.5*m.width-.5*Ss.width,Ss.y=fs.y+fs.height+10,ks.content=t,ks.font=n,ks.width=C(n,t).width,ks.height=C(n,t).height,ks.x=.5*m.width-.5*ks.width,ks.y=Ss.y+Ss.height+20,zs.content=i,zs.font=n,zs.width=C(n,i).width,zs.height=C(n,i).height,zs.x=.5*m.width-.5*zs.width,zs.y=ks.y+ks.height+10,Ys.content=a,Ys.font=n,Ys.width=C(n,a).width,Ys.height=C(n,a).height,Ys.x=.5*m.width-.5*Ys.width,Ys.y=zs.y+zs.height+10}function qt(e,s,t){let i="40px puzzler",a="60px puzzler";var n="30px puzzler",e=(ht&&(i="40px puzzler",a="50px puzzler"),Es.font=a,Es.content=e,Es.width=C(a,e).width,Es.height=C(a,e).height,Es.x=.5*v.width-.5*Es.width,Es.y=32,$s.font=a,$s.content=s,$s.width=C(a,s).width,$s.height=C(a,s).height,$s.x=.5*v.width-.5*$s.width,$s.y=Es.y+Es.height+10,Xs.content=t,Xs.font=i,Xs.width=C(i,t).width,Xs.height=C(i,t).height,Xs.x=.5*v.width-.5*Xs.width,Xs.y=$s.y+$s.height+20,hs.font=n,hs.width=C(n,"Replay > ").width,hs.height=C(n,"Replay > ").height,h.font=n,h.width=C(n," Slow: ").width,h.height=C(n," Slow: ").height,_.font=n,_.width=C(n," Fast: ").width,_.height=C(n," Fast: ").height,us.font=n,us.width=C(n," Faster: ").width,us.height=C(n," Faster: ").height,ms.scaleX=ms.scaleY=.5*p,vs.scaleX=vs.scaleY=.5*p,xs.scaleX=xs.scaleY=.5*p,ws.scaleX=ws.scaleY=.5*p,h.x=hs.width,ms.x=h.x+h.width,_.x=h.x+h.width+ms.width*p*.5,vs.x=_.x+_.width,0===ws.x&&(ws.x=vs.x),us.x=_.x+_.width+vs.width*p*.5,xs.x=us.x+us.width,hs.y=h.y=_.y=us.y=ms.height*p*.5*.5-.5*hs.height,ys.y=Xs.y+Xs.height+20,hs.width+h.width+_.width+us.width+3*vs.width*p*.5);ys.x=.5*v.width-.5*e}function Gt(e){le&&A.setSound(!1);let s=1;P.setReplayMode(!0),et=setInterval(()=>{"u"===e[s].d?Y.move("up",n,Y,E):"d"===e[s].d?Y.move("down",n,Y,E):"r"===e[s].d?Y.move("right",n,Y,E):"l"===e[s].d&&Y.move("left",n,Y,E),++s===e.length&&(clearInterval(et),P.setReplayMode(!1),le&&A.setSound(!0),se)&&setTimeout(()=>{se=!1,Ft(X,L)},2e3)},_s)}function Ut(e="Message 1",s="Message 2",t="Message 3"){var i="60px puzzler",e=(z.visible=!1,Us.visible=!0,f.content=e,f.font=i,f.width=C(i,e).width,f.height=C(i,e).height,f.x=.5*y.width-.5*f.width,f.y=100,f.visible=!1,S.content=s,S.font=i,S.width=C(i,s).width,S.height=C(i,s).height,S.x=.5*y.width-.5*S.width,S.y=f.y+f.height+30,S.visible=!1,k.content=t,k.font=i,k.width=C(i,t).width,k.height=C(i,t).height,k.x=.5*y.width-.5*k.width,k.y=S.y+S.height+30,k.visible=!1,b.width=y.width,b.x=y.x,b.height=y.height,b.y=y.y,P.tweenProperty(b,"width",b.width,b.width-192,60));P.tweenProperty(b,"height",b.height,b.height-192,60),P.tweenProperty(b,"x",b.x,b.x+96,60),P.tweenProperty(b,"y",b.y,b.y+96,60),e.onComplete=()=>{z.visible=!0,z.interactive=!0,f.visible=!0,S.visible=!0,k.visible=!0}}function F(){le&&de.value&&R.playSoundsArray(M.button_sound)}P.start(),P.scaleToWindow(g),Wt(),window.addEventListener("resize",e=>{P.scaleToWindow(g),At(),Nt(),Wt()}),document.addEventListener("fullscreenchange",e=>{P.scaleToWindow(g),At(),(Te=!Te)?s.src=P.assets["images/fullscreen_off_512_over.png"].src:s.src=P.assets["images/fullscreen_on_512_over.png"].src});