import{game as C}from"./engine.js";import*as F from"./level.js";import*as B from"./move.js";import*as a from"./sounds.js";import*as i from"./gamesounds.js";import"./typedef.js";let O=document.getElementById("main"),R=document.getElementById("infodiv"),M=document.getElementById("infoframe"),W=document.getElementById("logindiv");document.getElementById("loginframe");let j=!1,J=document.getElementById("wait-video"),r={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>r.boxSize/512,quota:void 0};let g={t:0,s:0,b:-1},n={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},D=void 0,H=void 0,V=void 0,q=!1,U=!1,G=!1,Q=!1,s=document.getElementById("btn-1"),K=document.getElementById("btn-2"),Z=document.getElementsByClassName("floating-menu")[0],o=!1,ee={value:!0},se=1920,te=1080,ae=90,ie=90,ne=12,oe=12,p=.2,re=.75,ge=[[{s:70,t:15.23,csec:15234},{s:106,t:159.3,csec:15930},{s:144,t:421.19,csec:42119},{s:116,t:385.03,csec:38503},{s:114,t:410.32,csec:41032},{s:163,t:1042.31,csec:104231},{s:142,t:646.3,csec:64630},{s:233,t:1017.17,csec:101717},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:267,t:2518.64,csec:251864},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}]];let pe,le,de,ce,he,_e,ue,me,l,e,ve,xe,t,ye,be,we,fe,d,ke,Se,Te,c,ze,Ye,Xe,$e,Le,Ee,Ne,Ae,Pe,Ie,Ce,Fe,Be,Oe,Re,Me,We,je,Je,h,De,_,He,Ve,u,qe,Ue,Ge,Qe,Ke,Ze=100,m,v,es,ss,ts,as,is,ns,os,x,y,b,rs,gs,ps,ls,ds,cs,hs,_s,us,ms,vs,xs,ys,bs,ws,fs,ks,Ss,Ts=["12x12","14x14","16x16"],zs,Ys,Xs,$s,Ls,Es,Ns,As,w,Ps,f,Is,k,S,T,z,Y,Cs,X={},Fs=[],$=[],L=1,E=1,Bs=F.level[L-1][E-1],Os=1,Rs=1,Ms=setInterval(()=>P.progressBar.update(),5),Ws=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),js=[],Js,Ds=[],N,Hs,Vs,qs,Us,A,Gs,Qs,Ks,Zs,et=/Mobile/i.test(navigator.userAgent),st=window.devicePixelRatio.toFixed(2),tt=!1,P=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(tt=!0),et&&(Rs=3.5<=st&&st<=4.2?Os=1.2:2.8<=st&&st<3.5?(Os=1.5,1.2):(Os=1.6,1.5)),new C(se,te,function(){document.body.removeChild(J),P.progressBar.remove(),clearInterval(Ms),s.src=P.assets["images/fullscreen_on_512_up.png"].src,s.style.width="64px",K.src=P.assets["images/sound_no_240_up.png"].src,K.style.width="64px",s.onpointerdown=e=>(document.fullscreenElement?(document.exitFullscreen(),s.src=P.assets["images/fullscreen_on_512_up.png"].src,ve=!1,o&&a.playAllNoneTransform(i.fullscreen_off_sound)):(O.requestFullscreen().catch(e=>console.log(e)),s.src=P.assets["images/fullscreen_off_512_up.png"].src,ve=!0,o&&a.playAllNoneTransform(i.fullscreen_on_sound)),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{ve?s.src=P.assets["images/fullscreen_off_512_over.png"].src:s.src=P.assets["images/fullscreen_on_512_over.png"].src}),s.addEventListener("mouseleave",()=>{ve?s.src=P.assets["images/fullscreen_off_512_up.png"].src:s.src=P.assets["images/fullscreen_on_512_up.png"].src}),K.onpointerdown=e=>((o=!o)?a.playAllNoneTransform(i.sound_off_sound):a.playAllNoneTransform(i.sound_on_sound),B.setSound(o),P.actx=new AudioContext,o?K.src=P.assets["images/sound_yes_240_up.png"].src:K.src=P.assets["images/sound_no_240_up.png"].src,e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),K.addEventListener("mouseover",()=>{o?K.src=P.assets["images/sound_yes_240_over.png"].src:K.src=P.assets["images/sound_no_240_over.png"].src}),K.addEventListener("mouseleave",()=>{o?K.src=P.assets["images/sound_yes_240_up.png"].src:K.src=P.assets["images/sound_no_240_up.png"].src}),ze=[P.assets["walkDownRight.png"],P.assets["images/road_512.png"],P.assets["images/forest_512.png"],P.assets["images/box_512.png"],P.assets["images/bananas_0_512.png"],P.assets["walkUpRight.png"],P.assets["walkUpLeft.png"],P.assets["walkUpRightPush.png"],P.assets["walkUpLeftPush.png"],P.assets["walkDownRight.png"],P.assets["walkDownLeft.png"],P.assets["walkDownRightPush.png"],P.assets["walkDownLeftPush.png"],P.assets["walkRightRight.png"],P.assets["walkRightLeft.png"],P.assets["walkRightRightPush.png"],P.assets["walkRightLeftPush.png"],P.assets["walkLeftRight.png"],P.assets["walkLeftLeft.png"],P.assets["walkLeftRightPush.png"],P.assets["walkLeftLeftPush.png"]],X.setVisible=()=>{Fs.forEach(e=>{e===X.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},X.layer=3,X.bananasToEat=0,X.move=B.moveScene,le=P.assets["sounds/bounce.wav"],(pe=P.assets["sounds/music.wav"]).loop=!0,function(){(function(){k=P.sprite(P.assets["images/box_msg_border_960xx540.png"]),(S=P.sprite(P.assets["images/box_msg_back_960xx540.png"])).pivotX=.5*S.width,S.pivotY=.5*S.height;var e="60px puzzler";(Cs=P.button([P.assets["images/box_msg_ok_512_up.png"],P.assets["images/box_msg_ok_512_over.png"],P.assets["images/box_msg_ok_512_up.png"]])).scaleX=Cs.scaleY=p,Cs.x=.5*k.width-.5*Cs.width*p,Cs.y=k.height-Cs.height*p-96,Cs.interactive=!1,Cs.press=()=>{o&&a.playAllNoneTransform(i.ok_sound),Is.visible=!1,Cs.interactive=!1},(T=P.text("msg_1",e,"black")).width=I(e," msg_1: ").width,T.height=I(e," msg_1: ").height,T.x=.5*k.width-.5*T.width,T.y=100,(z=P.text("msg_2",e,"black")).width=I(e," msg_2: ").width,z.height=I(e," msg_2: ").height,z.x=.5*k.width-.5*z.width,z.y=T.y+T.height+30,(Y=P.text("msg_3",e,"black")).width=I(e," msg_3: ").width,Y.height=I(e," msg_3: ").height,Y.x=.5*k.width-.5*Y.width,Y.y=z.y+z.height+30,(Is=P.group(k,S,T,z,Y,Cs)).x=.5*P.canvas.width-.5*k.width,Is.y=.5*P.canvas.height-.5*k.height,Is.layer=100,Is.visible=!1})(),(Re=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-135,(Me=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-90,(We=P.text("First","40px puzzler","deepskyblue")).y=P.canvas.height-45;(ce=P.sprite(P.assets["images/fond_ecran_950.jpg"])).x=(P.canvas.width-ce.width)/2,ce.y=(P.canvas.height-ce.height)/2,L=L||1;E=E||1;(e=P.button([P.assets["images/menu_open_512_up.png"],P.assets["images/menu_open_512_over.png"],P.assets["images/menu_open_512_up.png"]])).x=10,e.y=10,e.pivotX=0,e.pivotY=0,e.scaleX=p,e.scaleY=p,e.layer=20,e.visible=!1,e.interactive=!1,e.press=()=>wt(),(l=P.button([P.assets["images/menu_512_up.png"],P.assets["images/menu_512_over.png"],P.assets["images/menu_512_up.png"]])).x=10,l.y=10,l.pivotX=0,l.pivotY=0,l.scaleX=p,l.scaleY=p,l.layer=20,l.press=()=>wt(),fe=P.sprite(P.assets["images/info_level_box.png"]),(d=P.text("12x12","50px puzzler","black",20,40)).content=Ts[L-1],d.x=fe.width/4,d.y=fe.height/2-25,(ke=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).x=fe.width/2-ke.width/2,ke.y=fe.height/4-ke.height/2,ke.press=()=>{o&&a.playAllNoneTransform(i.scene_up_sound),L<3&&(L+=1,E=1,kt(L,E),ft(L,E),P.slide(d,d.x,d.y-40,10,["smoothstep"]),P.fadeOut(d,10),setTimeout(()=>{d.content=Ts[L-1],d.y+=80,P.slide(d,d.x,fe.height/2-25,15,["smoothstep"]),P.fadeIn(d,15)},100))},(Se=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=fe.width/2-Se.width/2,Se.y=3*fe.height/4-ke.height/2,Se.press=()=>{o&&a.playAllNoneTransform(i.scene_down_sound),1<L&&(--L,E=1,kt(L,E),ft(L,E),P.slide(d,d.x,d.y+40,10,["smoothstep"]),P.fadeOut(d,10),setTimeout(()=>{d.content=Ts[L-1],d.y-=80,P.slide(d,d.x,fe.height/2-25,15,["smoothstep"]),P.fadeIn(d,15)},200))},(Te=P.group(fe,d,ke,Se)).x=-P.canvas.width,Te.y=-P.canvas.height,xe=P.sprite(P.assets["images/info_level_box.png"]),(t=P.text("Level "+E,"50px puzzler","black",20,40)).x=fe.width/4,t.y=fe.height/2-25,(ye=P.button([P.assets["images/b_scene_top_up.png"],P.assets["images/b_scene_top_over.png"],P.assets["images/b_scene_top_up.png"]])).press=()=>{o&&a.playAllNoneTransform(i.level_up_sound),E<9&&(E+=1,ft(L,E),P.slide(t,t.x,t.y-40,10,["smoothstep"]),P.fadeOut(t,10),setTimeout(()=>{t.content="Level "+E,t.y+=80,P.slide(t,t.x,xe.height/2-25,15,["smoothstep"]),P.fadeIn(t,15)},100))},ye.x=xe.width/2-ye.width/2,ye.y=xe.height/4-ye.height/2,(be=P.button([P.assets["images/b_scene_up.png"],P.assets["images/b_scene_over.png"],P.assets["images/b_scene_up.png"]])).x=xe.width/2-be.width/2,be.y=3*xe.height/4-ye.height/2,be.press=()=>{o&&a.playAllNoneTransform(i.level_down_sound),1<E&&(--E,ft(L,E),P.slide(t,t.x,t.y+40,10,["smoothstep"]),P.fadeOut(t,10),setTimeout(()=>{t.content="Level "+E,t.y-=80,P.slide(t,t.x,xe.height/2-25,15,["smoothstep"]),P.fadeIn(t,15)},100))},t.y=xe.height/2-25,(we=P.group(xe,t,ye,be)).x=P.canvas.width,we.y=-P.canvas.height,(me=P.button([P.assets["images/b_info_up.png"],P.assets["images/b_info_over.png"],P.assets["images/b_info_up.png"]])).x=(P.canvas.width-ce.width)/4-.5*me.width*Os/2,me.y=te-me.width,me.scaleX=.5*Os,me.scaleY=.5*Os,me.press=()=>{o&&a.playAllNoneTransform(i.info_sound),ee.value=!1,window.about(),ee.value=!0;let e=P.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=me.x+me.width/2,e.y=me.y+me.height/2;var s=P.slide(e,e.x,100,30);P.tweenProperty(e,"scaleX",e.scaleX,180,30),P.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{R.classList.remove("hide"),R.classList.add("show"),$t(),P.remove(e)}},(_e=P.button([P.assets["images/b_reset.png"],P.assets["images/b_reset.png"],P.assets["images/b_reset.png"]])).x=P.canvas.width-_e.width*Os,_e.y=0,_e.scaleX=Os,_e.scaleY=Os,_e.press=()=>{o&&a.playAllNoneTransform(i.reload_sound);for(let s=1;s<4;s++)for(let e=1;e<10;e++)localStorage.removeItem(`data${s}${e}_g`),localStorage.removeItem(`data${s}${e}_gl`),localStorage.removeItem(`data${s}${e}_s`),localStorage.removeItem("data"+s+e)},(ue=P.button([P.assets["images/b_login.png"],P.assets["images/b_login.png"],P.assets["images/b_login.png"]])).x=_e.x,ue.y=P.canvas.height-ue.height,ue.scaleX=Os,ue.scaleY=Os,ue.press=()=>{o&&a.playAllNoneTransform(i.reload_sound),W.classList.contains("hide")?(W.classList.remove("hide"),W.classList.add("show")):(W.classList.remove("show"),W.classList.add("hide"))},(he=P.button([P.assets["images/b_play_up.png"],P.assets["images/b_play_over.png"],P.assets["images/b_play_up.png"]])).x=se,he.y=te,he.scaleX=Os,he.scaleY=Os,he.press=()=>{o&&a.playAllNoneTransform(i.play_sound),Z.classList.contains("show")&&(Z.classList.remove("show"),Z.classList.add("hide"),wt()),Re.visible=!1,Me.visible=!1,We.visible=!1,P.slide(de,P.canvas.width,P.canvas.height,30,["decelerationCubed"]),P.slide(Es,0,0,30,["decelerationCubed"]).onComplete=()=>{zt()},L=L||1,E=E||1,d.content=Ts[L-1],t.content="Level "+E,ft(L,E),kt(L,E),Lt(),P.state=yt},P.slide(he,P.canvas.width-(P.canvas.width-ce.width)/4-he.width/2,.75*P.canvas.height-he.width/2,30,["decelerationCubed"]),P.slide(Te,(P.canvas.width-ce.width)/4-Te.width/2,ce.y+Te.height/2,30,["decelerationCubed"]),P.slide(we,P.canvas.width-(P.canvas.width-ce.width)/4-we.width/2,ce.y+we.height/2,30,["decelerationCubed"]),de=P.group(ce,me,he,_e,ue,we,Te,l,e)}(),function(){(function(){Ns=P.sprite(P.assets["images/infogame_1024x511.png"]),As=P.sprite(P.assets["images/infogame_1024x511_border.png"]),Ps=P.group(Ns);var e="40px puzzler";(w=[[P.text("First",e,"black",216,236),P.text("First",e,"black",470,236),P.text("First",e,"black",622,236)],[P.text("First",e,"black",216,396),P.text("First",e,"black",470,396),P.text("First",e,"black",622,396)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),w[0][0].content="23.82",w[0][1].content="=",(_=P.button([P.assets["images/restart_512_up.png"],P.assets["images/restart_512_over.png"],P.assets["images/restart_512_up.png"]])).press=()=>{De.press()},_.x=896-_.width*p*.5,_.y=160-_.width*p*.5,_.scaleX=p,_.scaleY=p,_.interactive=!1,Ps.add(_),(h=P.button([P.assets["images/next_512_up.png"],P.assets["images/next_512_over.png"],P.assets["images/next_512_up.png"]])).press=()=>{Je.press()},h.x=896-h.width*p*.5,h.y=330-h.width*p*.5,h.scaleX=p,h.scaleY=p,h.interactive=!1,Ps.add(h);for(let s=0;s<2;s++)for(let e=0;e<3;e++)Ps.add(w[s][e]);Ps.x=96,Ps.y=96,(f=P.group(As,Ps)).visible=!1})(),f.x=.5*P.canvas.width-.5*As.width,f.y=.5*P.canvas.height-.5*As.height,(je=P.button([P.assets["images/home_512_up.png"],P.assets["images/home_512_over.png"],P.assets["images/home_512_up.png"]])).press=()=>{o&&a.playAllNoneTransform(i.home_sound),Re.visible=!0,Me.visible=!0,We.visible=!0,f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0)),ft(L,E),kt(L,E),P.slide(Es,-P.canvas.width,P.canvas.height,30,["decelerationCubed"]).onComplete=()=>{zt()},P.slide(de,0,0,30,["decelerationCubed"]),P.endGame()},je.x=P.canvas.width-1.1*je.width*p,je.y=10,je.scaleX=p,je.scaleY=p,(vs=P.button([P.assets["images/infogame_512_up.png"],P.assets["images/infogame_512_over.png"],P.assets["images/infogame_512_up.png"]])).press=()=>{o&&ee.value&&a.playAllNoneTransform(i.info_sound),Nt("infoBtn"),f.visible=!f.visible,f.visible?(h.interactive=!0,_.interactive=!0):(h.interactive=!1,_.interactive=!1)},vs.x=je.x-1.1*vs.width*p,vs.y=10,vs.scaleX=p,vs.scaleY=p,vs.visible=!1,vs.interactive=!1,Ds.push(vs),(Je=P.button([P.assets["images/next_512_up.png"],P.assets["images/next_512_over.png"],P.assets["images/next_512_up.png"]])).press=()=>{o&&ee.value&&a.playAllNoneTransform(i.info_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1),localStorage.getItem(`ended_${L}_`+E)?L<=2&&E<=8&&(E+=1,ft(L,E),Lt(),P.state=yt):It(`Level ${E} must be completed`,"before playing the next one.","See you soon !")},Je.x=vs.x-1.1*Je.width*p,Je.y=10,Je.scaleX=p,Je.scaleY=p,Je.visible=!1,Je.interactive=!1,Ds.push(Je),(Ve=P.button([P.assets["images/pause_512_up.png"],P.assets["images/pause_512_over.png"],P.assets["images/pause_512_up.png"]])).press=()=>{o&&ee.value&&a.playAllNoneTransform(i.pause_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0)),P.isPlaying&&P.pause(),Ve.visible=!1,Ve.interactive=!1,u.visible=!0,setTimeout(()=>{u.interactive=!0},200),Ds.forEach((e,s)=>{e.visible=!0,e.interactive=!0})},f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0));Ve.x=l.x,Ve.y=10,Ve.scaleX=p,Ve.scaleY=p,(u=P.button([P.assets["images/pause_on_512_up.png"],P.assets["images/pause_on_512_over.png"],P.assets["images/pause_on_512_up.png"]])).press=()=>{o&&ee.value&&a.playAllNoneTransform(i.pause_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0)),Ve.visible=!0,u.visible=!1,u.interactive=!1,setTimeout(()=>{Ve.interactive=!0},200),Ds.forEach((e,s)=>{e.visible=!1,e.interactive=!1})},f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0));u.x=l.x,u.y=10,u.scaleX=p,u.scaleY=p,u.visible=!1,u.interactive=!1,(De=P.button([P.assets["images/restart_512_up.png"],P.assets["images/restart_512_over.png"],P.assets["images/restart_512_up.png"]])).press=()=>{o&&a.playAllNoneTransform(i.reload_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0)),ft(L,E),P.slide(Es,0,0,30,["decelerationCubed"]),P.state=yt},De.x=l.x+1.1*l.width*p,De.y=10,De.scaleX=p,De.scaleY=p,De.visible=!1,De.interactive=!1,Ds.push(De),(qe=P.button([P.assets["images/save_512_up.png"],P.assets["images/save_512_over.png"],P.assets["images/save_512_up.png"]])).press=()=>{o&&a.playAllNoneTransform(i.save_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1),At(),P.slide(os,.5*P.canvas.width-380,.5*P.canvas.height-256,30)},qe.x=De.x+1.1*qe.width*p,qe.y=10,qe.scaleX=p,qe.scaleY=p,qe.visible=!1,qe.interactive=!1,Ds.push(qe),(He=P.button([P.assets["images/b_about_up_128.png"],P.assets["images/b_about_over_128.png"],P.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:et,is_T:tt,DPI:st,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:r.scaleCanvas.toFixed(2),S_X:r.scaleX.toFixed(2),S_Y:r.scaleY.toFixed(2),Q:r.quota},s={scene:L,level:E},t=[],e=(t.push(e,s,g,$),`Yo_${Ts[L-1]}_Level_`+E);s=document.createElement("a"),t=new Blob([JSON.stringify(t)],{type:"text/plain"});s.setAttribute("href",URL.createObjectURL(t)),s.setAttribute("download",e.toLowerCase()+".json"),s.click(),URL.revokeObjectURL(s.href)}(),He.x=De.x,He.y=P.canvas.height-He.height-10,(Ee=P.sprite(P.assets["images/border_200x400.png"])).layer=5,(Ne=P.sprite(P.assets["images/border_200x400.png"])).layer=5,$e=P.sprite(P.assets["images/view_420x1080.png"]),(Le=P.sprite(P.assets["images/view_420x1080.png"])).x=1500,(Ce=P.sprite(P.assets["images/step_512_neutral.png"])).x=0,Ce.y=10,Ce.scaleX=.8*p,Ce.scaleY=.8*p,(Fe=P.text(" : "+($.length-1),"60px puzzler","black")).x=Ce.width*p*.8+10,Fe.y=Ce.height*p/2-30,Fe.pivotX=0,Fe.pivotY=0,Fe.scaleX=Rs,Fe.scaleY=Rs,P.pushMessage(Fe),(ys=P.sprite(P.assets["images/time_512_neutral.png"])).x=0,ys.y=10,ys.scaleX=.8*p,ys.scaleY=.8*p,(Be=P.text(" : ","60px puzzler","black")).x=ys.width*p*.8+10,Be.y=ys.height*p/2-30,Be.pivotX=0,Be.pivotY=0,Be.scaleX=Rs,Be.scaleY=Rs,P.pushMessage(Be),(ws=P.sprite(P.assets["images/bananas_512_neutral.png"])).x=0,ws.y=0,ws.scaleX=.8*p,ws.scaleY=.8*p,(Oe=P.text(" : "+X.bananasToEat,"60px puzzler","black")).x=ws.width*p*.8+10,Oe.y=ws.height*p*.8/2-30,Oe.pivotX=0,Oe.pivotY=0,Oe.scaleX=Rs,Oe.scaleY=Rs,P.pushMessage(Oe),(ks=P.sprite(P.assets["images/yo_level_512.png"])).x=0,ks.y=0,ks.scaleX=.8*p,ks.scaleY=.8*p,(Ss=P.text("","40px puzzler","black")).x=ks.width*p*.8+10,Ss.y=ks.height*p/2-40,Ss.pivotX=0,Ss.pivotY=0,Ss.scaleX=Rs,Ss.scaleY=Rs,(zs=P.text("","40px puzzler","black")).x=ks.width*p*.8+10,zs.y=ks.height*p*.8/2+5,zs.pivotX=0,zs.pivotY=0,zs.scaleX=Rs,zs.scaleY=Rs,Tt(),St(),(xs=P.group(Ce,Fe)).x=10,xs.y=0,(bs=P.group(ys,Be)).x=10,bs.y=0,(fs=P.group(ws,Oe)).x=10,fs.y=xs.height*p*1.1+xs.y,(Ys=P.group(ks,Ss,zs)).x=10,Ys.y=bs.height*p*1.1+bs.y,(Hs=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{nt.press()},(Vs=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{pt.press()},(qs=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{rt.press()},(Us=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{at.press()},(N=P.group(Hs,Vs,qs,Us)).x=10,N.y=P.canvas.height/2-N.height/4*re,N.scaleX=N.scaleY=re,(Gs=P.button([P.assets["images/pad_512_up_up.png"],P.assets["images/pad_512_up_over.png"],P.assets["images/pad_512_up_up.png"]],[])).press=()=>{nt.press()},(Qs=P.button([P.assets["images/pad_512_down_up.png"],P.assets["images/pad_512_down_over.png"],P.assets["images/pad_512_down_up.png"]],[])).press=()=>{pt.press()},(Ks=P.button([P.assets["images/pad_512_right_up.png"],P.assets["images/pad_512_right_over.png"],P.assets["images/pad_512_right_up.png"]],[])).press=()=>{rt.press()},(Zs=P.button([P.assets["images/pad_512_left_up.png"],P.assets["images/pad_512_left_over.png"],P.assets["images/pad_512_left_up.png"]],[])).press=()=>{at.press()},(A=P.group(Gs,Qs,Ks,Zs)).x=P.canvas.width-A.width*re-10,A.y=P.canvas.height/2-A.height/4*re,A.scaleX=re,A.scaleY=re,js.push(Hs,Vs,qs,Us,Gs,Qs,Ks,Zs),Ee.height=Ne.height=2*xs.height*p+10,(Xs=P.group(xs,fs,Ee)).x=10,Xs.y=1.1*l.height*p,($s=P.group(bs,Ys,Ne)).x=P.canvas.width-$e.width+10,$s.y=1.1*vs.height*p,(Ls=P.group($e,Le,Xs,$s,je,vs,Je,De,Ve,u,qe,N,A,f,He)).layer=5,zt()}(),function(e,s){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1&&9<s)throw new Error(`This level : ${s} is not developped yet.`);ne=oe=12}else if(2===e){if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ne=oe=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ne=oe=16}if(Bs=F.level[e-1][s-1],E=s,L=e,c=P.gridSpecial(ne,oe,ae,ie,Bs,ze,X,Fs,r.scaleFactor(),!1,0,0),X.activeSprite=Fs[4],X.setVisible(),$=[],P.setYo(X),P.setStepArray($),g.b=X.bananasToEat,P.setGameInfo(g),(Ye=P.sprite(P.assets["images/forest24.jpg"])).layer=-1,Ye.pivotX=0,Ye.pivotY=0,Ae=P.sprite(P.assets["images/blocksBorder_12x12.png"]),Pe=P.sprite(P.assets["images/blocksBorder_14x14.png"]),Ie=P.sprite(P.assets["images/blocksBorder_16x16.png"]),Ae.layer=Pe.layer=Ie.layer=4,1===L)Ae.visible=!0,Pe.visible=!1,Ie.visible=!1,c.addChild(Ae);else if(2===L)Ae.visible=!1,Pe.visible=!0,Ie.visible=!1,c.addChild(Pe);else{if(3!==L)throw new Error(`Scene playing : ${L} not possible.`);Ae.visible=!1,Pe.visible=!1,Ie.visible=!0,c.addChild(Ie)}(Xe=P.group(Ye,c)).x=420,Xe.layer=2,(Es=P.group(Xe,Ls)).x=-P.canvas.width,Es.y=P.canvas.height,Es.layer=-1,zt(),B.setScene(e,r),wt()}(1,1),function(){y=P.sprite(P.assets["images/save_img.png"]),b=P.sprite(P.assets["images/save_img_in.png"]),rs=P.text("temp","30px puzzler","black"),gs=P.text("temp","30px puzzler","black"),ps=P.text("temp","30px puzzler","black"),ls=P.text("temp","30px puzzler","black"),ds=P.text("temp","30px puzzler","black"),cs=P.text("temp","30px puzzler","black"),hs=P.text("temp","30px puzzler","black"),_s=P.text("temp","30px puzzler","black"),At(),(ms=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.25*b.width-.5*ms.width*p,ms.y=b.height-1.2*ms.height*p-32,ms.scaleX=p,ms.scaleY=p,(us=P.button([P.assets["images/save_ok_512_up.png"],P.assets["images/save_ok_512_over.png"],P.assets["images/save_ok_512_up.png"]])).x=.75*b.width-.5*us.width*p,us.y=b.height-1.2*us.height*p-32,us.scaleX=p,us.scaleY=p,us.press=()=>{if(o&&a.playAllNoneTransform(i.save_second_sound),Q)localStorage.removeItem(`data${L}${E}_s`),localStorage.setItem(`data${L}${E}_g`,JSON.stringify(g)),localStorage.setItem(`data${L}${E}_gl`,JSON.stringify(n)),localStorage.setItem(`data${L}${E}_s`,JSON.stringify($));else{if(D=JSON.parse(localStorage.getItem(`data${L}${E}_g`)),H=JSON.parse(localStorage.getItem(`data${L}${E}_gl`)),V=JSON.parse(localStorage.getItem(`data${L}${E}_s`)),!D)return ft(L,E),void P.slide(x,x.x,P.canvas.height,30);if(ft(L,E),g={...D},n={...H},$=[...V],P.setGameInfo(g),P.setStepArray($),Tt(),1===$.length)return void P.slide(x,x.x,P.canvas.height,30);{var s=$;let e=1;P.setReplayMode(!0),Ms=setInterval(()=>{"u"===s[e].d?X.move("up",c,X,Fs):"d"===s[e].d?X.move("down",c,X,Fs):"r"===s[e].d?X.move("right",c,X,Fs):"l"===s[e].d&&X.move("left",c,X,Fs),++e===s.length&&(clearInterval(Ms),P.setReplayMode(!1))},Ze)}}P.slide(x,x.x,P.canvas.height,30)},ms.press=()=>{o&&a.playAllNoneTransform(i.save_cancel_sound),P.slide(x,x.x,P.canvas.height,30)};var e="30px puzzler";Ke=P.text("Replay > ",e,"black"),m=P.text(" Slow: ",e,"black"),v=P.text(" Fast: ",e,"black"),es=P.text(" Faster: ",e,"black"),ss=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),ts=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),as=P.button([P.assets["images/checked_box_512.png"],P.assets["images/checked_box_512.png"]]),is=P.sprite(P.assets["images/checked_512_up.png"]),ss.press=()=>{o&&a.playAllNoneTransform(i.checkbox_sound),is.x=m.x+m.width,Ze=200},ts.press=()=>{o&&a.playAllNoneTransform(i.checkbox_sound),is.x=v.x+v.width,Ze=100},as.press=()=>{o&&a.playAllNoneTransform(i.checkbox_sound),is.x=es.x+es.width,Ze=50},ns=P.group(Ke,is,m,ss,v,ts,es,as),(x=P.group(b,cs,hs,_s,ns,us,ms)).x=.5*P.canvas.width-.5*b.width,x.y=P.canvas.height,x.layer=50,(Ue=P.button([P.assets["images/save_cancel_512_up.png"],P.assets["images/save_cancel_512_over.png"],P.assets["images/save_cancel_512_up.png"]])).x=.5*y.width-.5*Ue.width*p,Ue.y=y.height-1.2*Ue.height*p-32,Ue.scaleX=p,Ue.scaleY=p,Ue.press=()=>{o&&a.playAllNoneTransform(i.save_cancel_sound),P.slide(os,os.x,-P.canvas.height,30)},(Ge=P.button([P.assets["images/save_512_in_up.png"],P.assets["images/save_512_in_over.png"],P.assets["images/save_512_in_up.png"]])).press=()=>{o&&a.playAllNoneTransform(i.save_sound);let e,s,t;G=!1,Q=!0,P.slide(x,x.x,.5*P.canvas.height-.5*b.height,30),P.slide(os,os.x,-P.canvas.height,30),ns.visible=!1,t=q?(e="Already saved",s="Want to save anyway !","The last saved game will be lost."):(e="Save !",s="First time saved.","Only one saved game at a time."),Pt(e,s,t)},Ge.x=.25*y.width-.5*Ge.width*p,Ge.y=y.height-1.2*Ge.height*p-32,Ge.scaleX=p,Ge.scaleY=p,(Qe=P.button([P.assets["images/save_512_out_up.png"],P.assets["images/save_512_out_over.png"],P.assets["images/save_512_out_up.png"]])).x=.75*y.width-.5*Qe.width*p,Qe.y=y.height-1.2*Qe.height*p-32,Qe.scaleX=p,Qe.scaleY=p,Qe.press=()=>{o&&a.playAllNoneTransform(i.save_sound);let e,s,t;G=!0,Q=!1,P.slide(x,x.x,.5*P.canvas.height-.5*b.height,30),P.slide(os,os.x,-P.canvas.height,30),q?(e="Load the game !",s="Present data will be lost.",t="Load anyway !",ns.visible=!0):(e="Can't open this game !",s="Not saved yet.",t="Only saved game can be opened.",ns.visible=!1),Pt(e,s,t)},(os=P.group(y,rs,gs,ps,ls,ds,Ge,Ue,Qe)).x=.5*P.canvas.width-.5*y.width,os.y=-P.canvas.height}(),Xt(),rt.press=gt.press=_t.press=xt.press=()=>{X.move("right",c,X,Fs),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},nt.press=ot.press=dt.press=ut.press=()=>{X.move("up",c,X,Fs),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},at.press=it.press=ct.press=mt.press=()=>{X.move("left",c,X,Fs),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},pt.press=lt.press=ht.press=vt.press=()=>{X.move("down",c,X,Fs),$.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},Js=[nt,ot,dt,ut,pt,lt,ht,vt,rt,gt,ct,mt,at,it,_t,xt,Hs,Vs,qs,Us,Gs,Qs,Ks,Zs],P.setButtonsMove(Js,u,ee)},["images/walk_512.json","images/info_box.png","images/info_level_box.png","images/view_420x1080.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/b_login.png","images/infogame.png","images/infogame_1024x511.png","images/infogame_1024x511_border.png","images/yo_level_512.png","images/save_img.png","images/save_img_in.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/next_512_up.png","images/next_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","sounds/bounce.wav","sounds/music.wav","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png","images/border_200x400.png","images/box_msg_border_960xx540.png","images/box_msg_back_960xx540.png","images/box_msg_ok_512_up.png","images/box_msg_ok_512_over.png"],function(){0===P.progressBar.counter&&(P.progressBar.setBackgroundColor("#FFA80F"),P.progressBar.setForegroundColor("#FFEC4B"),P.progressBar.create(P.canvas,P.assets,P.canvas.width/2,100));P.progressBar.update()})),at=(O.appendChild(P.canvas),window.loginHide=(e,s,t)=>{o&&a.playAllNoneTransform(i.button_sound),W.classList.remove("show"),W.classList.add("hide"),O.focus(),"yotesteur"===s&&"Yo&Testeur"===t?(j=!0,It("Good username","Good password","Let's go!")):(It("Something goes wrong","Check username and password","Retry!"),j=!1)},window.infoHide=e=>{o&&a.playAllNoneTransform(i.button_sound),R.classList.remove("show"),R.classList.add("hide"),O.focus()},window.about=e=>{o&&ee.value&&a.playAllNoneTransform(i.button_sound),M.src="./html_page/about.html"},window.general=e=>{o&&a.playAllNoneTransform(i.button_sound),M.src="./html_page/general.html"},window.buttonsExplained=e=>{o&&a.playAllNoneTransform(i.button_sound),M.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{o&&a.playAllNoneTransform(i.button_sound),M.src="./html_page/sparebutton.html"},P.keyboard(37)),it=P.keyboard(100),nt=P.keyboard(38),ot=P.keyboard(104),rt=P.keyboard(39),gt=P.keyboard(102),pt=P.keyboard(40),lt=P.keyboard(98),dt=P.keyboard(87),ct=P.keyboard(65),ht=P.keyboard(83),_t=P.keyboard(68),ut=P.keyboard(73),mt=P.keyboard(74),vt=P.keyboard(75),xt=P.keyboard(76);function yt(){0===X.bananasToEat&&(P.pause(),P.endGame(),P.wait(1e3).then(()=>bt()))}function bt(){pe.volume=.3,Nt("end"),ee.value=!1,Ve.visible&&Ve.press(),ee.value=!0,f.visible=!0,_.interactive=!0,h.interactive=!0}function wt(){o&&a.playAllNoneTransform(i.menu_sound),f.visible&&(f.visible=!1,_.interactive=!1,h.interactive=!1,js.forEach(e=>e.interactive=!0)),setTimeout(()=>{l.visible?(l.visible=!1,l.interactive=!1,e.visible=!0,e.interactive=!0,P.fadeIn(e,30),P.fadeOut(l,30),Z.classList.remove("hide"),Z.classList.add("show")):(l.visible=!0,l.interactive=!0,e.visible=!1,e.interactive=!1,P.fadeIn(l,30),P.fadeOut(e,30),Z.classList.remove("show"),Z.classList.add("hide"))},200)}function ft(e,s){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1||9<s)throw new Error(`This level : ${s} is not developped yet.`);ne=oe=12}else if(2===e){if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ne=oe=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ne=oe=16}if(Bs=F.level[e-1][s-1],E=s,L=e,1<s&&3===e&&!j)It("You are not allowed","to continue.","Not a tester."),--E;else{if(1e3<g.t&&(n.t=Object.values(g)[0],n.s=Object.values(g)[1],n.b=Object.values(g)[2]),Xe.remove(c),X.bananasToEat=0,c=P.gridSpecial(ne,oe,ae,ie,Bs,ze,X,Fs,r.scaleFactor(),!1,0,0),X.activeSprite=Fs[4],X.setVisible(),($=[]).push({x:X.activeSprite.gridX,y:X.activeSprite.gridY,d:"s"}),P.setYo(X),P.setStepArray($),Nt("resetAll"),g.t=0,g.s=0,g.b=X.bananasToEat,Lt(),P.setGameInfo(g),Tt(),1===L)Ae.visible=!0,Pe.visible=!1,Ie.visible=!1,c.addChild(Ae);else if(2===L)Ae.visible=!1,Pe.visible=!0,Ie.visible=!1,c.addChild(Pe);else{if(3!==L)throw new Error(`Scene playing : ${L} not possible.`);Ae.visible=!1,Pe.visible=!1,Ie.visible=!0,c.addChild(Ie)}Xe.addChild(c),B.setScene(e,r),Fe.content=" "+($.length-1),Oe.content=" "+X.bananasToEat}}function kt(e,s){L=e,E=s,d.content=Ts[L-1],t.content="Level "+E}function St(){Re.layer=100,Me.layer=100,We.layer=100,Re.content=`is_M=${et} & is_T=${tt} | DPI=${st} `,Me.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,Me.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,Me.content+=` | VW=${visualViewport.width},VH=`+visualViewport.height,We.content=`S_C=${r.scaleCanvas.toFixed(2)} & S_X= ${r.scaleX.toFixed(2)} & S_Y= `+r.scaleY.toFixed(2)}function Tt(){Fe.content=" "+($.length-1),Be.content=g.t<=0?" : .....":Et(g.t),Oe.content=" "+g.b,Ss.content=Ts[L-1],zs.content="     "+E}function zt(){var e=Ws*re;Hs.points=[{x:N.gx+.406*e,y:N.gy+.406*e},{x:N.gx+0*e,y:N.gy+0*e},{x:N.gx+e,y:N.gy+0*e},{x:N.gx+.6*e,y:N.gy+.406*e}],Vs.points=[{x:N.gx+.406*e,y:N.gy+.6*e},{x:N.gx+.6*e,y:N.gy+.6*e},{x:N.gx+e,y:N.gy+e},{x:N.gx+0*e,y:N.gy+e}],qs.points=[{x:N.gx+.6*e,y:N.gy+.406*e},{x:N.gx+e,y:N.gy+0*e},{x:N.gx+e,y:N.gy+e},{x:N.gx+.6*e,y:N.gy+.6*e}],Us.points=[{x:N.gx+.406*e,y:N.gy+.406*e},{x:N.gx+.406*e,y:N.gy+.6*e},{x:N.gx+0*e,y:N.gy+e},{x:N.gx+0*e,y:N.gy+0*e}],Gs.points=[{x:A.gx+.406*e,y:A.gy+.406*e},{x:A.gx+0*e,y:A.gy+0*e},{x:A.gx+e,y:A.gy+0*e},{x:A.gx+.6*e,y:A.gy+.406*e}],Qs.points=[{x:A.gx+.406*e,y:A.gy+.6*e},{x:A.gx+.6*e,y:A.gy+.6*e},{x:A.gx+e,y:A.gy+e},{x:A.gx+0*e,y:A.gy+e}],Ks.points=[{x:A.gx+.6*e,y:A.gy+.406*e},{x:A.gx+e,y:A.gy+0*e},{x:A.gx+e,y:A.gy+e},{x:A.gx+.6*e,y:A.gy+.6*e}],Zs.points=[{x:A.gx+.406*e,y:A.gy+.406*e},{x:A.gx+.406*e,y:A.gy+.6*e},{x:A.gx+0*e,y:A.gy+e},{x:A.gx+0*e,y:A.gy+0*e}]}function Yt(){var e=document.querySelector(":root");J.width=P.canvas.width*r.scaleCanvas,e.style.setProperty("--wait-width",J.width+"px"),e.style.setProperty("--wait-left",P.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",P.canvas.offsetTop+"px")}function Xt(){var e=document.querySelector(":root"),s=(getComputedStyle(e),Math.floor(l.width*p*r.scaleCanvas)),t=Math.floor(l.width*p*r.scaleCanvas),a=(P.canvas.offsetTop,10*r.scaleCanvas);let i=10;var n=P.canvas.offsetTop+l.y*r.scaleY,o=P.canvas.offsetLeft+(l.width*p+10)*r.scaleX;et&&(i=5),e.style.setProperty("--btn-width",s+"px"),e.style.setProperty("--btn-height",t+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",a+"px"),e.style.setProperty("--border-iframe",i+"px")}function $t(){var e=P.canvas.offsetTop+l.height*p*r.scaleCanvas+10,s=.95*(window.innerHeight-e),t=.8*window.innerWidth,a=document.getElementById("infoframe").contentWindow.document.querySelector(":root"),a=(et&&(a.style.setProperty("--font-p","15px"),a.style.setProperty("--margin-p-v","5px"),a.style.setProperty("--margin-p-h","10px"),a.style.setProperty("--font-header","15px"),a.style.setProperty("--font-footer","15px"),a.style.setProperty("--font-buttons","12px"),a.style.setProperty("--btn-width","80px"),a.style.setProperty("--bnt-height","25px"),a.style.setProperty("--img-w","64px"),a.style.setProperty("--img-h","64px"),a.style.setProperty("--margin-flex","5%"),a.style.setProperty("--margin-line","5px")),.1*window.innerWidth);R.style.top=e+"px",R.style.width=t+"px",R.style.height=s+"px",R.style.margin=`0  ${a}px`}function Lt(){D=JSON.parse(localStorage.getItem(`data${L}${E}_g`)),H=JSON.parse(localStorage.getItem(`data${L}${E}_gl`)),V=JSON.parse(localStorage.getItem(`data${L}${E}_s`)),n=H?{...H}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1}}function Et(e){var e=(e/1e3).toFixed(1),s=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),t=Math.floor(e/60);let a="0",i=9<t?"":"0";return 9<e%60&&(a=""),t<=0?""+a+e%60+"."+s:""+i+t+`:${a}${e%60}.`+s}function Nt(e){let s={};function t(i,n){var e="40px puzzler";let s=void 0,t=void 0,a=void 0;if(0===i)n.first<0?(w[i][0].content="?",w[i][0].x=272-.5*I(e,"?").width):(s=+(n.first/1e3).toFixed(1),w[i][0].content=Et(n.first),w[i][0].x=272-.5*I(e,Et(n.first)).width),n.second<=0?(w[i][1].content="?",w[i][1].x=480-.5*I(e,"?").width):(t=+(n.second/1e3).toFixed(1),w[i][1].content=Et(n.second),w[i][1].x=480-.5*I(e,Et(n.second)).width),n.third<=0?(w[i][2].content="?",w[i][2].x=672-.5*I(e,"?").width):(a=+(n.third/1e3).toFixed(1),w[i][2].content=Et(n.third),w[i][2].x=672-.5*I(e,Et(n.third)).width);else if(1===i)n.first<0?(w[i][0].content="?",w[i][0].x=272-.5*I(e,"?").width):(s=n.first,w[i][0].content=n.first.toString(),w[i][0].x=272-.5*I(e,n.first.toString()).width),n.second<=0?(w[i][1].content="?",w[i][1].x=480-.5*I(e,"?").width):(t=n.second,w[i][1].content=n.second.toString(),w[i][1].x=480-.5*I(e,n.second.toString()).width),n.third<=0?(w[i][2].content="?",w[i][2].x=672-.5*I(e,"?").width):(a=n.third,w[i][2].content=n.third.toString(),w[i][2].x=672-.5*I(e,n.third.toString()).width);else if(2===i){let e=void 0,s=void 0,t=void 0,a=void 0;n.first<0?(w[i][0].content="?",w[i][0].x=405,w[i][1].content="?"):(e=n.first,w[i][0].content=n.first.toString(),w[i][0].x=415-10*n.first.toString().length),n.second<0?(w[i][2].content="?",w[i][2].x=854):(s=n.second,w[i][2].content=n.second.toString(),w[i][2].x=864-10*n.second.toString().length),void 0!==e&&void 0!==s&&(n.first===n.second?w[i][1].content="=":n.first<n.second?w[i][1].content="<":w[i][1].content=">"),n.third<0?(w[i][4].content="?",w[i][4].x=1290,w[i][3].content="?",w[i][5].content="?"):(t=n.third,w[i][4].content=n.third.toString(),w[i][4].x=1300-10*n.third.toString().length),void 0!==s&&void 0!==t&&(n.second===n.third?w[i][3].content="=":n.second<n.third?w[i][3].content="<":w[i][3].content=">"),n.fourth<0?(w[i][6].content="?",w[i][6].x=1706,w[i][5].content="?"):(a=n.fourth,w[i][6].content=n.fourth.toString(),w[i][6].x=1716-10*n.fourth.toString().length),void 0!==t&&void 0!==a&&(n.third===n.fourth?w[i][5].content="=":n.third<n.fourth?w[i][5].content="<":w[i][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,r.quota=(e/1024/1024).toFixed(1))}();function a(){s.first=g.t,s.second=n.bt,s.third=ge[L-1][E-1].csec,t(0,s),s.first=g.s,s.second=n.bs,s.third=ge[L-1][E-1].s,t(1,s)}"restart"===e||"infoBtn"===e?a():"end"===e&&(n.bt=Math.min(n.bt<=0?1/0:n.bt,g.t),n.bs=Math.min(n.bs<=0?1/0:n.bs,g.s),n.bb=Math.min(n.bb<=0?1/0:n.bb,g.b),n.t=g.t,n.s=g.s,n.b=g.b,localStorage.setItem(`data${L}${E}_gl`,JSON.stringify(n)),localStorage.setItem(`ended_${L}_`+E,"1"),a())}function I(e,s){return P.canvas.ctx.font=e,{width:P.canvas.ctx.measureText(s).width,height:P.canvas.ctx.measureText("M").width}}function At(e,s,t,a,i){let n="40px puzzler",o="60px puzzler";et&&(n="40px puzzler",o="50px puzzler"),G=Q=!1,D=JSON.parse(localStorage.getItem(`data${L}${E}_g`)),H=JSON.parse(localStorage.getItem(`data${L}${E}_gl`)),V=JSON.parse(localStorage.getItem(`data${L}${E}_s`)),i=D?(q=!0,U=!0,e="Open the game !",s=Ts[L-1]+" Level:"+E,t="Time : "+Et(D.t),a="Steps : "+D.s,"Bananas : "+D.b):(q=!1,U=!1,e="Save the game !",s=Ts[L-1]+" Level:"+E,t="Time : "+Et(g.t),a="Steps : "+g.s,"Bananas : "+g.b),rs.font=o,rs.content=e,rs.width=I(o,e).width,rs.height=I(o,e).height,rs.x=.5*y.width-.5*rs.width,rs.y=32,gs.font=o,gs.content=s,gs.width=I(o,s).width,gs.height=I(o,s).height,gs.x=.5*y.width-.5*gs.width,gs.y=rs.y+rs.height+10,ps.content=t,ps.font=n,ps.width=I(n,t).width,ps.height=I(n,t).height,ps.x=.5*y.width-.5*ps.width,ps.y=gs.y+gs.height+20,ls.content=a,ls.font=n,ls.width=I(n,a).width,ls.height=I(n,a).height,ls.x=.5*y.width-.5*ls.width,ls.y=ps.y+ps.height+10,ds.content=i,ds.font=n,ds.width=I(n,i).width,ds.height=I(n,i).height,ds.x=.5*y.width-.5*ds.width,ds.y=ls.y+ls.height+10}function Pt(e,s,t){let a="40px puzzler",i="60px puzzler";var n="30px puzzler",e=(et&&(a="40px puzzler",i="50px puzzler"),cs.font=i,cs.content=e,cs.width=I(i,e).width,cs.height=I(i,e).height,cs.x=.5*b.width-.5*cs.width,cs.y=32,hs.font=i,hs.content=s,hs.width=I(i,s).width,hs.height=I(i,s).height,hs.x=.5*b.width-.5*hs.width,hs.y=cs.y+cs.height+10,_s.content=t,_s.font=a,_s.width=I(a,t).width,_s.height=I(a,t).height,_s.x=.5*b.width-.5*_s.width,_s.y=hs.y+hs.height+20,Ke.font=n,Ke.width=I(n,"Replay > ").width,Ke.height=I(n,"Replay > ").height,m.font=n,m.width=I(n," Slow: ").width,m.height=I(n," Slow: ").height,v.font=n,v.width=I(n," Fast: ").width,v.height=I(n," Fast: ").height,es.font=n,es.width=I(n," Faster: ").width,es.height=I(n," Faster: ").height,ss.scaleX=ss.scaleY=.5*p,ts.scaleX=ts.scaleY=.5*p,as.scaleX=as.scaleY=.5*p,is.scaleX=is.scaleY=.5*p,m.x=Ke.width,ss.x=m.x+m.width,v.x=m.x+m.width+ss.width*p*.5,ts.x=v.x+v.width,0===is.x&&(is.x=ts.x),es.x=v.x+v.width+ts.width*p*.5,as.x=es.x+es.width,Ke.y=m.y=v.y=es.y=ss.height*p*.5*.5-.5*Ke.height,ns.y=_s.y+_s.height+20,Ke.width+m.width+v.width+es.width+3*ts.width*p*.5);ns.x=.5*b.width-.5*e}function It(e="Message 1",s="Message 2",t="Message 3"){var a="60px puzzler",e=(Cs.visible=!1,Is.visible=!0,T.content=e,T.font=a,T.width=I(a,e).width,T.height=I(a,e).height,T.x=.5*k.width-.5*T.width,T.y=100,T.visible=!1,z.content=s,z.font=a,z.width=I(a,s).width,z.height=I(a,s).height,z.x=.5*k.width-.5*z.width,z.y=T.y+T.height+30,z.visible=!1,Y.content=t,Y.font=a,Y.width=I(a,t).width,Y.height=I(a,t).height,Y.x=.5*k.width-.5*Y.width,Y.y=z.y+z.height+30,Y.visible=!1,S.width=k.width,S.x=k.x,S.height=k.height,S.y=k.y,P.tweenProperty(S,"width",S.width,S.width-192,60));P.tweenProperty(S,"height",S.height,S.height-192,60),P.tweenProperty(S,"x",S.x,S.x+96,60),P.tweenProperty(S,"y",S.y,S.y+96,60),e.onComplete=()=>{Cs.visible=!0,Cs.interactive=!0,T.visible=!0,z.visible=!0,Y.visible=!0}}P.start(),P.scaleToWindow(r),Yt(),window.addEventListener("resize",e=>{P.scaleToWindow(r),St(),Xt(),$t(),Yt()}),document.addEventListener("fullscreenchange",e=>{P.scaleToWindow(r),St(),(ve=!ve)?s.src=P.assets["images/fullscreen_off_512_over.png"].src:s.src=P.assets["images/fullscreen_on_512_over.png"].src});