import{game as B}from"./engine.js";import*as O from"./level.js";import*as R from"./move.js";import*as M from"./sounds.js";import*as W from"./gamesounds.js";import"./typedef.js";let A=document.getElementById("main"),j=document.getElementById("infodiv"),N=document.getElementById("infoframe"),D=document.getElementById("logindiv");document.getElementById("loginframe");let J=!1,V=document.getElementById("wait-video"),g={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>g.boxSize/512,quota:void 0};let r={t:0,s:0,b:-1},a={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},H=void 0,q=void 0,G=void 0,U=!1,Q=!1,K=!1,Z=!1,s=document.getElementById("btn-1"),ee=document.getElementById("btn-2"),se=document.getElementById("btn-3"),te=document.getElementsByClassName("floating-menu")[0],ie,ae=!1,ne={value:!0},oe=!1,ge=1920,re=1080,pe=90,le=90,ce=12,de=12,p=.2,he=.75,_e=[[{s:70,t:15.23,csec:15234},{s:106,t:159.3,csec:15930},{s:144,t:421.19,csec:42119},{s:116,t:385.03,csec:38503},{s:114,t:410.32,csec:41032},{s:163,t:1042.31,csec:104231},{s:142,t:646.3,csec:64630},{s:233,t:1017.17,csec:101717},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:267,t:2518.64,csec:251864},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}],[{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}]];let ue,me,ve,xe,be,we,ye,fe,Se,ke,l,e,ze,Ye,t,Ee,Xe,$e,Le,i,Pe,Ie,Te,n,Ce,Fe,Be,Oe,Re,Me,We,Ae,je,Ne,De,Je,Ve,He,qe,Ge,Ue,Qe,Ke,o,Ze,c,es,ss,d,ts,is,as,ns,os,gs=100,h,_,rs,ps,ls,cs,ds,hs,_s,u,m,v,us,ms,vs,xs,bs,ws,ys,fs,Ss,ks,zs,Ys,Es,Xs,$s,Ls,Ps,Is,Ts=["12x12","14x14","16x16"],Cs,Fs,Bs,Os,Rs,Ms,Ws,As,x,js,b,Ns,w,y,f,S,k,z,Y={},E=[],X=[],$=1,L=1,Ds=O.level[$-1][L-1],Js=1,Vs=1,Hs=setInterval(()=>T.progressBar.update(),5),qs=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),Gs=[],Us,Qs=[],P,Ks,Zs,et,st,I,tt,it,at,nt,ot=/Mobile/i.test(navigator.userAgent),gt=window.devicePixelRatio.toFixed(2),rt=!1,T=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(rt=!0),ot&&(Vs=3.5<=gt&&gt<=4.2?Js=1.2:2.8<=gt&&gt<3.5?(Js=1.5,1.2):(Js=1.6,1.5)),new B(ge,re,function(){document.body.removeChild(V),T.progressBar.remove(),clearInterval(Hs),s.src=T.assets["images/fullscreen_on_512_up.png"].src,s.style.width="64px",ee.src=T.assets["images/sound_no_240_up.png"].src,ee.style.width="64px",se.src=T.assets["images/b_music_512_up.png"].src,se.style.width="64px",s.onpointerdown=e=>(F(),ze=document.fullscreenElement?(document.exitFullscreen(),s.src=T.assets["images/fullscreen_on_512_up.png"].src,!1):(A.requestFullscreen().catch(e=>console.log(e)),s.src=T.assets["images/fullscreen_off_512_up.png"].src,!0),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{ze?s.src=T.assets["images/fullscreen_off_512_over.png"].src:s.src=T.assets["images/fullscreen_on_512_over.png"].src}),s.addEventListener("mouseleave",()=>{ze?s.src=T.assets["images/fullscreen_off_512_up.png"].src:s.src=T.assets["images/fullscreen_on_512_up.png"].src}),ee.onpointerdown=e=>(ie?"suspended"===T.actx.state&&T.actx.resume():(ie=new(window.AudioContext||window.webkitAudioContext),T.setActx(ie),T.actx.resume()),(ae=!ae)?("suspended"===T.actx.state&&T.actx.resume(),$t(),ee.src=T.assets["images/sound_yes_240_up.png"].src,F(),R.setSoundEffect(me)):(ee.src=T.assets["images/sound_no_240_up.png"].src,F()),R.setSound(ae),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),ee.addEventListener("mouseover",()=>{ae?ee.src=T.assets["images/sound_yes_240_over.png"].src:ee.src=T.assets["images/sound_no_240_over.png"].src}),ee.addEventListener("mouseleave",()=>{ae?ee.src=T.assets["images/sound_yes_240_up.png"].src:ee.src=T.assets["images/sound_no_240_up.png"].src}),se.onpointerdown=e=>("suspended"===T.actx.state&&T.actx.resume(),(oe=!oe)?("suspended"===T.actx.state&&T.actx.resume(),$t(),ue.play(),se.src=T.assets["images/b_music_512_on_up.png"].src,F()):(se.src=T.assets["images/b_music_512_up.png"].src,F(),ue.pause()),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),se.addEventListener("mouseover",()=>{oe?se.src=T.assets["images/b_music_512_on_over.png"].src:se.src=T.assets["images/b_music_512_over.png"].src}),se.addEventListener("mouseleave",()=>{oe?se.src=T.assets["images/b_music_512_on_up.png"].src:se.src=T.assets["images/b_music_512_up.png"].src}),Ce=[T.assets["walkDownRight.png"],T.assets["images/road_512.png"],T.assets["images/forest_512.png"],T.assets["images/box_512.png"],T.assets["images/bananas_0_512.png"],T.assets["walkUpRight.png"],T.assets["walkUpLeft.png"],T.assets["walkUpRightPush.png"],T.assets["walkUpLeftPush.png"],T.assets["walkDownRight.png"],T.assets["walkDownLeft.png"],T.assets["walkDownRightPush.png"],T.assets["walkDownLeftPush.png"],T.assets["walkRightRight.png"],T.assets["walkRightLeft.png"],T.assets["walkRightRightPush.png"],T.assets["walkRightLeftPush.png"],T.assets["walkLeftRight.png"],T.assets["walkLeftLeft.png"],T.assets["walkLeftRightPush.png"],T.assets["walkLeftLeftPush.png"]],Y.setVisible=()=>{E.forEach(e=>{e===Y.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},Y.layer=3,Y.bananasToEat=0,Y.move=R.moveScene,function(){(function(){w=T.sprite(T.assets["images/box_msg_border_960xx540_convert.png"]),(y=T.sprite(T.assets["images/box_msg_back_960xx540_10.png"])).pivotX=.5*y.width,y.pivotY=.5*y.height;var e="60px puzzler";(z=T.button([T.assets["images/box_msg_ok_512_up.png"],T.assets["images/box_msg_ok_512_over.png"],T.assets["images/box_msg_ok_512_up.png"]])).scaleX=z.scaleY=p,z.x=.5*w.width-.5*z.width*p,z.y=w.height-z.height*p-96,z.interactive=!1,z.press=()=>{F(),Ns.visible=!1,z.interactive=!1},(f=T.text("msg_1",e,"black")).width=C(e," msg_1: ").width,f.height=C(e," msg_1: ").height,f.x=.5*w.width-.5*f.width,f.y=100,(S=T.text("msg_2",e,"black")).width=C(e," msg_2: ").width,S.height=C(e," msg_2: ").height,S.x=.5*w.width-.5*S.width,S.y=f.y+f.height+30,(k=T.text("msg_3",e,"black")).width=C(e," msg_3: ").width,k.height=C(e," msg_3: ").height,k.x=.5*w.width-.5*k.width,k.y=S.y+S.height+30,(Ns=T.group(w,y,f,S,k,z)).x=.5*T.canvas.width-.5*w.width,Ns.y=.5*T.canvas.height-.5*w.height,Ns.layer=100,Ns.visible=!1})(),(qe=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-135,(Ge=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-90,(Ue=T.text("First","40px puzzler","deepskyblue")).y=T.canvas.height-45;(we=T.sprite(T.assets["images/fond_ecran_950.jpg"])).x=(T.canvas.width-we.width)/2,we.y=(T.canvas.height-we.height)/2,$=$||1;L=L||1;(e=T.button([T.assets["images/menu_open_512_up.png"],T.assets["images/menu_open_512_over.png"],T.assets["images/menu_open_512_up.png"]])).x=10,e.y=10,e.pivotX=0,e.pivotY=0,e.scaleX=p,e.scaleY=p,e.layer=20,e.visible=!1,e.interactive=!1,e.press=()=>Et(),(l=T.button([T.assets["images/menu_512_up.png"],T.assets["images/menu_512_over.png"],T.assets["images/menu_512_up.png"]])).x=10,l.y=10,l.pivotX=0,l.pivotY=0,l.scaleX=p,l.scaleY=p,l.layer=20,l.press=()=>Et(),(Le=T.sprite(T.assets["images/info_level_box.png"])).width=300,(i=T.text("12x12","50px puzzler","black",20,40)).content=Ts[$-1],i.x=Le.width/4,i.y=Le.height/2-25,(Pe=T.button([T.assets["images/b_scene_top_up.png"],T.assets["images/b_scene_top_over.png"],T.assets["images/b_scene_top_up.png"]])).x=Le.width/2-Pe.width/2,Pe.y=Le.height/4-Pe.height/2,Pe.press=()=>{F(),$<3&&($+=1,L=1,Lt($,L),Xt($,L),T.slide(i,i.x,i.y-40,10,["smoothstep"]),T.fadeOut(i,10),setTimeout(()=>{i.content=Ts[$-1],i.y+=80,T.slide(i,i.x,Le.height/2-25,15,["smoothstep"]),T.fadeIn(i,15)},100))},(Ie=T.button([T.assets["images/b_scene_up.png"],T.assets["images/b_scene_over.png"],T.assets["images/b_scene_up.png"]])).x=Le.width/2-Ie.width/2,Ie.y=3*Le.height/4-Pe.height/2,Ie.press=()=>{F(),1<$&&(--$,L=1,Lt($,L),Xt($,L),T.slide(i,i.x,i.y+40,10,["smoothstep"]),T.fadeOut(i,10),setTimeout(()=>{i.content=Ts[$-1],i.y-=80,T.slide(i,i.x,Le.height/2-25,15,["smoothstep"]),T.fadeIn(i,15)},200))},(Te=T.group(Le,i,Pe,Ie)).x=-T.canvas.width,Te.y=-T.canvas.height,Ye=T.sprite(T.assets["images/info_level_box.png"]),(t=T.text("Level "+L,"50px puzzler","black",20,40)).x=Le.width/4,t.y=Le.height/2-25,(Ee=T.button([T.assets["images/b_scene_top_up.png"],T.assets["images/b_scene_top_over.png"],T.assets["images/b_scene_top_up.png"]])).press=()=>{F(),L<9&&(L+=1,Xt($,L),T.slide(t,t.x,t.y-40,10,["smoothstep"]),T.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y+=80,T.slide(t,t.x,Ye.height/2-25,15,["smoothstep"]),T.fadeIn(t,15)},100))},Ee.x=Ye.width/2-Ee.width/2,Ee.y=Ye.height/4-Ee.height/2,(Xe=T.button([T.assets["images/b_scene_up.png"],T.assets["images/b_scene_over.png"],T.assets["images/b_scene_up.png"]])).x=Ye.width/2-Xe.width/2,Xe.y=3*Ye.height/4-Ee.height/2,Xe.press=()=>{F(),1<L&&(--L,Xt($,L),T.slide(t,t.x,t.y+40,10,["smoothstep"]),T.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y-=80,T.slide(t,t.x,Ye.height/2-25,15,["smoothstep"]),T.fadeIn(t,15)},100))},t.y=Ye.height/2-25,($e=T.group(Ye,t,Ee,Xe)).x=T.canvas.width,$e.y=-T.canvas.height,(ke=T.button([T.assets["images/b_info_up.png"],T.assets["images/b_info_over.png"],T.assets["images/b_info_up.png"]])).x=(T.canvas.width-we.width)/4-.5*ke.width*Js/2,ke.y=re-ke.width,ke.scaleX=.5*Js,ke.scaleY=.5*Js,ke.press=()=>{F(),ne.value=!1,window.about(),ne.value=!0;let e=T.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=ke.x+ke.width/2,e.y=ke.y+ke.height/2;var s=T.slide(e,e.x,100,30);T.tweenProperty(e,"scaleX",e.scaleX,180,30),T.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{j.classList.remove("hide"),j.classList.add("show"),Bt(),T.remove(e)}},(fe=T.button([T.assets["images/b_reset.png"],T.assets["images/b_reset.png"],T.assets["images/b_reset.png"]])).x=T.canvas.width-fe.width*Js,fe.y=0,fe.scaleX=Js,fe.scaleY=Js,fe.press=()=>{F();for(let s=1;s<4;s++)for(let e=1;e<10;e++)localStorage.removeItem(`data${s}${e}_g`),localStorage.removeItem(`data${s}${e}_gl`),localStorage.removeItem(`data${s}${e}_s`),localStorage.removeItem("data"+s+e)},(Se=T.button([T.assets["images/b_login.png"],T.assets["images/b_login.png"],T.assets["images/b_login.png"]])).x=fe.x,Se.y=T.canvas.height-Se.height,Se.scaleX=Js,Se.scaleY=Js,Se.press=()=>{F(),D.classList.contains("hide")?(D.classList.remove("hide"),D.classList.add("show")):(D.classList.remove("show"),D.classList.add("hide"))},(ye=T.button([T.assets["images/b_play_up.png"],T.assets["images/b_play_over.png"],T.assets["images/b_play_up.png"]])).x=ge,ye.y=re,ye.scaleX=Js,ye.scaleY=Js,ye.press=()=>{F(),te.classList.contains("show")&&(te.classList.remove("show"),te.classList.add("hide"),Et()),qe.visible=!1,Ge.visible=!1,Ue.visible=!1,T.slide(be,T.canvas.width,T.canvas.height,30,["decelerationCubed"]),T.slide(Ms,0,0,30,["decelerationCubed"]).onComplete=()=>{Tt()},$=$||1,L=L||1,i.content=Ts[$-1],t.content="Level "+L,Xt($,L),Lt($,L),Ot(),T.state=zt},T.slide(ye,T.canvas.width-(T.canvas.width-we.width)/4-ye.width/2,.75*T.canvas.height-ye.width/2,30,["decelerationCubed"]),T.slide(Te,(T.canvas.width-we.width)/4-Te.width/2,we.y+Te.height/2,30,["decelerationCubed"]),T.slide($e,T.canvas.width-(T.canvas.width-we.width)/4-$e.width/2,we.y+$e.height/2,30,["decelerationCubed"]),be=T.group(we,ke,ye,fe,Se,$e,Te,l,e)}(),function(){(function(){(Ws=T.sprite(T.assets["images/infogame_1024x511_1.png"])).height=525,As=T.sprite(T.assets["images/infogame_1024x511_border_1.png"]),js=T.group(Ws);var e="40px puzzler";(x=[[T.text("First",e,"black",216,236),T.text("First",e,"black",470,236),T.text("First",e,"black",622,236)],[T.text("First",e,"black",216,396),T.text("First",e,"black",470,396),T.text("First",e,"black",622,396)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),x[0][0].content="23.82",x[0][1].content="=",(c=T.button([T.assets["images/restart_512_up.png"],T.assets["images/restart_512_over.png"],T.assets["images/restart_512_up.png"]])).press=()=>{Ze.press()},c.x=896-c.width*p*.5,c.y=160-c.width*p*.5,c.scaleX=p,c.scaleY=p,c.interactive=!1,js.add(c),(o=T.button([T.assets["images/next_512_up.png"],T.assets["images/next_512_over.png"],T.assets["images/next_512_up.png"]])).press=()=>{Ke.press()},o.x=896-o.width*p*.5,o.y=330-o.width*p*.5,o.scaleX=p,o.scaleY=p,o.interactive=!1,js.add(o);for(let s=0;s<2;s++)for(let e=0;e<3;e++)js.add(x[s][e]);js.x=96,js.y=90,(b=T.group(As,js)).visible=!1})(),b.x=.5*T.canvas.width-.5*As.width,b.y=.5*T.canvas.height-.5*As.height,(Qe=T.button([T.assets["images/home_512_up.png"],T.assets["images/home_512_over.png"],T.assets["images/home_512_up.png"]])).press=()=>{F(),qe.visible=!0,Ge.visible=!0,Ue.visible=!0,b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0)),Xt($,L),Lt($,L),T.slide(Ms,-T.canvas.width,T.canvas.height,30,["decelerationCubed"]).onComplete=()=>{Tt()},T.slide(be,0,0,30,["decelerationCubed"]),T.endGame()},Qe.x=T.canvas.width-1.1*Qe.width*p,Qe.y=10,Qe.scaleX=p,Qe.scaleY=p,(zs=T.button([T.assets["images/infogame_512_up.png"],T.assets["images/infogame_512_over.png"],T.assets["images/infogame_512_up.png"]])).press=()=>{F(),Mt("infoBtn"),b.visible=!b.visible,b.visible?(o.interactive=!0,c.interactive=!0):(o.interactive=!1,c.interactive=!1)},zs.x=Qe.x-1.1*zs.width*p,zs.y=10,zs.scaleX=p,zs.scaleY=p,zs.visible=!1,zs.interactive=!1,Qs.push(zs),(Ke=T.button([T.assets["images/next_512_up.png"],T.assets["images/next_512_over.png"],T.assets["images/next_512_up.png"]])).press=()=>{F(),b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1),localStorage.getItem(`ended_${$}_`+L)?$<=2&&L<=8&&(L+=1,Xt($,L),Ot(),T.state=zt):jt(`Level ${L} must be completed`,"before playing the next one.","See you soon !")},Ke.x=zs.x-1.1*Ke.width*p,Ke.y=10,Ke.scaleX=p,Ke.scaleY=p,Ke.visible=!1,Ke.interactive=!1,Qs.push(Ke),(ss=T.button([T.assets["images/pause_512_up.png"],T.assets["images/pause_512_over.png"],T.assets["images/pause_512_up.png"]])).press=()=>{b.visible&&(b.visible=!1,Gs.forEach(e=>e.interactive=!0)),T.isPlaying&&T.pause(),ss.visible=!1,ss.interactive=!1,d.visible=!0,setTimeout(()=>{d.interactive=!0},200),Qs.forEach((e,s)=>{e.visible=!0,e.interactive=!0}),F()},b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0));ss.x=l.x,ss.y=10,ss.scaleX=p,ss.scaleY=p,(d=T.button([T.assets["images/pause_on_512_up.png"],T.assets["images/pause_on_512_over.png"],T.assets["images/pause_on_512_up.png"]])).press=()=>{b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0)),ss.visible=!0,d.visible=!1,d.interactive=!1,setTimeout(()=>{ss.interactive=!0},200),Qs.forEach((e,s)=>{e.visible=!1,e.interactive=!1}),F()},b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0));d.x=l.x,d.y=10,d.scaleX=p,d.scaleY=p,d.visible=!1,d.interactive=!1,(Ze=T.button([T.assets["images/restart_512_up.png"],T.assets["images/restart_512_over.png"],T.assets["images/restart_512_up.png"]])).press=()=>{F(),b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0)),Xt($,L),T.slide(Ms,0,0,30,["decelerationCubed"]),T.state=zt},Ze.x=l.x+1.1*l.width*p,Ze.y=10,Ze.scaleX=p,Ze.scaleY=p,Ze.visible=!1,Ze.interactive=!1,Qs.push(Ze),(ts=T.button([T.assets["images/save_512_up.png"],T.assets["images/save_512_over.png"],T.assets["images/save_512_up.png"]])).press=()=>{F(),b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1),Wt(),T.slide(_s,.5*T.canvas.width-380,.5*T.canvas.height-256,30)},ts.x=Ze.x+1.1*ts.width*p,ts.y=10,ts.scaleX=p,ts.scaleY=p,ts.visible=!1,ts.interactive=!1,Qs.push(ts),(es=T.button([T.assets["images/b_about_up_128.png"],T.assets["images/b_about_over_128.png"],T.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:ot,is_T:rt,DPI:gt,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:g.scaleCanvas.toFixed(2),S_X:g.scaleX.toFixed(2),S_Y:g.scaleY.toFixed(2),Q:g.quota},s={scene:$,level:L},t=[],e=(t.push(e,s,r,X),`Yo_${Ts[$-1]}_Level_`+L);s=document.createElement("a"),t=new Blob([JSON.stringify(t)],{type:"text/plain"});s.setAttribute("href",URL.createObjectURL(t)),s.setAttribute("download",e.toLowerCase()+".json"),s.click(),URL.revokeObjectURL(s.href)}(),es.x=Ze.x,es.y=T.canvas.height-es.height-10,(Me=T.sprite(T.assets["images/border_200x400.png"])).layer=5,(We=T.sprite(T.assets["images/border_200x400.png"])).layer=5,Oe=T.sprite(T.assets["images/view_420x1080_10.png"]),Re=T.sprite(T.assets["images/view_420x1080_10.png"]),Oe.width=Re.width=420,Re.x=1500,(De=T.sprite(T.assets["images/step_512_neutral.png"])).x=0,De.y=10,De.scaleX=.8*p,De.scaleY=.8*p,(Je=T.text(" : "+(X.length-1),"60px puzzler","black")).x=De.width*p*.8+10,Je.y=De.height*p/2-30,Je.pivotX=0,Je.pivotY=0,Je.scaleX=Vs,Je.scaleY=Vs,T.pushMessage(Je),(Es=T.sprite(T.assets["images/time_512_neutral.png"])).x=0,Es.y=10,Es.scaleX=.8*p,Es.scaleY=.8*p,(Ve=T.text(" : ","60px puzzler","black")).x=Es.width*p*.8+10,Ve.y=Es.height*p/2-30,Ve.pivotX=0,Ve.pivotY=0,Ve.scaleX=Vs,Ve.scaleY=Vs,T.pushMessage(Ve),($s=T.sprite(T.assets["images/bananas_512_neutral.png"])).x=0,$s.y=0,$s.scaleX=.8*p,$s.scaleY=.8*p,(He=T.text(" : "+Y.bananasToEat,"60px puzzler","black")).x=$s.width*p*.8+10,He.y=$s.height*p*.8/2-30,He.pivotX=0,He.pivotY=0,He.scaleX=Vs,He.scaleY=Vs,T.pushMessage(He),(Ps=T.sprite(T.assets["images/yo_level_512.png"])).x=0,Ps.y=0,Ps.scaleX=.8*p,Ps.scaleY=.8*p,(Is=T.text("","40px puzzler","black")).x=Ps.width*p*.8+10,Is.y=Ps.height*p/2-40,Is.pivotX=0,Is.pivotY=0,Is.scaleX=Vs,Is.scaleY=Vs,(Cs=T.text("","40px puzzler","black")).x=Ps.width*p*.8+10,Cs.y=Ps.height*p*.8/2+5,Cs.pivotX=0,Cs.pivotY=0,Cs.scaleX=Vs,Cs.scaleY=Vs,It(),Pt(),(Ys=T.group(De,Je)).x=10,Ys.y=0,(Xs=T.group(Es,Ve)).x=10,Xs.y=0,(Ls=T.group($s,He)).x=10,Ls.y=Ys.height*p*1.1+Ys.y,(Fs=T.group(Ps,Is,Cs)).x=10,Fs.y=Xs.height*p*1.1+Xs.y,(Ks=T.button([T.assets["images/pad_512_up_up.png"],T.assets["images/pad_512_up_over.png"],T.assets["images/pad_512_up_up.png"]],[])).press=()=>{ct.press()},(Zs=T.button([T.assets["images/pad_512_down_up.png"],T.assets["images/pad_512_down_over.png"],T.assets["images/pad_512_down_up.png"]],[])).press=()=>{ut.press()},(et=T.button([T.assets["images/pad_512_right_up.png"],T.assets["images/pad_512_right_over.png"],T.assets["images/pad_512_right_up.png"]],[])).press=()=>{ht.press()},(st=T.button([T.assets["images/pad_512_left_up.png"],T.assets["images/pad_512_left_over.png"],T.assets["images/pad_512_left_up.png"]],[])).press=()=>{pt.press()},(P=T.group(Ks,Zs,et,st)).x=10,P.y=T.canvas.height/2-P.height/4*he,P.scaleX=P.scaleY=he,(tt=T.button([T.assets["images/pad_512_up_up.png"],T.assets["images/pad_512_up_over.png"],T.assets["images/pad_512_up_up.png"]],[])).press=()=>{ct.press()},(it=T.button([T.assets["images/pad_512_down_up.png"],T.assets["images/pad_512_down_over.png"],T.assets["images/pad_512_down_up.png"]],[])).press=()=>{ut.press()},(at=T.button([T.assets["images/pad_512_right_up.png"],T.assets["images/pad_512_right_over.png"],T.assets["images/pad_512_right_up.png"]],[])).press=()=>{ht.press()},(nt=T.button([T.assets["images/pad_512_left_up.png"],T.assets["images/pad_512_left_over.png"],T.assets["images/pad_512_left_up.png"]],[])).press=()=>{pt.press()},(I=T.group(tt,it,at,nt)).x=T.canvas.width-I.width*he-10,I.y=T.canvas.height/2-I.height/4*he,I.scaleX=he,I.scaleY=he,Gs.push(Ks,Zs,et,st,tt,it,at,nt),Me.height=We.height=2*Ys.height*p+10,(Bs=T.group(Ys,Ls,Me)).x=10,Bs.y=1.1*l.height*p,(Os=T.group(Xs,Fs,We)).x=T.canvas.width-Oe.width+10,Os.y=1.1*zs.height*p,(Rs=T.group(Oe,Re,Bs,Os,Qe,zs,Ke,Ze,ss,d,ts,P,I,b,es)).layer=5,Tt()}(),function(e,s){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1&&9<s)throw new Error(`This level : ${s} is not developped yet.`);ce=de=12}else if(2===e){if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=16}if(Ds=O.level[e-1][s-1],L=s,$=e,n=T.gridSpecial(ce,de,pe,le,Ds,Ce,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),X=[],T.setYo(Y),T.setStepArray(X),r.b=Y.bananasToEat,T.setGameInfo(r),(Fe=T.sprite(T.assets["images/forest24.jpg"])).layer=-1,Fe.pivotX=0,Fe.pivotY=0,Ae=T.sprite(T.assets["images/blocksBorder_12x12.png"]),je=T.sprite(T.assets["images/blocksBorder_14x14.png"]),Ne=T.sprite(T.assets["images/blocksBorder_16x16.png"]),Ae.layer=je.layer=Ne.layer=4,1===$)Ae.visible=!0,je.visible=!1,Ne.visible=!1,n.addChild(Ae);else if(2===$)Ae.visible=!1,je.visible=!0,Ne.visible=!1,n.addChild(je);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);Ae.visible=!1,je.visible=!1,Ne.visible=!0,n.addChild(Ne)}(Be=T.group(Fe,n)).x=420,Be.layer=2,(Ms=T.group(Be,Rs)).x=-T.canvas.width,Ms.y=T.canvas.height,Ms.layer=-1,Tt(),R.setScene(e,g),Et()}(1,1),function(){m=T.sprite(T.assets["images/save_img_1.png"]),v=T.sprite(T.assets["images/save_img_in_1.png"]),us=T.text("temp","30px puzzler","black"),ms=T.text("temp","30px puzzler","black"),vs=T.text("temp","30px puzzler","black"),xs=T.text("temp","30px puzzler","black"),bs=T.text("temp","30px puzzler","black"),ws=T.text("temp","30px puzzler","black"),ys=T.text("temp","30px puzzler","black"),fs=T.text("temp","30px puzzler","black"),Wt(),(ks=T.button([T.assets["images/save_cancel_512_up.png"],T.assets["images/save_cancel_512_over.png"],T.assets["images/save_cancel_512_up.png"]])).x=.25*v.width-.5*ks.width*p,ks.y=v.height-1.2*ks.height*p-32,ks.scaleX=p,ks.scaleY=p,(Ss=T.button([T.assets["images/save_ok_512_up.png"],T.assets["images/save_ok_512_over.png"],T.assets["images/save_ok_512_up.png"]])).x=.75*v.width-.5*Ss.width*p,Ss.y=v.height-1.2*Ss.height*p-32,Ss.scaleX=p,Ss.scaleY=p,Ss.press=()=>{if(F(),Z)localStorage.removeItem(`data${$}${L}_s`),localStorage.setItem(`data${$}${L}_g`,JSON.stringify(r)),localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`data${$}${L}_s`,JSON.stringify(X));else{if(H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),!H)return Xt($,L),void T.slide(u,u.x,T.canvas.height,30);if(Xt($,L),r={...H},a={...q},X=[...G],T.setGameInfo(r),T.setStepArray(X),It(),1===X.length)return void T.slide(u,u.x,T.canvas.height,30);{var s=X;ae&&R.setSound(!1);let e=1;T.setReplayMode(!0),Hs=setInterval(()=>{"u"===s[e].d?Y.move("up",n,Y,E):"d"===s[e].d?Y.move("down",n,Y,E):"r"===s[e].d?Y.move("right",n,Y,E):"l"===s[e].d&&Y.move("left",n,Y,E),++e===s.length&&(clearInterval(Hs),T.setReplayMode(!1),ae)&&R.setSound(!0)},gs)}}T.slide(u,u.x,T.canvas.height,30)},ks.press=()=>{F(),T.slide(u,u.x,T.canvas.height,30)};var e="30px puzzler";os=T.text("Replay > ",e,"black"),h=T.text(" Slow: ",e,"black"),_=T.text(" Fast: ",e,"black"),rs=T.text(" Faster: ",e,"black"),ps=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),ls=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),cs=T.button([T.assets["images/checked_box_512.png"],T.assets["images/checked_box_512.png"]]),ds=T.sprite(T.assets["images/checked_512_up.png"]),ps.press=()=>{F(),ds.x=h.x+h.width,gs=200},ls.press=()=>{F(),ds.x=_.x+_.width,gs=100},cs.press=()=>{F(),ds.x=rs.x+rs.width,gs=50},hs=T.group(os,ds,h,ps,_,ls,rs,cs),(u=T.group(v,ws,ys,fs,hs,Ss,ks)).x=.5*T.canvas.width-.5*v.width,u.y=T.canvas.height,u.layer=50,(is=T.button([T.assets["images/save_cancel_512_up.png"],T.assets["images/save_cancel_512_over.png"],T.assets["images/save_cancel_512_up.png"]])).x=.5*m.width-.5*is.width*p,is.y=m.height-1.2*is.height*p-32,is.scaleX=p,is.scaleY=p,is.press=()=>{F(),T.slide(_s,_s.x,-T.canvas.height,30)},(as=T.button([T.assets["images/save_512_in_up.png"],T.assets["images/save_512_in_over.png"],T.assets["images/save_512_in_up.png"]])).press=()=>{F();let e,s,t;K=!1,Z=!0,T.slide(u,u.x,.5*T.canvas.height-.5*v.height,30),T.slide(_s,_s.x,-T.canvas.height,30),hs.visible=!1,t=U?(e="Already saved",s="Want to save anyway !","The last saved game will be lost."):(e="Save !",s="First time saved.","Only one saved game at a time."),At(e,s,t)},as.x=.25*m.width-.5*as.width*p,as.y=m.height-1.2*as.height*p-32,as.scaleX=p,as.scaleY=p,(ns=T.button([T.assets["images/save_512_out_up.png"],T.assets["images/save_512_out_over.png"],T.assets["images/save_512_out_up.png"]])).x=.75*m.width-.5*ns.width*p,ns.y=m.height-1.2*ns.height*p-32,ns.scaleX=p,ns.scaleY=p,ns.press=()=>{F();let e,s,t;K=!0,Z=!1,T.slide(u,u.x,.5*T.canvas.height-.5*v.height,30),T.slide(_s,_s.x,-T.canvas.height,30),U?(e="Load the game !",s="Present data will be lost.",t="Load anyway !",hs.visible=!0):(e="Can't open this game !",s="Not saved yet.",t="Only saved game can be opened.",hs.visible=!1),At(e,s,t)},(_s=T.group(m,us,ms,vs,xs,bs,as,is,ns)).x=.5*T.canvas.width-.5*m.width,_s.y=-T.canvas.height}(),Ft(),ht.press=_t.press=wt.press=kt.press=()=>{Y.move("right",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},ct.press=dt.press=vt.press=yt.press=()=>{Y.move("up",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},pt.press=lt.press=xt.press=ft.press=()=>{Y.move("left",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},ut.press=mt.press=bt.press=St.press=()=>{Y.move("down",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},Us=[ct,dt,vt,yt,ut,mt,bt,St,ht,_t,xt,ft,pt,lt,wt,kt,Ks,Zs,et,st,tt,it,at,nt],T.setButtonsMove(Us,d,ne)},["images/walk_512.json","images/info_level_box.png","images/view_420x1080_10.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/b_login.png","images/infogame_1024x511_1.png","images/infogame_1024x511_border_1.png","images/yo_level_512.png","images/save_img_1.png","images/save_img_in_1.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/next_512_up.png","images/next_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/b_music_512_up.png","images/b_music_512_over.png","images/b_music_512_on_up.png","images/b_music_512_on_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png","images/border_200x400.png","images/box_msg_border_960xx540_convert.png","images/box_msg_back_960xx540_10.png","images/box_msg_ok_512_up.png","images/box_msg_ok_512_over.png","sounds/tamtam.mp3","sounds/eatbananas.wav","sounds/hit_wall.wav","sounds/push.mp3"],function(){0===T.progressBar.counter&&(T.progressBar.setBackgroundColor("#FFA80F"),T.progressBar.setForegroundColor("#FFEC4B"),T.progressBar.create(T.canvas,T.assets,T.canvas.width/2,100));T.progressBar.update()})),pt=(A.appendChild(T.canvas),window.loginHide=(e,s,t)=>{F(),D.classList.remove("show"),D.classList.add("hide"),A.focus(),"yotesteur"===s&&"Yo&Testeur"===t?(J=!0,jt("Good username","Good password","Let's go!")):(jt("Something goes wrong","Check username and password","Retry!"),J=!1)},window.infoHide=e=>{F(),j.classList.remove("show"),j.classList.add("hide"),A.focus()},window.about=e=>{F(),N.src="./html_page/about.html"},window.general=e=>{F(),N.src="./html_page/general.html"},window.buttonsExplained=e=>{F(),N.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{F(),N.src="./html_page/sparebutton.html"},T.keyboard(37)),lt=T.keyboard(100),ct=T.keyboard(38),dt=T.keyboard(104),ht=T.keyboard(39),_t=T.keyboard(102),ut=T.keyboard(40),mt=T.keyboard(98),vt=T.keyboard(87),xt=T.keyboard(65),bt=T.keyboard(83),wt=T.keyboard(68),yt=T.keyboard(73),ft=T.keyboard(74),St=T.keyboard(75),kt=T.keyboard(76);function zt(){0===Y.bananasToEat&&(T.pause(),T.endGame(),T.wait(1e3).then(()=>Yt()))}function Yt(){Mt("end"),ne.value=!1,ss.visible&&ss.press(),ne.value=!0,b.visible=!0,c.interactive=!0,o.interactive=!0}function Et(){F(),b.visible&&(b.visible=!1,c.interactive=!1,o.interactive=!1,Gs.forEach(e=>e.interactive=!0)),setTimeout(()=>{l.visible?(l.visible=!1,l.interactive=!1,e.visible=!0,e.interactive=!0,T.fadeIn(e,30),T.fadeOut(l,30),te.classList.remove("hide"),te.classList.add("show")):(l.visible=!0,l.interactive=!0,e.visible=!1,e.interactive=!1,T.fadeIn(l,30),T.fadeOut(e,30),te.classList.remove("show"),te.classList.add("hide"))},200)}function Xt(e,s){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1||9<s)throw new Error(`This level : ${s} is not developped yet.`);ce=de=12}else if(2===e){if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=16}if(Ds=O.level[e-1][s-1],L=s,$=e,1<s&&3===e&&!J)jt("You are not allowed","to continue.","Not a tester."),--L;else{if(1e3<r.t&&(a.t=Object.values(r)[0],a.s=Object.values(r)[1],a.b=Object.values(r)[2]),Be.remove(n),Y.bananasToEat=0,n=T.gridSpecial(ce,de,pe,le,Ds,Ce,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),(X=[]).push({x:Y.activeSprite.gridX,y:Y.activeSprite.gridY,d:"s"}),T.setYo(Y),T.setStepArray(X),Mt("resetAll"),r.t=0,r.s=0,r.b=Y.bananasToEat,Ot(),T.setGameInfo(r),It(),1===$)Ae.visible=!0,je.visible=!1,Ne.visible=!1,n.addChild(Ae);else if(2===$)Ae.visible=!1,je.visible=!0,Ne.visible=!1,n.addChild(je);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);Ae.visible=!1,je.visible=!1,Ne.visible=!0,n.addChild(Ne)}Be.addChild(n),R.setScene(e,g),Je.content=" "+(X.length-1),He.content=" "+Y.bananasToEat}}function $t(){0<T.soundsArrayGlobal.length&&(T.soundsArrayGlobal.length=0),(me=T.assets["sounds/eatbananas.wav"]).volume=2,(ve=T.assets["sounds/hit_wall.wav"]).loop=!1,ve.volume=1,(xe=T.assets["sounds/push.mp3"]).loop=!1,xe.volume=1,setTimeout(()=>{R.setSoundEffect(me,ve,xe)},2e3),(ue=T.assets["sounds/tamtam.mp3"]).loop=!0,ue.volume=.5;["eat_bananas_sound","button_sound","move_block_sound","elephan_sound","wall_sound","tiger_sound"].forEach(e=>{T.addSoundsArray(W[e])})}function Lt(e,s){$=e,L=s,i.content=Ts[$-1],t.content="Level "+L}function Pt(){qe.layer=100,Ge.layer=100,Ue.layer=100,qe.content=`is_M=${ot} & is_T=${rt} | DPI=${gt} `,Ge.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,Ge.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,Ge.content+=` | VW=${visualViewport.width},VH=`+visualViewport.height,Ue.content=`S_C=${g.scaleCanvas.toFixed(2)} & S_X= ${g.scaleX.toFixed(2)} & S_Y= `+g.scaleY.toFixed(2)}function It(){Je.content=" "+(X.length-1),Ve.content=r.t<=0?" : .....":Rt(r.t),He.content=" "+r.b,Is.content=Ts[$-1],Cs.content="     "+L}function Tt(){var e=qs*he;Ks.points=[{x:P.gx+.406*e,y:P.gy+.406*e},{x:P.gx+0*e,y:P.gy+0*e},{x:P.gx+e,y:P.gy+0*e},{x:P.gx+.6*e,y:P.gy+.406*e}],Zs.points=[{x:P.gx+.406*e,y:P.gy+.6*e},{x:P.gx+.6*e,y:P.gy+.6*e},{x:P.gx+e,y:P.gy+e},{x:P.gx+0*e,y:P.gy+e}],et.points=[{x:P.gx+.6*e,y:P.gy+.406*e},{x:P.gx+e,y:P.gy+0*e},{x:P.gx+e,y:P.gy+e},{x:P.gx+.6*e,y:P.gy+.6*e}],st.points=[{x:P.gx+.406*e,y:P.gy+.406*e},{x:P.gx+.406*e,y:P.gy+.6*e},{x:P.gx+0*e,y:P.gy+e},{x:P.gx+0*e,y:P.gy+0*e}],tt.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+0*e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+.6*e,y:I.gy+.406*e}],it.points=[{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+.6*e,y:I.gy+.6*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+e}],at.points=[{x:I.gx+.6*e,y:I.gy+.406*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+.6*e,y:I.gy+.6*e}],nt.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+0*e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+0*e}]}function Ct(){var e=document.querySelector(":root");V.width=T.canvas.width*g.scaleCanvas,e.style.setProperty("--wait-width",V.width+"px"),e.style.setProperty("--wait-left",T.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",T.canvas.offsetTop+"px")}function Ft(){var e=document.querySelector(":root"),s=(getComputedStyle(e),Math.floor(l.width*p*g.scaleCanvas)),t=Math.floor(l.width*p*g.scaleCanvas),i=(T.canvas.offsetTop,10*g.scaleCanvas);let a=10;var n=T.canvas.offsetTop+l.y*g.scaleY,o=T.canvas.offsetLeft+(l.width*p+10)*g.scaleX;ot&&(a=5),e.style.setProperty("--btn-width",s+"px"),e.style.setProperty("--btn-height",t+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",i+"px"),e.style.setProperty("--border-iframe",a+"px")}function Bt(){var e=T.canvas.offsetTop+l.height*p*g.scaleCanvas+10,s=.95*(window.innerHeight-e),t=.8*window.innerWidth,i=document.getElementById("infoframe").contentWindow.document.querySelector(":root"),i=(ot&&(i.style.setProperty("--font-p","15px"),i.style.setProperty("--margin-p-v","5px"),i.style.setProperty("--margin-p-h","10px"),i.style.setProperty("--font-header","15px"),i.style.setProperty("--font-footer","15px"),i.style.setProperty("--font-buttons","12px"),i.style.setProperty("--btn-width","80px"),i.style.setProperty("--bnt-height","25px"),i.style.setProperty("--img-w","64px"),i.style.setProperty("--img-h","64px"),i.style.setProperty("--margin-flex","5%"),i.style.setProperty("--margin-line","5px")),.1*window.innerWidth);j.style.top=e+"px",j.style.width=t+"px",j.style.height=s+"px",j.style.margin=`0  ${i}px`}function Ot(){H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=q?{...q}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1}}function Rt(e){var e=(e/1e3).toFixed(1),s=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),t=Math.floor(e/60);let i="0",a=9<t?"":"0";return 9<e%60&&(i=""),t<=0?""+i+e%60+"."+s:""+a+t+`:${i}${e%60}.`+s}function Mt(e){let s={};function t(a,n){var e="40px puzzler";let s=void 0,t=void 0,i=void 0;if(0===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*C(e,"?").width):(s=+(n.first/1e3).toFixed(1),x[a][0].content=Rt(n.first),x[a][0].x=272-.5*C(e,Rt(n.first)).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*C(e,"?").width):(t=+(n.second/1e3).toFixed(1),x[a][1].content=Rt(n.second),x[a][1].x=480-.5*C(e,Rt(n.second)).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*C(e,"?").width):(i=+(n.third/1e3).toFixed(1),x[a][2].content=Rt(n.third),x[a][2].x=672-.5*C(e,Rt(n.third)).width);else if(1===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*C(e,"?").width):(s=n.first,x[a][0].content=n.first.toString(),x[a][0].x=272-.5*C(e,n.first.toString()).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*C(e,"?").width):(t=n.second,x[a][1].content=n.second.toString(),x[a][1].x=480-.5*C(e,n.second.toString()).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*C(e,"?").width):(i=n.third,x[a][2].content=n.third.toString(),x[a][2].x=672-.5*C(e,n.third.toString()).width);else if(2===a){let e=void 0,s=void 0,t=void 0,i=void 0;n.first<0?(x[a][0].content="?",x[a][0].x=405,x[a][1].content="?"):(e=n.first,x[a][0].content=n.first.toString(),x[a][0].x=415-10*n.first.toString().length),n.second<0?(x[a][2].content="?",x[a][2].x=854):(s=n.second,x[a][2].content=n.second.toString(),x[a][2].x=864-10*n.second.toString().length),void 0!==e&&void 0!==s&&(n.first===n.second?x[a][1].content="=":n.first<n.second?x[a][1].content="<":x[a][1].content=">"),n.third<0?(x[a][4].content="?",x[a][4].x=1290,x[a][3].content="?",x[a][5].content="?"):(t=n.third,x[a][4].content=n.third.toString(),x[a][4].x=1300-10*n.third.toString().length),void 0!==s&&void 0!==t&&(n.second===n.third?x[a][3].content="=":n.second<n.third?x[a][3].content="<":x[a][3].content=">"),n.fourth<0?(x[a][6].content="?",x[a][6].x=1706,x[a][5].content="?"):(i=n.fourth,x[a][6].content=n.fourth.toString(),x[a][6].x=1716-10*n.fourth.toString().length),void 0!==t&&void 0!==i&&(n.third===n.fourth?x[a][5].content="=":n.third<n.fourth?x[a][5].content="<":x[a][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,g.quota=(e/1024/1024).toFixed(1))}();function i(){s.first=r.t,s.second=a.bt,s.third=_e[$-1][L-1].csec,t(0,s),s.first=r.s,s.second=a.bs,s.third=_e[$-1][L-1].s,t(1,s)}"restart"===e||"infoBtn"===e?i():"end"===e&&(a.bt=Math.min(a.bt<=0?1/0:a.bt,r.t),a.bs=Math.min(a.bs<=0?1/0:a.bs,r.s),a.bb=Math.min(a.bb<=0?1/0:a.bb,r.b),a.t=r.t,a.s=r.s,a.b=r.b,localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`ended_${$}_`+L,"1"),i())}function C(e,s){return T.canvas.ctx.font=e,{width:T.canvas.ctx.measureText(s).width,height:T.canvas.ctx.measureText("M").width}}function Wt(e,s,t,i,a){let n="40px puzzler",o="60px puzzler";ot&&(n="40px puzzler",o="50px puzzler"),K=Z=!1,H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=H?(U=!0,Q=!0,e="Open the game !",s=Ts[$-1]+" Level:"+L,t="Time : "+Rt(H.t),i="Steps : "+H.s,"Bananas : "+H.b):(U=!1,Q=!1,e="Save the game !",s=Ts[$-1]+" Level:"+L,t="Time : "+Rt(r.t),i="Steps : "+r.s,"Bananas : "+r.b),us.font=o,us.content=e,us.width=C(o,e).width,us.height=C(o,e).height,us.x=.5*m.width-.5*us.width,us.y=32,ms.font=o,ms.content=s,ms.width=C(o,s).width,ms.height=C(o,s).height,ms.x=.5*m.width-.5*ms.width,ms.y=us.y+us.height+10,vs.content=t,vs.font=n,vs.width=C(n,t).width,vs.height=C(n,t).height,vs.x=.5*m.width-.5*vs.width,vs.y=ms.y+ms.height+20,xs.content=i,xs.font=n,xs.width=C(n,i).width,xs.height=C(n,i).height,xs.x=.5*m.width-.5*xs.width,xs.y=vs.y+vs.height+10,bs.content=a,bs.font=n,bs.width=C(n,a).width,bs.height=C(n,a).height,bs.x=.5*m.width-.5*bs.width,bs.y=xs.y+xs.height+10}function At(e,s,t){let i="40px puzzler",a="60px puzzler";var n="30px puzzler",e=(ot&&(i="40px puzzler",a="50px puzzler"),ws.font=a,ws.content=e,ws.width=C(a,e).width,ws.height=C(a,e).height,ws.x=.5*v.width-.5*ws.width,ws.y=32,ys.font=a,ys.content=s,ys.width=C(a,s).width,ys.height=C(a,s).height,ys.x=.5*v.width-.5*ys.width,ys.y=ws.y+ws.height+10,fs.content=t,fs.font=i,fs.width=C(i,t).width,fs.height=C(i,t).height,fs.x=.5*v.width-.5*fs.width,fs.y=ys.y+ys.height+20,os.font=n,os.width=C(n,"Replay > ").width,os.height=C(n,"Replay > ").height,h.font=n,h.width=C(n," Slow: ").width,h.height=C(n," Slow: ").height,_.font=n,_.width=C(n," Fast: ").width,_.height=C(n," Fast: ").height,rs.font=n,rs.width=C(n," Faster: ").width,rs.height=C(n," Faster: ").height,ps.scaleX=ps.scaleY=.5*p,ls.scaleX=ls.scaleY=.5*p,cs.scaleX=cs.scaleY=.5*p,ds.scaleX=ds.scaleY=.5*p,h.x=os.width,ps.x=h.x+h.width,_.x=h.x+h.width+ps.width*p*.5,ls.x=_.x+_.width,0===ds.x&&(ds.x=ls.x),rs.x=_.x+_.width+ls.width*p*.5,cs.x=rs.x+rs.width,os.y=h.y=_.y=rs.y=ps.height*p*.5*.5-.5*os.height,hs.y=fs.y+fs.height+20,os.width+h.width+_.width+rs.width+3*ls.width*p*.5);hs.x=.5*v.width-.5*e}function jt(e="Message 1",s="Message 2",t="Message 3"){var i="60px puzzler",e=(z.visible=!1,Ns.visible=!0,f.content=e,f.font=i,f.width=C(i,e).width,f.height=C(i,e).height,f.x=.5*w.width-.5*f.width,f.y=100,f.visible=!1,S.content=s,S.font=i,S.width=C(i,s).width,S.height=C(i,s).height,S.x=.5*w.width-.5*S.width,S.y=f.y+f.height+30,S.visible=!1,k.content=t,k.font=i,k.width=C(i,t).width,k.height=C(i,t).height,k.x=.5*w.width-.5*k.width,k.y=S.y+S.height+30,k.visible=!1,y.width=w.width,y.x=w.x,y.height=w.height,y.y=w.y,T.tweenProperty(y,"width",y.width,y.width-192,60));T.tweenProperty(y,"height",y.height,y.height-192,60),T.tweenProperty(y,"x",y.x,y.x+96,60),T.tweenProperty(y,"y",y.y,y.y+96,60),e.onComplete=()=>{z.visible=!0,z.interactive=!0,f.visible=!0,S.visible=!0,k.visible=!0}}function F(){ae&&ne.value&&M.playSoundsArray(W.button_sound)}T.start(),T.scaleToWindow(g),Ct(),window.addEventListener("resize",e=>{T.scaleToWindow(g),Pt(),Ft(),Bt(),Ct()}),document.addEventListener("fullscreenchange",e=>{T.scaleToWindow(g),Pt(),(ze=!ze)?s.src=T.assets["images/fullscreen_off_512_over.png"].src:s.src=T.assets["images/fullscreen_on_512_over.png"].src});