import{game as B}from"./engine.js";import*as O from"./level.js";import*as R from"./move.js";import*as A from"./sounds.js";import*as M from"./gamesounds.js";import"./typedef.js";let W=document.getElementById("main"),j=document.getElementById("infodiv"),N=document.getElementById("infoframe"),D=document.getElementById("logindiv");document.getElementById("loginframe");let J=!1,V=document.getElementById("wait-video"),g={scaleCanvas:1,scaleX:1,scaleY:2,boxSize:90,boxViewQuantity:12,scaleFactor:()=>g.boxSize/512,quota:void 0};let r={t:0,s:0,b:-1},a={t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1},H=void 0,q=void 0,G=void 0,U=!1,Q=!1,K=!1,Z=!1,s=document.getElementById("btn-1"),ee=document.getElementById("btn-2"),se=document.getElementById("btn-3"),te=document.getElementsByClassName("floating-menu")[0],ie,ae=!1,ne={value:!0},oe=!1,ge=1920,re=1080,pe=90,le=90,ce=12,de=12,p=.2,he=.75,_e=[[{s:70,t:15.23,csec:15234},{s:106,t:159.3,csec:15930},{s:144,t:421.19,csec:42119},{s:116,t:385.03,csec:38503},{s:114,t:410.32,csec:41032},{s:163,t:1042.31,csec:104231},{s:142,t:646.3,csec:64630},{s:233,t:1017.17,csec:101717},{s:188,t:771.34,csec:77134}],[{s:176,t:673.17,csec:67317},{s:267,t:2518.64,csec:251864},{s:209,t:1838.83,csec:183883},{s:365,t:4185.79,csec:418579},{s:65,t:18.02,csec:15930},{s:272,t:2850.8,csec:285080},{s:65,t:18.02,csec:15930},{s:305,t:5113.09,csec:511309},{s:335,t:3441.87,csec:344187}],[{s:334,t:810.34,csec:81034},{s:65,t:18.02,csec:15930},{s:471,t:1417.01,csec:141701},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930},{s:65,t:18.02,csec:15930}]];let ue,me,ve,xe,we,be,ye,fe,Se,ke,ze,l,e,Ye,Ee,t,Xe,$e,Le,Pe,i,Ie,Ce,Te,n,Fe,Be,Oe,Re,Ae,Me,We,je,Ne,De,Je,Ve,He,qe,Ge,Ue,Qe,Ke,Ze,o,es,c,ss,ts,d,is,as,ns,os,gs,rs=100,h,_,ps,ls,cs,ds,hs,_s,us,u,m,v,ms,vs,xs,ws,bs,ys,fs,Ss,ks,zs,Ys,Es,Xs,$s,Ls,Ps,Is,Cs,Ts=["12x12","14x14","16x16"],Fs,Bs,Os,Rs,As,Ms,Ws,js,x,Ns,w,Ds,b,y,f,S,k,z,Y={},E=[],X=[],$=1,L=1,Js=O.level[$-1][L-1],Vs=1,Hs=1,qs=setInterval(()=>C.progressBar.update(),5),Gs=(document.addEventListener("myProper",e=>console.log("From my proper ",e.text)),512),Us=[],Qs,Ks=[],P,Zs,et,st,tt,I,it,at,nt,ot,gt=/Mobile/i.test(navigator.userAgent),rt=window.devicePixelRatio.toFixed(2),pt=!1,C=(("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints||"ontouchstart"in document.documentElement||"touchstart"in document.documentElement)&&(pt=!0,document.body.classList.add("is-touch")),gt&&(Hs=3.5<=rt&&rt<=4.2?Vs=1.2:2.8<=rt&&rt<3.5?(Vs=1.5,1.2):(Vs=1.6,1.5)),new B(ge,re,function(){document.body.removeChild(V),C.progressBar.remove(),clearInterval(qs),s.src=C.assets["images/fullscreen_on_512_up.png"].src,s.style.width="64px",ee.src=C.assets["images/sound_no_240_up.png"].src,ee.style.width="64px",se.src=C.assets["images/b_music_512_up.png"].src,se.style.width="64px",s.onpointerdown=e=>(F(),Ye=document.fullscreenElement?(document.exitFullscreen(),s.src=C.assets["images/fullscreen_on_512_up.png"].src,!1):(W.requestFullscreen().catch(e=>console.log(e)),s.src=C.assets["images/fullscreen_off_512_up.png"].src,!0),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),s.addEventListener("mouseover",()=>{Ye?s.src=C.assets["images/fullscreen_off_512_over.png"].src:s.src=C.assets["images/fullscreen_on_512_over.png"].src}),s.addEventListener("mouseleave",()=>{Ye?s.src=C.assets["images/fullscreen_off_512_up.png"].src:s.src=C.assets["images/fullscreen_on_512_up.png"].src}),ee.onpointerdown=e=>(ie?"suspended"===C.actx.state&&C.actx.resume():(ie=new(window.AudioContext||window.webkitAudioContext),C.setActx(ie),C.actx.resume()),(ae=!ae)?("suspended"===C.actx.state&&C.actx.resume(),Lt(),ee.src=C.assets["images/sound_yes_240_up.png"].src,F(),R.setSoundEffect(me)):(ee.src=C.assets["images/sound_no_240_up.png"].src,F()),R.setSound(ae),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),ee.addEventListener("mouseover",()=>{ae?ee.src=C.assets["images/sound_yes_240_over.png"].src:ee.src=C.assets["images/sound_no_240_over.png"].src}),ee.addEventListener("mouseleave",()=>{ae?ee.src=C.assets["images/sound_yes_240_up.png"].src:ee.src=C.assets["images/sound_no_240_up.png"].src}),se.onpointerdown=e=>(ie?"suspended"===C.actx.state&&C.actx.resume():(ie=new(window.AudioContext||window.webkitAudioContext),C.setActx(ie),C.actx.resume()),(oe=!oe)?("suspended"===C.actx.state&&C.actx.resume(),Lt(),ue.play(),se.src=C.assets["images/b_music_512_on_up.png"].src,F()):(se.src=C.assets["images/b_music_512_up.png"].src,F(),ue.pause()),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),e.stopPropagation(),e.target.releasePointerCapture(e.pointerId),!1),se.addEventListener("mouseover",()=>{oe?se.src=C.assets["images/b_music_512_on_over.png"].src:se.src=C.assets["images/b_music_512_over.png"].src}),se.addEventListener("mouseleave",()=>{oe?se.src=C.assets["images/b_music_512_on_up.png"].src:se.src=C.assets["images/b_music_512_up.png"].src}),Fe=[C.assets["walkDownRight.png"],C.assets["images/road_512.png"],C.assets["images/forest_512.png"],C.assets["images/box_512.png"],C.assets["images/bananas_0_512.png"],C.assets["walkUpRight.png"],C.assets["walkUpLeft.png"],C.assets["walkUpRightPush.png"],C.assets["walkUpLeftPush.png"],C.assets["walkDownRight.png"],C.assets["walkDownLeft.png"],C.assets["walkDownRightPush.png"],C.assets["walkDownLeftPush.png"],C.assets["walkRightRight.png"],C.assets["walkRightLeft.png"],C.assets["walkRightRightPush.png"],C.assets["walkRightLeftPush.png"],C.assets["walkLeftRight.png"],C.assets["walkLeftLeft.png"],C.assets["walkLeftRightPush.png"],C.assets["walkLeftLeftPush.png"]],Y.setVisible=()=>{E.forEach(e=>{e===Y.activeSprite?e.visible=!0:(e.visible=!1,e.gridX=-10,e.gridY=-10)})},Y.layer=3,Y.bananasToEat=0,Y.move=R.moveScene,function(){(function(){b=C.sprite(C.assets["images/box_msg_border_960xx540_convert.png"]),(y=C.sprite(C.assets["images/box_msg_back_960xx540_10.png"])).pivotX=.5*y.width,y.pivotY=.5*y.height;var e="60px puzzler";(z=C.button([C.assets["images/box_msg_ok_512_up.png"],C.assets["images/box_msg_ok_512_over.png"],C.assets["images/box_msg_ok_512_up.png"]])).scaleX=z.scaleY=p,z.x=.5*b.width-.5*z.width*p,z.y=b.height-z.height*p-96,z.interactive=!1,z.press=()=>{F(),Ds.visible=!1,z.interactive=!1},(f=C.text("msg_1",e,"black")).width=T(e," msg_1: ").width,f.height=T(e," msg_1: ").height,f.x=.5*b.width-.5*f.width,f.y=100,(S=C.text("msg_2",e,"black")).width=T(e," msg_2: ").width,S.height=T(e," msg_2: ").height,S.x=.5*b.width-.5*S.width,S.y=f.y+f.height+30,(k=C.text("msg_3",e,"black")).width=T(e," msg_3: ").width,k.height=T(e," msg_3: ").height,k.x=.5*b.width-.5*k.width,k.y=S.y+S.height+30,(Ds=C.group(b,y,f,S,k,z)).x=.5*C.canvas.width-.5*b.width,Ds.y=.5*C.canvas.height-.5*b.height,Ds.layer=100,Ds.visible=!1})(),(Ge=C.text("First","40px puzzler","deepskyblue")).y=C.canvas.height-135,(Ue=C.text("First","40px puzzler","deepskyblue")).y=C.canvas.height-90,(Qe=C.text("First","40px puzzler","deepskyblue")).y=C.canvas.height-45;(ye=C.sprite(C.assets["images/fond_ecran_950.jpg"])).x=(C.canvas.width-ye.width)/2,ye.y=(C.canvas.height-ye.height)/2,$=$||1;L=L||1;(e=C.button([C.assets["images/menu_open_512_up.png"],C.assets["images/menu_open_512_over.png"],C.assets["images/menu_open_512_up.png"]])).x=10,e.y=10,e.pivotX=0,e.pivotY=0,e.scaleX=p,e.scaleY=p,e.layer=20,e.visible=!1,e.interactive=!1,e.press=()=>Xt(),(l=C.button([C.assets["images/menu_512_up.png"],C.assets["images/menu_512_over.png"],C.assets["images/menu_512_up.png"]])).x=10,l.y=10,l.pivotX=0,l.pivotY=0,l.scaleX=p,l.scaleY=p,l.layer=20,l.press=()=>Xt(),(Pe=C.sprite(C.assets["images/info_level_box.png"])).width=300,(i=C.text("12x12","50px puzzler","black",20,40)).content=Ts[$-1],i.x=Pe.width/4,i.y=Pe.height/2-25,(Ie=C.button([C.assets["images/b_scene_top_up.png"],C.assets["images/b_scene_top_over.png"],C.assets["images/b_scene_top_up.png"]])).x=Pe.width/2-Ie.width/2,Ie.y=Pe.height/4-Ie.height/2,Ie.press=()=>{F(),$<3&&($+=1,L=1,Pt($,L),$t($,L),C.slide(i,i.x,i.y-40,10,["smoothstep"]),C.fadeOut(i,10),setTimeout(()=>{i.content=Ts[$-1],i.y+=80,C.slide(i,i.x,Pe.height/2-25,15,["smoothstep"]),C.fadeIn(i,15)},100))},(Ce=C.button([C.assets["images/b_scene_up.png"],C.assets["images/b_scene_over.png"],C.assets["images/b_scene_up.png"]])).x=Pe.width/2-Ce.width/2,Ce.y=3*Pe.height/4-Ie.height/2,Ce.press=()=>{F(),1<$&&(--$,L=1,Pt($,L),$t($,L),C.slide(i,i.x,i.y+40,10,["smoothstep"]),C.fadeOut(i,10),setTimeout(()=>{i.content=Ts[$-1],i.y-=80,C.slide(i,i.x,Pe.height/2-25,15,["smoothstep"]),C.fadeIn(i,15)},200))},(Te=C.group(Pe,i,Ie,Ce)).x=-C.canvas.width,Te.y=-C.canvas.height,Ee=C.sprite(C.assets["images/info_level_box.png"]),(t=C.text("Level "+L,"50px puzzler","black",20,40)).x=Pe.width/4,t.y=Pe.height/2-25,(Xe=C.button([C.assets["images/b_scene_top_up.png"],C.assets["images/b_scene_top_over.png"],C.assets["images/b_scene_top_up.png"]])).press=()=>{F(),L<9&&(L+=1,$t($,L),C.slide(t,t.x,t.y-40,10,["smoothstep"]),C.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y+=80,C.slide(t,t.x,Ee.height/2-25,15,["smoothstep"]),C.fadeIn(t,15)},100))},Xe.x=Ee.width/2-Xe.width/2,Xe.y=Ee.height/4-Xe.height/2,($e=C.button([C.assets["images/b_scene_up.png"],C.assets["images/b_scene_over.png"],C.assets["images/b_scene_up.png"]])).x=Ee.width/2-$e.width/2,$e.y=3*Ee.height/4-Xe.height/2,$e.press=()=>{F(),1<L&&(--L,$t($,L),C.slide(t,t.x,t.y+40,10,["smoothstep"]),C.fadeOut(t,10),setTimeout(()=>{t.content="Level "+L,t.y-=80,C.slide(t,t.x,Ee.height/2-25,15,["smoothstep"]),C.fadeIn(t,15)},100))},t.y=Ee.height/2-25,(Le=C.group(Ee,t,Xe,$e)).x=C.canvas.width,Le.y=-C.canvas.height,(ze=C.button([C.assets["images/b_info_up.png"],C.assets["images/b_info_over.png"],C.assets["images/b_info_up.png"]])).x=(C.canvas.width-ye.width)/4-.5*ze.width*Vs/2,ze.y=re-ze.width,ze.scaleX=.5*Vs,ze.scaleY=.5*Vs,ze.press=()=>{F(),ne.value=!1,window.about(),ne.value=!0,Ot();let e=C.rectangle(10,10,"#F7E9B8");e.pivotX=0,e.pivotY=0,e.x=ze.x+ze.width/2,e.y=ze.y+ze.height/2;var s=C.slide(e,e.x,100,30);C.tweenProperty(e,"scaleX",e.scaleX,180,30),C.tweenProperty(e,"scaleY",e.scaleY,80,30);s.onComplete=()=>{j.classList.remove("hide"),j.classList.add("show"),C.remove(e)}},(Se=C.button([C.assets["images/b_reset.png"],C.assets["images/b_reset.png"],C.assets["images/b_reset.png"]])).x=C.canvas.width-Se.width*Vs,Se.y=0,Se.scaleX=Vs,Se.scaleY=Vs,Se.press=()=>{F();for(let s=1;s<4;s++)for(let e=1;e<10;e++)localStorage.removeItem(`data${s}${e}_g`),localStorage.removeItem(`data${s}${e}_gl`),localStorage.removeItem(`data${s}${e}_s`),localStorage.removeItem("data"+s+e)},(ke=C.button([C.assets["images/b_login.png"],C.assets["images/b_login.png"],C.assets["images/b_login.png"]])).x=Se.x,ke.y=C.canvas.height-ke.height,ke.scaleX=Vs,ke.scaleY=Vs,ke.press=()=>{F(),D.classList.contains("hide")?(D.classList.remove("hide"),D.classList.add("show")):(D.classList.remove("show"),D.classList.add("hide"))},(fe=C.button([C.assets["images/b_play_up.png"],C.assets["images/b_play_over.png"],C.assets["images/b_play_up.png"]])).x=ge,fe.y=re,fe.scaleX=Vs,fe.scaleY=Vs,fe.press=()=>{F(),te.classList.contains("show")&&(te.classList.remove("show"),te.classList.add("hide"),Xt()),Ge.visible=!1,Ue.visible=!1,Qe.visible=!1,C.slide(be,C.canvas.width,C.canvas.height,30,["decelerationCubed"]),C.slide(Ms,0,0,30,["decelerationCubed"]).onComplete=()=>{Tt()},$=$||1,L=L||1,i.content=Ts[$-1],t.content="Level "+L,$t($,L),Pt($,L),Rt(),C.state=Yt},C.slide(fe,C.canvas.width-(C.canvas.width-ye.width)/4-fe.width/2,.75*C.canvas.height-fe.width/2,30,["decelerationCubed"]),C.slide(Te,(C.canvas.width-ye.width)/4-Te.width/2,ye.y+Te.height/2,30,["decelerationCubed"]),C.slide(Le,C.canvas.width-(C.canvas.width-ye.width)/4-Le.width/2,ye.y+Le.height/2,30,["decelerationCubed"]),be=C.group(ye,ze,fe,Se,ke,Le,Te,l,e)}(),function(){(function(){(Ws=C.sprite(C.assets["images/infogame_1024x511_1.png"])).height=525,js=C.sprite(C.assets["images/infogame_1024x511_border_1.png"]),Ns=C.group(Ws);var e="40px puzzler";(x=[[C.text("First",e,"black",216,236),C.text("First",e,"black",470,236),C.text("First",e,"black",622,236)],[C.text("First",e,"black",216,396),C.text("First",e,"black",470,396),C.text("First",e,"black",622,396)]]).forEach(e=>{e.forEach(e=>{e.pivotX=e.pivotY=.5})}),x[0][0].content="23.82",x[0][1].content="=",(c=C.button([C.assets["images/restart_512_up.png"],C.assets["images/restart_512_over.png"],C.assets["images/restart_512_up.png"]])).press=()=>{es.press()},c.x=896-c.width*p*.5,c.y=160-c.width*p*.5,c.scaleX=p,c.scaleY=p,c.interactive=!1,Ns.add(c),(o=C.button([C.assets["images/next_512_up.png"],C.assets["images/next_512_over.png"],C.assets["images/next_512_up.png"]])).press=()=>{Ze.press()},o.x=896-o.width*p*.5,o.y=330-o.width*p*.5,o.scaleX=p,o.scaleY=p,o.interactive=!1,Ns.add(o);for(let s=0;s<2;s++)for(let e=0;e<3;e++)Ns.add(x[s][e]);Ns.x=96,Ns.y=90,(w=C.group(js,Ns)).visible=!1})(),w.x=.5*C.canvas.width-.5*js.width,w.y=.5*C.canvas.height-.5*js.height,(Ke=C.button([C.assets["images/home_512_up.png"],C.assets["images/home_512_over.png"],C.assets["images/home_512_up.png"]])).press=()=>{F(),Ge.visible=!0,Ue.visible=!0,Qe.visible=!0,w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0)),$t($,L),Pt($,L),C.slide(Ms,-C.canvas.width,C.canvas.height,30,["decelerationCubed"]).onComplete=()=>{Tt()},C.slide(be,0,0,30,["decelerationCubed"]),C.endGame()},Ke.x=C.canvas.width-1.1*Ke.width*p,Ke.y=10,Ke.scaleX=p,Ke.scaleY=p,(Ys=C.button([C.assets["images/infogame_512_up.png"],C.assets["images/infogame_512_over.png"],C.assets["images/infogame_512_up.png"]])).press=()=>{F(),Mt("infoBtn"),w.visible=!w.visible,w.visible?(o.interactive=!0,c.interactive=!0):(o.interactive=!1,c.interactive=!1)},Ys.x=Ke.x-1.1*Ys.width*p,Ys.y=10,Ys.scaleX=p,Ys.scaleY=p,Ys.visible=!1,Ys.interactive=!1,Ks.push(Ys),(Ze=C.button([C.assets["images/next_512_up.png"],C.assets["images/next_512_over.png"],C.assets["images/next_512_up.png"]])).press=()=>{F(),w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1),localStorage.getItem(`ended_${$}_`+L)?$<=2&&L<=8&&(L+=1,$t($,L),Rt(),C.state=Yt):Nt(`Level ${L} must be completed`,"before playing the next one.","See you soon !")},Ze.x=Ys.x-1.1*Ze.width*p,Ze.y=10,Ze.scaleX=p,Ze.scaleY=p,Ze.visible=!1,Ze.interactive=!1,Ks.push(Ze),(ts=C.button([C.assets["images/pause_512_up.png"],C.assets["images/pause_512_over.png"],C.assets["images/pause_512_up.png"]])).press=()=>{w.visible&&(w.visible=!1,Us.forEach(e=>e.interactive=!0)),C.isPlaying&&C.pause(),ts.visible=!1,ts.interactive=!1,d.visible=!0,setTimeout(()=>{d.interactive=!0},200),Ks.forEach((e,s)=>{e.visible=!0,e.interactive=!0}),F()},w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0));ts.x=l.x,ts.y=10,ts.scaleX=p,ts.scaleY=p,(d=C.button([C.assets["images/pause_on_512_up.png"],C.assets["images/pause_on_512_over.png"],C.assets["images/pause_on_512_up.png"]])).press=()=>{w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0)),ts.visible=!0,d.visible=!1,d.interactive=!1,setTimeout(()=>{ts.interactive=!0},200),Ks.forEach((e,s)=>{e.visible=!1,e.interactive=!1}),F()},w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0));d.x=l.x,d.y=10,d.scaleX=p,d.scaleY=p,d.visible=!1,d.interactive=!1,(es=C.button([C.assets["images/restart_512_up.png"],C.assets["images/restart_512_over.png"],C.assets["images/restart_512_up.png"]])).press=()=>{F(),w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0)),$t($,L),C.slide(Ms,0,0,30,["decelerationCubed"]),C.state=Yt},es.x=l.x+1.1*l.width*p,es.y=10,es.scaleX=p,es.scaleY=p,es.visible=!1,es.interactive=!1,Ks.push(es),(is=C.button([C.assets["images/save_512_up.png"],C.assets["images/save_512_over.png"],C.assets["images/save_512_up.png"]])).press=()=>{F(),w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1),Wt(),C.slide(us,.5*C.canvas.width-380,.5*C.canvas.height-256,30)},is.x=es.x+1.1*is.width*p,is.y=10,is.scaleX=p,is.scaleY=p,is.visible=!1,is.interactive=!1,Ks.push(is),(ss=C.button([C.assets["images/b_about_up_128.png"],C.assets["images/b_about_over_128.png"],C.assets["images/b_about_up_128.png"]])).press=()=>async function(){var e={is_M:gt,is_T:pt,DPI:rt,WA:window.screen.availWidth,HA:window.screen.availHeight,WW:window.innerWidth,WH:window.innerHeight,DW:document.body.width,DH:document.body.height,S_C:g.scaleCanvas.toFixed(2),S_X:g.scaleX.toFixed(2),S_Y:g.scaleY.toFixed(2),Q:g.quota},s={scene:$,level:L},t=[],e=(t.push(e,s,r,X),`Yo_${Ts[$-1]}_Level_`+L);s=document.createElement("a"),t=new Blob([JSON.stringify(t)],{type:"text/plain"});s.setAttribute("href",URL.createObjectURL(t)),s.setAttribute("download",e.toLowerCase()+".json"),s.click(),URL.revokeObjectURL(s.href)}(),ss.x=es.x,ss.y=C.canvas.height-ss.height-10,(Me=C.sprite(C.assets["images/border_200x400.png"])).layer=5,(We=C.sprite(C.assets["images/border_200x400.png"])).layer=5,Re=C.sprite(C.assets["images/view_420x1080_10.png"]),Ae=C.sprite(C.assets["images/view_420x1080_10.png"]),Re.width=Ae.width=420,Ae.x=1500,(Je=C.sprite(C.assets["images/step_512_neutral.png"])).x=0,Je.y=10,Je.scaleX=.8*p,Je.scaleY=.8*p,(Ve=C.text(" : "+(X.length-1),"60px puzzler","black")).x=Je.width*p*.8+10,Ve.y=Je.height*p/2-30,Ve.pivotX=0,Ve.pivotY=0,Ve.scaleX=Hs,Ve.scaleY=Hs,C.pushMessage(Ve),(Xs=C.sprite(C.assets["images/time_512_neutral.png"])).x=0,Xs.y=10,Xs.scaleX=.8*p,Xs.scaleY=.8*p,(He=C.text(" : ","60px puzzler","black")).x=Xs.width*p*.8+10,He.y=Xs.height*p/2-30,He.pivotX=0,He.pivotY=0,He.scaleX=Hs,He.scaleY=Hs,C.pushMessage(He),(Ls=C.sprite(C.assets["images/bananas_512_neutral.png"])).x=0,Ls.y=0,Ls.scaleX=.8*p,Ls.scaleY=.8*p,(qe=C.text(" : "+Y.bananasToEat,"60px puzzler","black")).x=Ls.width*p*.8+10,qe.y=Ls.height*p*.8/2-30,qe.pivotX=0,qe.pivotY=0,qe.scaleX=Hs,qe.scaleY=Hs,C.pushMessage(qe),(Is=C.sprite(C.assets["images/yo_level_512.png"])).x=0,Is.y=0,Is.scaleX=.8*p,Is.scaleY=.8*p,(Cs=C.text("","40px puzzler","black")).x=Is.width*p*.8+10,Cs.y=Is.height*p/2-40,Cs.pivotX=0,Cs.pivotY=0,Cs.scaleX=Hs,Cs.scaleY=Hs,(Fs=C.text("","40px puzzler","black")).x=Is.width*p*.8+10,Fs.y=Is.height*p*.8/2+5,Fs.pivotX=0,Fs.pivotY=0,Fs.scaleX=Hs,Fs.scaleY=Hs,Ct(),It(),(Es=C.group(Je,Ve)).x=10,Es.y=0,($s=C.group(Xs,He)).x=10,$s.y=0,(Ps=C.group(Ls,qe)).x=10,Ps.y=Es.height*p*1.1+Es.y,(Bs=C.group(Is,Cs,Fs)).x=10,Bs.y=$s.height*p*1.1+$s.y,(Zs=C.button([C.assets["images/pad_512_up_up.png"],C.assets["images/pad_512_up_over.png"],C.assets["images/pad_512_up_up.png"]],[])).press=()=>{dt.press()},(et=C.button([C.assets["images/pad_512_down_up.png"],C.assets["images/pad_512_down_over.png"],C.assets["images/pad_512_down_up.png"]],[])).press=()=>{mt.press()},(st=C.button([C.assets["images/pad_512_right_up.png"],C.assets["images/pad_512_right_over.png"],C.assets["images/pad_512_right_up.png"]],[])).press=()=>{_t.press()},(tt=C.button([C.assets["images/pad_512_left_up.png"],C.assets["images/pad_512_left_over.png"],C.assets["images/pad_512_left_up.png"]],[])).press=()=>{lt.press()},(P=C.group(Zs,et,st,tt)).x=10,P.y=C.canvas.height/2-P.height/4*he,P.scaleX=P.scaleY=he,(it=C.button([C.assets["images/pad_512_up_up.png"],C.assets["images/pad_512_up_over.png"],C.assets["images/pad_512_up_up.png"]],[])).press=()=>{dt.press()},(at=C.button([C.assets["images/pad_512_down_up.png"],C.assets["images/pad_512_down_over.png"],C.assets["images/pad_512_down_up.png"]],[])).press=()=>{mt.press()},(nt=C.button([C.assets["images/pad_512_right_up.png"],C.assets["images/pad_512_right_over.png"],C.assets["images/pad_512_right_up.png"]],[])).press=()=>{_t.press()},(ot=C.button([C.assets["images/pad_512_left_up.png"],C.assets["images/pad_512_left_over.png"],C.assets["images/pad_512_left_up.png"]],[])).press=()=>{lt.press()},(I=C.group(it,at,nt,ot)).x=C.canvas.width-I.width*he-10,I.y=C.canvas.height/2-I.height/4*he,I.scaleX=he,I.scaleY=he,Us.push(Zs,et,st,tt,it,at,nt,ot),Me.height=We.height=2*Es.height*p+10,(Os=C.group(Es,Ps,Me)).x=10,Os.y=1.1*l.height*p,(Rs=C.group($s,Bs,We)).x=C.canvas.width-Re.width+10,Rs.y=1.1*Ys.height*p,(As=C.group(Re,Ae,Os,Rs,Ke,Ys,Ze,es,ts,d,is,P,I,w,ss)).layer=5,Tt()}(),function(e,s){if(e<1&&3<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1&&9<s)throw new Error(`This level : ${s} is not developped yet.`);ce=de=12}else if(2===e){if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1&&9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=16}if(Js=O.level[e-1][s-1],L=s,$=e,n=C.gridSpecial(ce,de,pe,le,Js,Fe,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),X=[],C.setYo(Y),C.setStepArray(X),r.b=Y.bananasToEat,C.setGameInfo(r),(Be=C.sprite(C.assets["images/forest24.jpg"])).layer=-1,Be.pivotX=0,Be.pivotY=0,je=C.sprite(C.assets["images/blocksBorder_12x12.png"]),Ne=C.sprite(C.assets["images/blocksBorder_14x14.png"]),De=C.sprite(C.assets["images/blocksBorder_16x16.png"]),je.layer=Ne.layer=De.layer=4,1===$)je.visible=!0,Ne.visible=!1,De.visible=!1,n.addChild(je);else if(2===$)je.visible=!1,Ne.visible=!0,De.visible=!1,n.addChild(Ne);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);je.visible=!1,Ne.visible=!1,De.visible=!0,n.addChild(De)}(Oe=C.group(Be,n)).x=420,Oe.layer=2,(Ms=C.group(Oe,As)).x=-C.canvas.width,Ms.y=C.canvas.height,Ms.layer=-1,Tt(),R.setScene(e,g),Xt()}(1,1),function(){m=C.sprite(C.assets["images/save_img_1.png"]),v=C.sprite(C.assets["images/save_img_in_1.png"]),ms=C.text("temp","30px puzzler","black"),vs=C.text("temp","30px puzzler","black"),xs=C.text("temp","30px puzzler","black"),ws=C.text("temp","30px puzzler","black"),bs=C.text("temp","30px puzzler","black"),ys=C.text("temp","30px puzzler","black"),fs=C.text("temp","30px puzzler","black"),Ss=C.text("temp","30px puzzler","black"),Wt(),(zs=C.button([C.assets["images/save_cancel_512_up.png"],C.assets["images/save_cancel_512_over.png"],C.assets["images/save_cancel_512_up.png"]])).x=.25*v.width-.5*zs.width*p,zs.y=v.height-1.2*zs.height*p-32,zs.scaleX=p,zs.scaleY=p,(ks=C.button([C.assets["images/save_ok_512_up.png"],C.assets["images/save_ok_512_over.png"],C.assets["images/save_ok_512_up.png"]])).x=.75*v.width-.5*ks.width*p,ks.y=v.height-1.2*ks.height*p-32,ks.scaleX=p,ks.scaleY=p,ks.press=()=>{if(F(),Z)localStorage.removeItem(`data${$}${L}_s`),localStorage.setItem(`data${$}${L}_g`,JSON.stringify(r)),localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`data${$}${L}_s`,JSON.stringify(X));else{if(H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),!H)return $t($,L),void C.slide(u,u.x,C.canvas.height,30);if($t($,L),r={...H},a={...q},X=[...G],C.setGameInfo(r),C.setStepArray(X),Ct(),1===X.length)return void C.slide(u,u.x,C.canvas.height,30);{var s=X;ae&&R.setSound(!1);let e=1;C.setReplayMode(!0),qs=setInterval(()=>{"u"===s[e].d?Y.move("up",n,Y,E):"d"===s[e].d?Y.move("down",n,Y,E):"r"===s[e].d?Y.move("right",n,Y,E):"l"===s[e].d&&Y.move("left",n,Y,E),++e===s.length&&(clearInterval(qs),C.setReplayMode(!1),ae)&&R.setSound(!0)},rs)}}C.slide(u,u.x,C.canvas.height,30)},zs.press=()=>{F(),C.slide(u,u.x,C.canvas.height,30)};var e="30px puzzler";gs=C.text("Replay > ",e,"black"),h=C.text(" Slow: ",e,"black"),_=C.text(" Fast: ",e,"black"),ps=C.text(" Faster: ",e,"black"),ls=C.button([C.assets["images/checked_box_512.png"],C.assets["images/checked_box_512.png"]]),cs=C.button([C.assets["images/checked_box_512.png"],C.assets["images/checked_box_512.png"]]),ds=C.button([C.assets["images/checked_box_512.png"],C.assets["images/checked_box_512.png"]]),hs=C.sprite(C.assets["images/checked_512_up.png"]),ls.press=()=>{F(),hs.x=h.x+h.width,rs=200},cs.press=()=>{F(),hs.x=_.x+_.width,rs=100},ds.press=()=>{F(),hs.x=ps.x+ps.width,rs=50},_s=C.group(gs,hs,h,ls,_,cs,ps,ds),(u=C.group(v,ys,fs,Ss,_s,ks,zs)).x=.5*C.canvas.width-.5*v.width,u.y=C.canvas.height,u.layer=50,(as=C.button([C.assets["images/save_cancel_512_up.png"],C.assets["images/save_cancel_512_over.png"],C.assets["images/save_cancel_512_up.png"]])).x=.5*m.width-.5*as.width*p,as.y=m.height-1.2*as.height*p-32,as.scaleX=p,as.scaleY=p,as.press=()=>{F(),C.slide(us,us.x,-C.canvas.height,30)},(ns=C.button([C.assets["images/save_512_in_up.png"],C.assets["images/save_512_in_over.png"],C.assets["images/save_512_in_up.png"]])).press=()=>{F();let e,s,t;K=!1,Z=!0,C.slide(u,u.x,.5*C.canvas.height-.5*v.height,30),C.slide(us,us.x,-C.canvas.height,30),_s.visible=!1,t=U?(e="Already saved",s="Want to save anyway !","The last saved game will be lost."):(e="Save !",s="First time saved.","Only one saved game at a time."),jt(e,s,t)},ns.x=.25*m.width-.5*ns.width*p,ns.y=m.height-1.2*ns.height*p-32,ns.scaleX=p,ns.scaleY=p,(os=C.button([C.assets["images/save_512_out_up.png"],C.assets["images/save_512_out_over.png"],C.assets["images/save_512_out_up.png"]])).x=.75*m.width-.5*os.width*p,os.y=m.height-1.2*os.height*p-32,os.scaleX=p,os.scaleY=p,os.press=()=>{F();let e,s,t;K=!0,Z=!1,C.slide(u,u.x,.5*C.canvas.height-.5*v.height,30),C.slide(us,us.x,-C.canvas.height,30),U?(e="Load the game !",s="Present data will be lost.",t="Load anyway !",_s.visible=!0):(e="Can't open this game !",s="Not saved yet.",t="Only saved game can be opened.",_s.visible=!1),jt(e,s,t)},(us=C.group(m,ms,vs,xs,ws,bs,ns,as,os)).x=.5*C.canvas.width-.5*m.width,us.y=-C.canvas.height}(),Bt(),_t.press=ut.press=yt.press=zt.press=()=>{Y.move("right",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"r"})},dt.press=ht.press=xt.press=ft.press=()=>{Y.move("up",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"u"})},lt.press=ct.press=wt.press=St.press=()=>{Y.move("left",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"l"})},mt.press=vt.press=bt.press=kt.press=()=>{Y.move("down",n,Y,E),X.push({x:this.yo.activeSprite.gridX,y:this.yo.activeSprite.gridY,d:"d"})},Qs=[dt,ht,xt,ft,mt,vt,bt,kt,_t,ut,wt,St,lt,ct,yt,zt,Zs,et,st,tt,it,at,nt,ot],C.setButtonsMove(Qs,d,ne)},["images/walk_512.json","images/info_level_box.png","images/view_420x1080_10.png","images/blocksBorder_12x12.png","images/blocksBorder_14x14.png","images/blocksBorder_16x16.png","images/b_info_up.png","images/b_info_over.png","images/b_scene_up.png","images/b_scene_over.png","images/b_scene_top_up.png","images/b_scene_top_over.png","images/b_play_up.png","images/b_play_over.png","images/b_reset.png","images/b_login.png","images/infogame_1024x511_1.png","images/infogame_1024x511_border_1.png","images/yo_level_512.png","images/save_img_1.png","images/save_img_in_1.png","images/save_ok_512_up.png","images/save_ok_512_over.png","images/save_cancel_512_up.png","images/save_cancel_512_over.png","images/save_512_up.png","images/save_512_over.png","images/save_512_in_up.png","images/save_512_in_over.png","images/save_512_out_up.png","images/save_512_out_over.png","images/infogame_512_up.png","images/infogame_512_over.png","images/restart_512_up.png","images/restart_512_over.png","images/pause_512_up.png","images/pause_512_over.png","images/pause_on_512_up.png","images/pause_on_512_over.png","images/home_512_up.png","images/home_512_over.png","images/next_512_up.png","images/next_512_over.png","images/menu_512_up.png","images/menu_512_over.png","images/menu_open_512_up.png","images/menu_open_512_over.png","images/b_music_512_up.png","images/b_music_512_over.png","images/b_music_512_on_up.png","images/b_music_512_on_over.png","images/road_512.png","images/forest_512.png","images/forest.png","images/forest24.jpg","images/box_512.png","images/bananas_0_512.png","images/bananas_512_neutral.png","images/fond_ecran_950.jpg","images/emoji_yo.png","fonts/puzzler.otf","images/pad_512_up_up.png","images/pad_512_up_over.png","images/pad_512_down_up.png","images/pad_512_down_over.png","images/pad_512_right_up.png","images/pad_512_right_over.png","images/pad_512_left_up.png","images/pad_512_left_over.png","images/step_512_neutral.png","images/time_512_neutral.png","images/fullscreen_on_512_up.png","images/fullscreen_on_512_over.png","images/fullscreen_off_512_up.png","images/fullscreen_off_512_over.png","images/sound_yes_240_up.png","images/sound_yes_240_over.png","images/sound_no_240_up.png","images/sound_no_240_over.png","images/b_about_up_128.png","images/b_about_over_128.png","images/checked_512_up.png","images/checked_512_over.png","images/checked_box_512.png","images/border_200x400.png","images/box_msg_border_960xx540_convert.png","images/box_msg_back_960xx540_10.png","images/box_msg_ok_512_up.png","images/box_msg_ok_512_over.png","sounds/tamtam.mp3","sounds/eatbananas.wav","sounds/hit_wall.wav","sounds/push.wav","sounds/push2.wav"],function(){0===C.progressBar.counter&&(C.progressBar.setBackgroundColor("#FFA80F"),C.progressBar.setForegroundColor("#FFEC4B"),C.progressBar.create(C.canvas,C.assets,C.canvas.width/2,100));C.progressBar.update()})),lt=(W.appendChild(C.canvas),window.loginHide=(e,s,t)=>{F(),D.classList.remove("show"),D.classList.add("hide"),W.focus(),"yotesteur"===s&&"Yo&Testeur"===t?(J=!0,Nt("Good username","Good password","Let's go!")):(Nt("Something goes wrong","Check username and password","Retry!"),J=!1)},window.infoHide=e=>{F(),j.classList.remove("show"),j.classList.add("hide"),W.focus()},window.about=e=>{F(),N.src="./html_page/about.html"},window.general=e=>{F(),N.src="./html_page/general.html"},window.buttonsExplained=e=>{F(),N.src="./html_page/buttonsexplained.html"},window.spareButton=e=>{F(),N.src="./html_page/sparebutton.html",F()},C.keyboard(37)),ct=C.keyboard(100),dt=C.keyboard(38),ht=C.keyboard(104),_t=C.keyboard(39),ut=C.keyboard(102),mt=C.keyboard(40),vt=C.keyboard(98),xt=C.keyboard(87),wt=C.keyboard(65),bt=C.keyboard(83),yt=C.keyboard(68),ft=C.keyboard(73),St=C.keyboard(74),kt=C.keyboard(75),zt=C.keyboard(76);function Yt(){0===Y.bananasToEat&&(C.pause(),C.endGame(),C.wait(1e3).then(()=>Et()))}function Et(){Mt("end"),ne.value=!1,ts.visible&&ts.press(),ne.value=!0,w.visible=!0,c.interactive=!0,o.interactive=!0}function Xt(){F(),w.visible&&(w.visible=!1,c.interactive=!1,o.interactive=!1,Us.forEach(e=>e.interactive=!0)),setTimeout(()=>{l.visible?(l.visible=!1,l.interactive=!1,e.visible=!0,e.interactive=!0,C.fadeIn(e,30),C.fadeOut(l,30),te.classList.remove("hide"),te.classList.add("show")):(l.visible=!0,l.interactive=!0,e.visible=!1,e.interactive=!1,C.fadeIn(l,30),C.fadeOut(e,30),te.classList.remove("show"),te.classList.add("hide"))},200)}function $t(e,s){if(e<1&&4<e)throw new Error(`This level : ${e} is not developped yet.`);if(1===e){if(s<1||9<s)throw new Error(`This level : ${s} is not developped yet.`);ce=de=12}else if(2===e){if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=14}else{if(3!==e)throw new Error(`This scene : ${e} is not developped yet.`);if(s<1||9<s)throw new Error(`This levelToSet : ${s} is not developped yet.`);ce=de=16}if(Js=O.level[e-1][s-1],L=s,$=e,1<s&&3===e&&!J)Nt("You are not allowed","to continue.","Not a tester."),--L;else{if(1e3<r.t&&(a.t=Object.values(r)[0],a.s=Object.values(r)[1],a.b=Object.values(r)[2]),Oe.remove(n),Y.bananasToEat=0,n=C.gridSpecial(ce,de,pe,le,Js,Fe,Y,E,g.scaleFactor(),!1,0,0),Y.activeSprite=E[4],Y.setVisible(),(X=[]).push({x:Y.activeSprite.gridX,y:Y.activeSprite.gridY,d:"s"}),C.setYo(Y),C.setStepArray(X),Mt("resetAll"),r.t=0,r.s=0,r.b=Y.bananasToEat,Rt(),C.setGameInfo(r),Ct(),1===$)je.visible=!0,Ne.visible=!1,De.visible=!1,n.addChild(je);else if(2===$)je.visible=!1,Ne.visible=!0,De.visible=!1,n.addChild(Ne);else{if(3!==$)throw new Error(`Scene playing : ${$} not possible.`);je.visible=!1,Ne.visible=!1,De.visible=!0,n.addChild(De)}Oe.addChild(n),R.setScene(e,g),Ve.content=" "+(X.length-1),qe.content=" "+Y.bananasToEat}}function Lt(){0<C.soundsArrayGlobal.length&&(C.soundsArrayGlobal.length=0),(me=C.assets["sounds/eatbananas.wav"]).volume=10,(ve=C.assets["sounds/hit_wall.wav"]).loop=!1,ve.volume=1,(xe=C.assets["sounds/push.wav"]).loop=!1,xe.volume=.8,(we=C.assets["sounds/push2.wav"]).loop=!1,we.volume=1,setTimeout(()=>{R.setSoundEffect(me,ve,xe,we)},2e3),(ue=C.assets["sounds/tamtam.mp3"]).loop=!0,ue.volume=.05;["eat_bananas_sound","button_sound","move_block_sound","elephan_sound","wall_sound","tiger_sound"].forEach(e=>{C.addSoundsArray(M[e])})}function Pt(e,s){$=e,L=s,i.content=Ts[$-1],t.content="Level "+L}function It(){Ge.layer=100,Ue.layer=100,Qe.layer=100,Ge.content=`is_M=${gt} & is_T=${pt} | DPI=${rt} `,Ue.content=`WA=${window.screen.availWidth},HA=`+window.screen.availHeight,Ue.content+=` | WW=${window.innerWidth},WH=`+window.innerHeight,Ue.content+=` | VW=${visualViewport.width.toFixed(2)},VH=`+visualViewport.height.toFixed(2),Qe.content=`S_C=${g.scaleCanvas.toFixed(2)} & S_X= ${g.scaleX.toFixed(2)} & S_Y= `+g.scaleY.toFixed(2)}function Ct(){Ve.content=" "+(X.length-1),He.content=r.t<=0?" : .....":At(r.t),qe.content=" "+r.b,Cs.content=Ts[$-1],Fs.content="     "+L}function Tt(){var e=Gs*he;Zs.points=[{x:P.gx+.406*e,y:P.gy+.406*e},{x:P.gx+0*e,y:P.gy+0*e},{x:P.gx+e,y:P.gy+0*e},{x:P.gx+.6*e,y:P.gy+.406*e}],et.points=[{x:P.gx+.406*e,y:P.gy+.6*e},{x:P.gx+.6*e,y:P.gy+.6*e},{x:P.gx+e,y:P.gy+e},{x:P.gx+0*e,y:P.gy+e}],st.points=[{x:P.gx+.6*e,y:P.gy+.406*e},{x:P.gx+e,y:P.gy+0*e},{x:P.gx+e,y:P.gy+e},{x:P.gx+.6*e,y:P.gy+.6*e}],tt.points=[{x:P.gx+.406*e,y:P.gy+.406*e},{x:P.gx+.406*e,y:P.gy+.6*e},{x:P.gx+0*e,y:P.gy+e},{x:P.gx+0*e,y:P.gy+0*e}],it.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+0*e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+.6*e,y:I.gy+.406*e}],at.points=[{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+.6*e,y:I.gy+.6*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+e}],nt.points=[{x:I.gx+.6*e,y:I.gy+.406*e},{x:I.gx+e,y:I.gy+0*e},{x:I.gx+e,y:I.gy+e},{x:I.gx+.6*e,y:I.gy+.6*e}],ot.points=[{x:I.gx+.406*e,y:I.gy+.406*e},{x:I.gx+.406*e,y:I.gy+.6*e},{x:I.gx+0*e,y:I.gy+e},{x:I.gx+0*e,y:I.gy+0*e}]}function Ft(){var e=document.querySelector(":root");V.width=C.canvas.width*g.scaleCanvas,e.style.setProperty("--wait-width",V.width+"px"),e.style.setProperty("--wait-left",C.canvas.offsetLeft+"px"),e.style.setProperty("--wait-top",C.canvas.offsetTop+"px")}function Bt(){var e=document.querySelector(":root"),s=(getComputedStyle(e),Math.floor(l.width*p*g.scaleCanvas)),t=Math.floor(l.width*p*g.scaleCanvas),i=(C.canvas.offsetTop,10*g.scaleCanvas);let a=10;var n=C.canvas.offsetTop+l.y*g.scaleY,o=C.canvas.offsetLeft+(l.width*p+10)*g.scaleX;gt&&(Ot(),a=5),e.style.setProperty("--btn-width",s+"px"),e.style.setProperty("--btn-height",t+"px"),e.style.setProperty("--menu-top",n+"px"),e.style.setProperty("--menu-left",o+"px"),e.style.setProperty("--menu-gap",i+"px"),e.style.setProperty("--border-iframe",a+"px")}function Ot(){var e=C.canvas.offsetTop+l.height*p*g.scaleCanvas+10,s=.95*(window.innerHeight-e),t=.8*window.innerWidth,i=document.getElementById("infoframe").contentWindow.document.querySelector(":root"),i=(gt&&(i.style.setProperty("--font-p","15px"),i.style.setProperty("--margin-p-v","5px"),i.style.setProperty("--margin-p-h","10px"),i.style.setProperty("--font-header","15px"),i.style.setProperty("--font-footer","15px"),i.style.setProperty("--font-buttons","12px"),i.style.setProperty("--btn-width","100px"),i.style.setProperty("--bnt-height","25px"),i.style.setProperty("--img-w","64px"),i.style.setProperty("--img-h","64px"),i.style.setProperty("--margin-flex","5%"),i.style.setProperty("--margin-line","5px")),.1*window.innerWidth);j.style.top=e+"px",j.style.width=t+"px",j.style.height=s+"px",j.style.margin=`0  ${i}px`}function Rt(){H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=q?{...q}:{t:0,bt:-1,s:0,bs:-1,b:-1,bb:-1}}function At(e){var e=(e/1e3).toFixed(1),s=e.toString().substring(e.toString().indexOf(".")+1),e=Math.floor(e),t=Math.floor(e/60);let i="0",a=9<t?"":"0";return 9<e%60&&(i=""),t<=0?""+i+e%60+"."+s:""+a+t+`:${i}${e%60}.`+s}function Mt(e){let s={};function t(a,n){var e="40px puzzler";let s=void 0,t=void 0,i=void 0;if(0===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*T(e,"?").width):(s=+(n.first/1e3).toFixed(1),x[a][0].content=At(n.first),x[a][0].x=272-.5*T(e,At(n.first)).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*T(e,"?").width):(t=+(n.second/1e3).toFixed(1),x[a][1].content=At(n.second),x[a][1].x=480-.5*T(e,At(n.second)).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*T(e,"?").width):(i=+(n.third/1e3).toFixed(1),x[a][2].content=At(n.third),x[a][2].x=672-.5*T(e,At(n.third)).width);else if(1===a)n.first<0?(x[a][0].content="?",x[a][0].x=272-.5*T(e,"?").width):(s=n.first,x[a][0].content=n.first.toString(),x[a][0].x=272-.5*T(e,n.first.toString()).width),n.second<=0?(x[a][1].content="?",x[a][1].x=480-.5*T(e,"?").width):(t=n.second,x[a][1].content=n.second.toString(),x[a][1].x=480-.5*T(e,n.second.toString()).width),n.third<=0?(x[a][2].content="?",x[a][2].x=672-.5*T(e,"?").width):(i=n.third,x[a][2].content=n.third.toString(),x[a][2].x=672-.5*T(e,n.third.toString()).width);else if(2===a){let e=void 0,s=void 0,t=void 0,i=void 0;n.first<0?(x[a][0].content="?",x[a][0].x=405,x[a][1].content="?"):(e=n.first,x[a][0].content=n.first.toString(),x[a][0].x=415-10*n.first.toString().length),n.second<0?(x[a][2].content="?",x[a][2].x=854):(s=n.second,x[a][2].content=n.second.toString(),x[a][2].x=864-10*n.second.toString().length),void 0!==e&&void 0!==s&&(n.first===n.second?x[a][1].content="=":n.first<n.second?x[a][1].content="<":x[a][1].content=">"),n.third<0?(x[a][4].content="?",x[a][4].x=1290,x[a][3].content="?",x[a][5].content="?"):(t=n.third,x[a][4].content=n.third.toString(),x[a][4].x=1300-10*n.third.toString().length),void 0!==s&&void 0!==t&&(n.second===n.third?x[a][3].content="=":n.second<n.third?x[a][3].content="<":x[a][3].content=">"),n.fourth<0?(x[a][6].content="?",x[a][6].x=1706,x[a][5].content="?"):(i=n.fourth,x[a][6].content=n.fourth.toString(),x[a][6].x=1716-10*n.fourth.toString().length),void 0!==t&&void 0!==i&&(n.third===n.fourth?x[a][5].content="=":n.third<n.fourth?x[a][5].content="<":x[a][5].content=">")}}!async function(){var e;navigator.storage&&navigator.storage.estimate&&((e=await navigator.storage.estimate()).usage,e.quota,e=e.quota-e.usage,g.quota=(e/1024/1024).toFixed(1))}();function i(){s.first=r.t,s.second=a.bt,s.third=_e[$-1][L-1].csec,t(0,s),s.first=r.s,s.second=a.bs,s.third=_e[$-1][L-1].s,t(1,s)}"restart"===e||"infoBtn"===e?i():"end"===e&&(a.bt=Math.min(a.bt<=0?1/0:a.bt,r.t),a.bs=Math.min(a.bs<=0?1/0:a.bs,r.s),a.bb=Math.min(a.bb<=0?1/0:a.bb,r.b),a.t=r.t,a.s=r.s,a.b=r.b,localStorage.setItem(`data${$}${L}_gl`,JSON.stringify(a)),localStorage.setItem(`ended_${$}_`+L,"1"),i())}function T(e,s){return C.canvas.ctx.font=e,{width:C.canvas.ctx.measureText(s).width,height:C.canvas.ctx.measureText("M").width}}function Wt(e,s,t,i,a){let n="40px puzzler",o="60px puzzler";gt&&(n="40px puzzler",o="50px puzzler"),K=Z=!1,H=JSON.parse(localStorage.getItem(`data${$}${L}_g`)),q=JSON.parse(localStorage.getItem(`data${$}${L}_gl`)),G=JSON.parse(localStorage.getItem(`data${$}${L}_s`)),a=H?(U=!0,Q=!0,e="Open the game !",s=Ts[$-1]+" Level:"+L,t="Time : "+At(H.t),i="Steps : "+H.s,"Bananas : "+H.b):(U=!1,Q=!1,e="Save the game !",s=Ts[$-1]+" Level:"+L,t="Time : "+At(r.t),i="Steps : "+r.s,"Bananas : "+r.b),ms.font=o,ms.content=e,ms.width=T(o,e).width,ms.height=T(o,e).height,ms.x=.5*m.width-.5*ms.width,ms.y=32,vs.font=o,vs.content=s,vs.width=T(o,s).width,vs.height=T(o,s).height,vs.x=.5*m.width-.5*vs.width,vs.y=ms.y+ms.height+10,xs.content=t,xs.font=n,xs.width=T(n,t).width,xs.height=T(n,t).height,xs.x=.5*m.width-.5*xs.width,xs.y=vs.y+vs.height+20,ws.content=i,ws.font=n,ws.width=T(n,i).width,ws.height=T(n,i).height,ws.x=.5*m.width-.5*ws.width,ws.y=xs.y+xs.height+10,bs.content=a,bs.font=n,bs.width=T(n,a).width,bs.height=T(n,a).height,bs.x=.5*m.width-.5*bs.width,bs.y=ws.y+ws.height+10}function jt(e,s,t){let i="40px puzzler",a="60px puzzler";var n="30px puzzler",e=(gt&&(i="40px puzzler",a="50px puzzler"),ys.font=a,ys.content=e,ys.width=T(a,e).width,ys.height=T(a,e).height,ys.x=.5*v.width-.5*ys.width,ys.y=32,fs.font=a,fs.content=s,fs.width=T(a,s).width,fs.height=T(a,s).height,fs.x=.5*v.width-.5*fs.width,fs.y=ys.y+ys.height+10,Ss.content=t,Ss.font=i,Ss.width=T(i,t).width,Ss.height=T(i,t).height,Ss.x=.5*v.width-.5*Ss.width,Ss.y=fs.y+fs.height+20,gs.font=n,gs.width=T(n,"Replay > ").width,gs.height=T(n,"Replay > ").height,h.font=n,h.width=T(n," Slow: ").width,h.height=T(n," Slow: ").height,_.font=n,_.width=T(n," Fast: ").width,_.height=T(n," Fast: ").height,ps.font=n,ps.width=T(n," Faster: ").width,ps.height=T(n," Faster: ").height,ls.scaleX=ls.scaleY=.5*p,cs.scaleX=cs.scaleY=.5*p,ds.scaleX=ds.scaleY=.5*p,hs.scaleX=hs.scaleY=.5*p,h.x=gs.width,ls.x=h.x+h.width,_.x=h.x+h.width+ls.width*p*.5,cs.x=_.x+_.width,0===hs.x&&(hs.x=cs.x),ps.x=_.x+_.width+cs.width*p*.5,ds.x=ps.x+ps.width,gs.y=h.y=_.y=ps.y=ls.height*p*.5*.5-.5*gs.height,_s.y=Ss.y+Ss.height+20,gs.width+h.width+_.width+ps.width+3*cs.width*p*.5);_s.x=.5*v.width-.5*e}function Nt(e="Message 1",s="Message 2",t="Message 3"){var i="60px puzzler",e=(z.visible=!1,Ds.visible=!0,f.content=e,f.font=i,f.width=T(i,e).width,f.height=T(i,e).height,f.x=.5*b.width-.5*f.width,f.y=100,f.visible=!1,S.content=s,S.font=i,S.width=T(i,s).width,S.height=T(i,s).height,S.x=.5*b.width-.5*S.width,S.y=f.y+f.height+30,S.visible=!1,k.content=t,k.font=i,k.width=T(i,t).width,k.height=T(i,t).height,k.x=.5*b.width-.5*k.width,k.y=S.y+S.height+30,k.visible=!1,y.width=b.width,y.x=b.x,y.height=b.height,y.y=b.y,C.tweenProperty(y,"width",y.width,y.width-192,60));C.tweenProperty(y,"height",y.height,y.height-192,60),C.tweenProperty(y,"x",y.x,y.x+96,60),C.tweenProperty(y,"y",y.y,y.y+96,60),e.onComplete=()=>{z.visible=!0,z.interactive=!0,f.visible=!0,S.visible=!0,k.visible=!0}}function F(){ae&&ne.value&&A.playSoundsArray(M.button_sound)}C.start(),C.scaleToWindow(g),Ft(),window.addEventListener("resize",e=>{C.scaleToWindow(g),It(),Bt(),Ft()}),document.addEventListener("fullscreenchange",e=>{C.scaleToWindow(g),It(),(Ye=!Ye)?s.src=C.assets["images/fullscreen_off_512_over.png"].src:s.src=C.assets["images/fullscreen_on_512_over.png"].src});