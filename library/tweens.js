let tweens=[],linear=e=>e,smoothstep=e=>e*e*(3-2*e),smoothstepSquared=e=>Math.pow(e*e*(3-2*e),2),smoothstepCubed=e=>Math.pow(e*e*(3-2*e),3),acceleration=e=>e*e,accelerationCubed=e=>Math.pow(e*e,3),deceleration=e=>1-Math.pow(1-e,2),decelerationCubed=e=>1-Math.pow(1-e,3),sine=e=>Math.sin(e*Math.PI/2),sineSquared=e=>Math.pow(Math.sin(e*Math.PI/2),2),sineCubed=e=>Math.pow(Math.sin(e*Math.PI/2),2),inverseSine=e=>1-Math.sin((1-e)*Math.PI/2),inverseSineSquared=e=>1-Math.pow(Math.sin((1-e)*Math.PI/2),2),inverseSineCubed=e=>1-Math.pow(Math.sin((1-e)*Math.PI/2),3),sineComplete=e=>.5-.5*Math.cos(-e*Math.PI),weightedAverage=(e,t,n)=>(e*(n-1)+t)/n,spline=(e,t,n,a,r)=>.5*(2*n+(-t+a)*e+(2*t-5*n+4*a-r)*e*e+(3*n-t-3*a+r)*e*e*e);function cubicBezier(e,t,n,a,r){var s=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*a-3*a*e)*s+r*(s*e)}let ease={linear(e){return e},smoothstep(e){return e*e*(3-2*e)},smoothstepSquared(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed(e){return Math.pow(e*e*(3-2*e),3)},acceleration(e){return e*e},accelerationCubed(e){return Math.pow(e*e,3)},deceleration(e){return 1-Math.pow(1-e,2)},decelerationCubed(e){return 1-Math.pow(1-e,3)},sine(e){return Math.sin(e*Math.PI/2)},sineSquared(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline(e,t,n,a,r){return.5*(2*n+(-t+a)*e+(2*t-5*n+4*a-r)*e*e+(3*n-t-3*a+r)*e*e*e)}};function tweenProperty(n,a,e,t,r,s=["smoothstep"],o=!1,l=0){let i={};return"spline"===s[0]&&(i.startMagnitude=s[1],i.endMagnitude=s[2]),i.start=(e,t)=>{i.startValue=JSON.parse(JSON.stringify(e)),i.endValue=JSON.parse(JSON.stringify(t)),i.playing=!0,i.totalFrames=r,i.frameCounter=0,tweens.push(i)},i.start(e,t),i.update=()=>{let e;var t;i.playing&&(i.frameCounter<i.totalFrames?(t=i.frameCounter/i.totalFrames,e="spline"!==s[0]?ease[s](t):ease.spline(t,i.startMagnitude,0,1,i.endMagnitude),n[a]=i.endValue*e+i.startValue*(1-e),i.frameCounter+=1):i.end())},i.end=()=>{i.playing=!1,i.onComplete&&i.onComplete(),tweens.splice(tweens.indexOf(i),1),o&&wait(l).then(()=>{i.start(i.endValue,i.startValue)})},i.play=()=>i.playing=!0,i.pause=()=>i.playing=!1,i}function fadeOut(e,t=60){return tweenProperty(e,"alpha",e.alpha,0,t,["sine"])}function fadeIn(e,t=60){return tweenProperty(e,"alpha",e.alpha,1,t,["sine"])}function pulse(e,t=60,n=0){return tweenProperty(e,"alpha",e.alpha,n,t,["smoothstep"],!0)}function makeTween(e){let t={tweens:[]},n=(e.forEach(e=>{e=tweenProperty(...e);t.tweens.push(e)}),0);return t.completed=()=>{(n+=1)===t.tweens.length&&(t.onComplete&&t.onComplete(),n=0)},t.tweens.forEach(e=>{e.onComplete=()=>t.completed()}),t.pause=()=>{t.tweens.forEach(e=>{e.playing=!1})},t.play=()=>{t.tweens.forEach(e=>{e.playing=!0})},t}function slide(e,t,n,a=60,r=["smoothstep"],s=!1,o=0){return makeTween([[e,"x",e.x,t,a,r,s,o],[e,"y",e.y,n,a,r,s,o]])}function breathe(e,t,n,a=60,r=!0,s=0){return makeTween([[e,"scaleX",e.scaleX,t,a,["smoothstepSquared"],r,s],[e,"scaleY",e.scaleY,n,a,["smoothstepSquared"],r,s]])}function scale(e,t,n,a=60){return makeTween([[e,"scaleX",e.scaleX,t,a,["smoothstep"],!1],[e,"scaleY",e.scaleY,n,a,["smoothstep"],!1]])}function strobe(e,t=1.3,n=10,a=20,r=10,s=!0,o=0){return makeTween([[e,"scaleX",e.scaleX,t,r,["spline",n,a],s,o],[e,"scaleY",e.scaleY,t,r,["spline",n,a],s,o]])}function wobble(e,t=1.2,n=1.2,a=10,r=10,s=10,o=-10,l=-10,i=.98,u=!0,p=0){t=makeTween([[e,"scaleX",e.scaleX,t,a,["spline",r,s],u,p],[e,"scaleY",e.scaleY,n,a,["spline",o,l],u,p]]);return t.tweens.forEach(e=>{e.onComplete=()=>{1<e.endValue&&(e.endValue*=i,e.endValue<=1)&&(e.endValue=1,removeTween(e))}}),t}function wobbleControlComplete(e,t=1.2,n=1.2,a=10,r=10,s=10,o=-10,l=-10,i=.98,u=!0,p=0){t=makeTween([[e,"scaleX",e.scaleX,t,a,["spline",r,s],u,p],[e,"scaleY",e.scaleY,n,a,["spline",o,l],u,p]]);return t.tweens.forEach(e=>{e.onComplete=()=>{1<e.endValue&&(e.endValue*=i,e.endValue<=1)&&(e.endValue=1,removeTween(e))}}),t}function removeTween(e){e.tweens?(e.pause(),e.tweens.forEach(e=>{tweens.splice(tweens.indexOf(e),1)})):(e.pause(),tweens.splice(tweens.indexOf(e),1))}function followCurve(a,e,t,r=["smoothstep"],n=!1,s=0){let o={};return"spline"===r[0]&&(o.startMagnitude=r[1],o.endMagnitude=r[2]),o.start=e=>{o.playing=!0,o.totalFrames=t,o.frameCounter=0,o.pointsArray=JSON.parse(JSON.stringify(e)),tweens.push(o)},o.start(e),o.update=()=>{let e,t,n=o.pointsArray;o.playing&&(o.frameCounter<o.totalFrames?(e=o.frameCounter/o.totalFrames,t="spline"!==r[0]?ease[r](e):ease.spline(e,o.startMagnitude,0,1,o.endMagnitude),a.x=cubicBezier(t,n[0][0],n[1][0],n[2][0],n[3][0]),a.y=cubicBezier(t,n[0][1],n[1][1],n[2][1],n[3][1]),o.frameCounter+=1):o.end())},o.end=()=>{o.playing=!1,o.onComplete&&o.onComplete(),tweens.splice(tweens.indexOf(o),1),n&&wait(s).then(()=>{o.pointsArray=o.pointsArray.reverse(),o.start(o.pointsArray)})},o.pause=()=>{o.playing=!1},o.play=()=>{o.playing=!0},o}function walkPath(a,e,t=300,r=["smoothstep"],s=!1,o=!1,l=0){let i=JSON.parse(JSON.stringify(e)),u=t/i.length;return function e(t){let n=makeTween([[a,"x",i[t][0],i[t+1][0],u,r],[a,"y",i[t][1],i[t+1][1],u,r]]);n.onComplete=()=>{(t+=1)<i.length-1?wait(l).then(()=>{n=e(t)}):s&&(o&&i.reverse(),wait(l).then(()=>{t=0,a.x=i[0][0],a.y=i[0][1],n=e(t)}))};return n}(0)}function walkCurve(a,r,e=300,s=["smoothstep"],o=!1,l=!1,i=0){let u=e/r.length;return function e(t){let n=followCurve(a,r[t],u,s);n.onComplete=()=>{(t+=1)<r.length?wait(i).then(()=>{n=e(t)}):o&&(l&&(r.reverse(),r.forEach(e=>e.reverse())),wait(i).then(()=>{t=0,a.x=r[0][0],a.y=r[0][1],n=e(t)}))};return n}(0)}function wait(n=0){return new Promise((e,t)=>{setTimeout(e,n)})}export{tweens,tweenProperty,fadeOut,fadeIn,pulse,makeTween,slide,breathe,scale,strobe,wobble,wobbleControlComplete,removeTween,followCurve,walkPath,walkCurve};