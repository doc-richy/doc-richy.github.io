import*as t from"./tweens.js";import*as s from"./sounds.js";import*as play from"./gamesounds.js";import"./typedef.js";let scene=void 0,gridDimension=void 0,stepWidth=void 0,standard=void 0;function setScene(e,t){if(scene=e,stepWidth=t.boxSize,standard=t,1===scene)gridDimension=12;else if(2===scene)gridDimension=14;else{if(3!==scene)throw new Error(`This data: ${scene} is not allowed for scene.`);gridDimension=16}}function moveScene(r,p,d,e){let $,_,o,n,k,q,c,v,A,B,G,l,H,J,K,S;$=e[0],_=e[1],o=e[2],n=e[3],k=e[4],q=e[5],c=e[6],v=e[7],A=e[8],B=e[9],G=e[10],l=e[11],H=e[12],J=e[13],K=e[14],S=e[15];let y,g,b,i,a,L,x,h,X,Y,w,N,f,m,P,z,W,Q,I,F,M,u,E,R;if(scene&&1===scene)"right"===r?(y=p.children.filter(e=>e.gridX===d.activeSprite.gridX+1&&e.gridY===d.activeSprite.gridY),g=p.children.filter(e=>e.gridX===d.activeSprite.gridX+2&&e.gridY===d.activeSprite.gridY),i=y[0],a=g[0],i?"road"===i.type||"bananas"===i.type?T("road",i,a):"box"===i.type&&a&&"road"===a.type?T("box",i,a):"box"===i.type&&a&&"bananas"===a.type?T("bananas",i,a):O():O()):"left"===r?(x=p.children.filter(e=>e.gridX===d.activeSprite.gridX-1&&e.gridY===d.activeSprite.gridY),h=p.children.filter(e=>e.gridX===d.activeSprite.gridX-2&&e.gridY===d.activeSprite.gridY),Y=x[0],w=h[0],Y?"road"===Y.type||"bananas"===Y.type?C("road",Y,w):"box"===Y.type&&w&&"road"===w.type?C("box",Y,w):"box"===Y.type&&w&&"bananas"===w.type?C("bananas",Y,w):O():O()):"up"===r?(f=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY-1),m=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY-2),z=f[0],W=m[0],z?"road"===z.type||"bananas"===z.type?D("road",z,W):"box"===z.type&&W&&"road"===W.type?D("box",z,W):"box"===z.type&&W&&"bananas"===W.type?D("bananas",z,W):O():O()):"down"===r&&(I=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY+1),F=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY+2),u=I[0],E=F[0],u?"road"===u.type||"bananas"===u.type?V("road",u,E):"box"===u.type&&E&&"road"===E.type?V("box",u,E):"box"===u.type&&E&&"bananas"===E.type?V("bananas",u,E):O():O());else{if(!(scene&&1<scene))throw new Error("The scene is not define properly =>>> "+scene);"right"===r?(y=p.children.filter(e=>e.gridX===d.activeSprite.gridX+1&&e.gridY===d.activeSprite.gridY),g=p.children.filter(e=>e.gridX===d.activeSprite.gridX+2&&e.gridY===d.activeSprite.gridY),b=p.children.filter(e=>e.gridX===d.activeSprite.gridX+3&&e.gridY===d.activeSprite.gridY),i=y[0],a=g[0],L=b[0],i?"road"===i.type||"bananas"===i.type?T("road",i,a):"box"===i.type&&a?"road"===a.type?T("box",i,a):"bananas"===a.type?T("bananas",i,a):"box"===a.type&&L?"road"===L.type?T("2boxes",i,a):"bananas"===L.type?T("2boxesbananas",i,a):O():O():O():O()):"left"===r?(x=p.children.filter(e=>e.gridX===d.activeSprite.gridX-1&&e.gridY===d.activeSprite.gridY),h=p.children.filter(e=>e.gridX===d.activeSprite.gridX-2&&e.gridY===d.activeSprite.gridY),X=p.children.filter(e=>e.gridX===d.activeSprite.gridX-3&&e.gridY===d.activeSprite.gridY),Y=x[0],w=h[0],N=X[0],Y?"road"===Y.type||"bananas"===Y.type?C("road",Y,w):"box"===Y.type&&w?"road"===w.type?C("box",Y,w):"bananas"===w.type?C("bananas",Y,w):"box"===w.type&&N?"road"===N.type?C("2boxes",Y,w):"bananas"===N.type?C("2boxesbananas",Y,w):O():O():O():O()):"up"===r?(f=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY-1),m=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY-2),P=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY-3),z=f[0],W=m[0],Q=P[0],z?"road"===z.type||"bananas"===z.type?D("road",z,W):"box"===z.type&&W?"road"===W.type?D("box",z,W):"bananas"===W.type?D("bananas",z,W):"box"===W.type&&Q?"road"===Q.type?D("2boxes",z,W):"bananas"===Q.type?D("2boxesbananas",z,W):O():O():O():O()):"down"===r&&(I=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY+1),F=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY+2),M=p.children.filter(e=>e.gridX===d.activeSprite.gridX&&e.gridY===d.activeSprite.gridY+3),u=I[0],E=F[0],R=M[0],u?"road"===u.type||"bananas"===u.type?V("road",u,E):"box"===u.type&&E?"road"===E.type?V("box",u,E):"bananas"===E.type?V("bananas",u,E):"box"===E.type&&R?"road"===R.type?V("2boxes",u,E):"bananas"===R.type?V("2boxesbananas",u,E):O():O():O():O())}function T(e,i,a){var r;1<scene&&5<=d.activeSprite.gridX&&1550<p.x+p.width&&(p.x-=stepWidth),"road"===e?(d.activeSprite=d.activeSprite===B?A:B,j(i)):"box"===e?(d.activeSprite=d.activeSprite===l?G:l,j(i),y[0].type="road",a.type="box",y[1].x+=stepWidth,y[1].gridX+=1):"bananas"===e?(d.activeSprite=d.activeSprite===l?G:l,--d.bananasToEat,j(i),y[0].type="road",g[0].type="forest",(a=g[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=y[1]).x+=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(y[1]),p.remove(g[0]),p.remove(g[1])}):"2boxes"===e?(d.activeSprite=d.activeSprite===l?G:l,j(i),y[0].type="road",y[1].x+=stepWidth,y[1].gridX+=1,g[1].x+=stepWidth,g[1].gridX+=1,b[0].type="box"):"2boxesbananas"===e?(d.activeSprite=d.activeSprite===l?G:l,--d.bananasToEat,j(i),y[0].type="road",y[1].x+=stepWidth,y[1].gridX+=1,b[0].type="forest",(a=b[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=g[1]).x+=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(g[1]),p.remove(b[0]),p.remove(b[1])}):O()}function C(e,i,a){var r;1<scene&&d.activeSprite.gridX<=gridDimension-6&&p.x<-32&&(p.x+=stepWidth),"road"===e?(d.activeSprite=d.activeSprite===J?H:J,j(i)):"box"===e?(d.activeSprite=d.activeSprite===S?K:S,j(i),x[0].type="road",a.type="box",x[1].x-=stepWidth,--x[1].gridX):"bananas"===e?(d.activeSprite=d.activeSprite===S?K:S,--d.bananasToEat,j(i),x[0].type="road",h[0].type="forest",(a=h[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=x[1]).x-=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(x[1]),p.remove(h[0]),p.remove(h[1])}):"2boxes"===e?(d.activeSprite=d.activeSprite===S?K:S,j(i),x[0].type="road",x[1].x-=stepWidth,--x[1].gridX,h[1].x-=stepWidth,--h[1].gridX,X[0].type="box"):"2boxesbananas"===e?(d.activeSprite=d.activeSprite===S?K:S,--d.bananasToEat,j(i),x[0].type="road",x[1].x-=stepWidth,--x[1].gridX,X[0].type="forest",(a=X[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=h[1]).x-=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(h[1]),p.remove(X[0]),p.remove(X[1])}):O()}function D(e,i,a){if(1<scene&&d.activeSprite.gridY<=gridDimension-6&&p.y<-32&&(p.y+=stepWidth),"road"===e)d.activeSprite=d.activeSprite===_?$:_,j(i);else if("box"===e)d.activeSprite=d.activeSprite===n?o:n,j(i),f[0].type="road",a.type="box",f[1].y-=stepWidth,--f[1].gridY;else if("bananas"===e){d.activeSprite=d.activeSprite===n?o:n,--d.bananasToEat,j(i),f[0].type="road",m[0].type="forest";a=m[1];a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0);setTimeout(()=>{s.intervalId.forEach((e,t)=>{"eat_bananas"===e.id&&(clearInterval(s.intervalId[t].interval),s.intervalId.splice(s.intervalId.indexOf(e),1))})},2e3);var a=f[1],r=(a.y-=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0));t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(f[1]),p.remove(m[0]),p.remove(m[1])}}else"2boxes"===e?(d.activeSprite=d.activeSprite===n?o:n,j(i),f[0].type="road",f[1].y-=stepWidth,--f[1].gridY,m[1].y-=stepWidth,--m[1].gridY,P[0].type="box"):"2boxesbananas"===e?(d.activeSprite=d.activeSprite===n?o:n,--d.bananasToEat,j(i),f[0].type="road",f[1].y-=stepWidth,--f[1].gridY,P[0].type="forest",(a=P[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=m[1]).y-=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(m[1]),p.remove(P[0]),p.remove(P[1])}):O()}function V(e,i,a){var r;1<scene&&5<=d.activeSprite.gridY&&1550<p.y+p.height&&(p.y-=stepWidth),"road"===e?(d.activeSprite=d.activeSprite===q?k:q,j(i)):"box"===e?(d.activeSprite=d.activeSprite===v?c:v,j(i),I[0].type="road",a.type="box",I[1].y+=stepWidth,I[1].gridY+=1):"bananas"===e?(d.activeSprite=d.activeSprite===v?c:v,--d.bananasToEat,j(i),I[0].type="road",F[0].type="forest",(a=F[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=I[1]).y+=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(I[1]),p.remove(F[0]),p.remove(F[1])}):"2boxes"===e?(d.activeSprite=d.activeSprite===v?c:v,j(i),I[0].type="road",I[1].y+=stepWidth,I[1].gridY+=1,F[1].y+=stepWidth,F[1].gridY+=1,M[0].type="box"):"2boxesbananas"===e?(d.activeSprite=d.activeSprite===v?c:v,--d.bananasToEat,j(i),I[0].type="road",I[1].y+=stepWidth,I[1].gridY+=1,M[0].type="forest",(a=M[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=F[1]).y+=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(F[1]),p.remove(M[0]),p.remove(M[1])}):O()}function j(e){d.activeSprite.x=e.x,d.activeSprite.y=e.y,d.activeSprite.gridX=e.gridX,d.activeSprite.gridY=e.gridY,d.activeSprite.visible=!0,d.setVisible()}function O(){var e,t,i,a;"right"===r?(d.activeSprite===l?(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=G,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a):(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=l,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a),d.activeSprite.visible=!0,d.setVisible()):"left"===r?(d.activeSprite===S?(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=K,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a):(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=S,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a),d.activeSprite.visible=!0,d.setVisible()):"up"===r?(d.activeSprite===n?(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=o,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a):(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=n,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a),d.activeSprite.visible=!0,d.setVisible()):"down"===r&&(d.activeSprite===v?(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=c,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a):(e=d.activeSprite.x,t=d.activeSprite.y,i=d.activeSprite.gridX,a=d.activeSprite.gridY,d.activeSprite=v,d.activeSprite.x=e,d.activeSprite.y=t,d.activeSprite.gridX=i,d.activeSprite.gridY=a),d.activeSprite.visible=!0,d.setVisible())}}export{scene,gridDimension,stepWidth,standard,setScene,moveScene};