import*as t from"./tweens.js";import"../typedef.js";import{remove,spriteNewTransform}from"./displayClass.js";let scene=void 0,gridDimension=void 0,stepWidth=void 0,standard=void 0;function setScene(e,t){if(scene=e,stepWidth=t.boxSize,standard=t,1===scene)gridDimension=12;else if(2===scene)gridDimension=14;else{if(3!==scene)throw new Error(`This data: ${scene} is not allowed for scene.`);gridDimension=16}}function moveScene(r,p,o,e){let N,$,d,s,k,q,n,c,A,B,G,v,H,J,K,S;N=e[0],$=e[1],d=e[2],s=e[3],k=e[4],q=e[5],n=e[6],c=e[7],A=e[8],B=e[9],G=e[10],v=e[11],H=e[12],J=e[13],K=e[14],S=e[15];let l,y,g,i,a,L,b,x,h,X,Y,O,w,f,m,P,z,Q,W,F,I,M,u,R;if(scene&&1===scene)"right"===r?(l=p.children.filter(e=>e.gridX===o.activeSprite.gridX+1&&e.gridY===o.activeSprite.gridY),y=p.children.filter(e=>e.gridX===o.activeSprite.gridX+2&&e.gridY===o.activeSprite.gridY),i=l[0],a=y[0],i?"road"===i.type||"bananas"===i.type?T("road",i,a):"box"===i.type&&a&&"road"===a.type?T("box",i,a):"box"===i.type&&a&&"bananas"===a.type?T("bananas",i,a):j():j()):"left"===r?(b=p.children.filter(e=>e.gridX===o.activeSprite.gridX-1&&e.gridY===o.activeSprite.gridY),x=p.children.filter(e=>e.gridX===o.activeSprite.gridX-2&&e.gridY===o.activeSprite.gridY),X=b[0],Y=x[0],X?"road"===X.type||"bananas"===X.type?E("road",X,Y):"box"===X.type&&Y&&"road"===Y.type?E("box",X,Y):"box"===X.type&&Y&&"bananas"===Y.type?E("bananas",X,Y):j():j()):"up"===r?(w=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY-1),f=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY-2),P=w[0],z=f[0],P?"road"===P.type||"bananas"===P.type?C("road",P,z):"box"===P.type&&z&&"road"===z.type?C("box",P,z):"box"===P.type&&z&&"bananas"===z.type?C("bananas",P,z):j():j()):"down"===r&&(W=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY+1),F=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY+2),M=W[0],u=F[0],M?"road"===M.type||"bananas"===M.type?D("road",M,u):"box"===M.type&&u&&"road"===u.type?D("box",M,u):"box"===M.type&&u&&"bananas"===u.type?D("bananas",M,u):j():j());else{if(!(scene&&1<scene))throw new Error("The scene is not define properly =>>> "+scene);"right"===r?(l=p.children.filter(e=>e.gridX===o.activeSprite.gridX+1&&e.gridY===o.activeSprite.gridY),y=p.children.filter(e=>e.gridX===o.activeSprite.gridX+2&&e.gridY===o.activeSprite.gridY),g=p.children.filter(e=>e.gridX===o.activeSprite.gridX+3&&e.gridY===o.activeSprite.gridY),i=l[0],a=y[0],L=g[0],i?"road"===i.type||"bananas"===i.type?T("road",i,a):"box"===i.type&&a?"road"===a.type?T("box",i,a):"bananas"===a.type?T("bananas",i,a):"box"===a.type&&L?"road"===L.type?T("2boxes",i,a):"bananas"===L.type?T("2boxesbananas",i,a):j():j():j():j()):"left"===r?(b=p.children.filter(e=>e.gridX===o.activeSprite.gridX-1&&e.gridY===o.activeSprite.gridY),x=p.children.filter(e=>e.gridX===o.activeSprite.gridX-2&&e.gridY===o.activeSprite.gridY),h=p.children.filter(e=>e.gridX===o.activeSprite.gridX-3&&e.gridY===o.activeSprite.gridY),X=b[0],Y=x[0],O=h[0],X?"road"===X.type||"bananas"===X.type?E("road",X,Y):"box"===X.type&&Y?"road"===Y.type?E("box",X,Y):"bananas"===Y.type?E("bananas",X,Y):"box"===Y.type&&O?"road"===O.type?E("2boxes",X,Y):"bananas"===O.type?E("2boxesbananas",X,Y):j():j():j():j()):"up"===r?(w=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY-1),f=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY-2),m=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY-3),P=w[0],z=f[0],Q=m[0],P?"road"===P.type||"bananas"===P.type?C("road",P,z):"box"===P.type&&z?"road"===z.type?C("box",P,z):"bananas"===z.type?C("bananas",P,z):"box"===z.type&&Q?"road"===Q.type?C("2boxes",P,z):"bananas"===Q.type?C("2boxesbananas",P,z):j():j():j():j()):"down"===r&&(W=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY+1),F=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY+2),I=p.children.filter(e=>e.gridX===o.activeSprite.gridX&&e.gridY===o.activeSprite.gridY+3),M=W[0],u=F[0],R=I[0],M?"road"===M.type||"bananas"===M.type?D("road",M,u):"box"===M.type&&u?"road"===u.type?D("box",M,u):"bananas"===u.type?D("bananas",M,u):"box"===u.type&&R?"road"===R.type?D("2boxes",M,u):"bananas"===R.type?D("2boxesbananas",M,u):j():j():j():j())}function T(e,i,a){var r;1<scene&&5<=o.activeSprite.gridX&&1550<p.x+p.width&&(p.x-=stepWidth),"road"===e?(o.activeSprite=o.activeSprite===B?A:B,V(i)):"box"===e?(o.activeSprite=o.activeSprite===v?G:v,V(i),l[0].type="road",a.type="box",l[1].x+=stepWidth,l[1].gridX+=1):"bananas"===e?(o.activeSprite=o.activeSprite===v?G:v,--o.bananasToEat,V(i),l[0].type="road",y[0].type="forest",(a=y[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=l[1]).x+=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(l[1]),p.remove(y[0]),p.remove(y[1])}):"2boxes"===e?(o.activeSprite=o.activeSprite===v?G:v,V(i),l[0].type="road",l[1].x+=stepWidth,l[1].gridX+=1,y[1].x+=stepWidth,y[1].gridX+=1,g[0].type="box"):"2boxesbananas"===e?(o.activeSprite=o.activeSprite===v?G:v,--o.bananasToEat,V(i),l[0].type="road",l[1].x+=stepWidth,l[1].gridX+=1,g[0].type="forest",(a=g[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=y[1]).x+=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(y[1]),p.remove(g[0]),p.remove(g[1])}):j()}function E(e,i,a){var r;1<scene&&o.activeSprite.gridX<=gridDimension-6&&p.x<-32&&(p.x+=stepWidth),"road"===e?(o.activeSprite=o.activeSprite===J?H:J,V(i)):"box"===e?(o.activeSprite=o.activeSprite===S?K:S,V(i),b[0].type="road",a.type="box",b[1].x-=stepWidth,--b[1].gridX):"bananas"===e?(o.activeSprite=o.activeSprite===S?K:S,--o.bananasToEat,V(i),b[0].type="road",x[0].type="forest",(a=x[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=b[1]).x-=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(b[1]),p.remove(x[0]),p.remove(x[1])}):"2boxes"===e?(o.activeSprite=o.activeSprite===S?K:S,V(i),b[0].type="road",b[1].x-=stepWidth,--b[1].gridX,x[1].x-=stepWidth,--x[1].gridX,h[0].type="box"):"2boxesbananas"===e?(o.activeSprite=o.activeSprite===S?K:S,--o.bananasToEat,V(i),b[0].type="road",b[1].x-=stepWidth,--b[1].gridX,h[0].type="forest",(a=h[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=x[1]).x-=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(x[1]),p.remove(h[0]),p.remove(h[1])}):j()}function C(e,i,a){var r;1<scene&&o.activeSprite.gridY<=gridDimension-6&&p.y<-32&&(p.y+=stepWidth),"road"===e?(o.activeSprite=o.activeSprite===$?N:$,V(i)):"box"===e?(o.activeSprite=o.activeSprite===s?d:s,V(i),w[0].type="road",a.type="box",w[1].y-=stepWidth,--w[1].gridY):"bananas"===e?(o.activeSprite=o.activeSprite===s?d:s,--o.bananasToEat,V(i),w[0].type="road",f[0].type="forest",(a=f[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=w[1]).y-=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(w[1]),p.remove(f[0]),p.remove(f[1])}):"2boxes"===e?(o.activeSprite=o.activeSprite===s?d:s,V(i),w[0].type="road",w[1].y-=stepWidth,--w[1].gridY,f[1].y-=stepWidth,--f[1].gridY,m[0].type="box"):"2boxesbananas"===e?(o.activeSprite=o.activeSprite===s?d:s,--o.bananasToEat,V(i),w[0].type="road",w[1].y-=stepWidth,--w[1].gridY,m[0].type="forest",(a=m[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=f[1]).y-=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(f[1]),p.remove(m[0]),p.remove(m[1])}):j()}function D(e,i,a){var r;1<scene&&5<=o.activeSprite.gridY&&1550<p.y+p.height&&(p.y-=stepWidth),"road"===e?(o.activeSprite=o.activeSprite===q?k:q,V(i)):"box"===e?(o.activeSprite=o.activeSprite===c?n:c,V(i),W[0].type="road",a.type="box",W[1].y+=stepWidth,W[1].gridY+=1):"bananas"===e?(o.activeSprite=o.activeSprite===c?n:c,--o.bananasToEat,V(i),W[0].type="road",F[0].type="forest",(a=F[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(a=W[1]).y+=stepWidth,a.scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,r=t.tweenProperty(a,"rotation",a.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(a,"scaleY",a.scaleY,a.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(a,"scaleX",a.scaleX,a.scaleX+.02,60,["spline",100,1],!1,0),r.onComplete=()=>{p.remove(W[1]),p.remove(F[0]),p.remove(F[1])}):"2boxes"===e?(o.activeSprite=o.activeSprite===c?n:c,V(i),W[0].type="road",W[1].y+=stepWidth,W[1].gridY+=1,F[1].y+=stepWidth,F[1].gridY+=1,I[0].type="box"):"2boxesbananas"===e?(o.activeSprite=o.activeSprite===c?n:c,--o.bananasToEat,V(i),W[0].type="road",W[1].y+=stepWidth,W[1].gridY+=1,I[0].type="forest",(a=I[1]).scaleX=a.scaleY=standard.scaleFactor(),a.pivotX=a.pivotY=.5,a.x-=a.width/2-standard.boxSize/2,a.y-=a.height/2-standard.boxSize/2,t.tweenProperty(a,"rotation",a.rotation,-2*Math.PI,60,["spline",10,10],!1,0),(r=F[1]).y+=stepWidth,r.scaleX=r.scaleY=standard.scaleFactor(),r.pivotX=r.pivotY=.5,r.x-=r.width/2-standard.boxSize/2,r.y-=r.height/2-standard.boxSize/2,e=t.tweenProperty(r,"rotation",r.rotation,Math.PI,60,["spline",10,10],!1,0),t.tweenProperty(r,"scaleY",r.scaleY,r.scaleY+.02,60,["spline",100,1],!1,0),t.tweenProperty(r,"scaleX",r.scaleX,r.scaleX+.02,60,["spline",100,1],!1,0),e.onComplete=()=>{p.remove(F[1]),p.remove(I[0]),p.remove(I[1])}):j()}function V(e){o.activeSprite.x=e.x,o.activeSprite.y=e.y,o.activeSprite.gridX=e.gridX,o.activeSprite.gridY=e.gridY,o.activeSprite.visible=!0,o.setVisible()}function j(){var e,t,i,a;"right"===r?(o.activeSprite===v?(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=G,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a):(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=v,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a),o.activeSprite.visible=!0,o.setVisible()):"left"===r?(o.activeSprite===S?(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=K,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a):(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=S,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a),o.activeSprite.visible=!0,o.setVisible()):"up"===r?(o.activeSprite===s?(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=d,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a):(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=s,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a),o.activeSprite.visible=!0,o.setVisible()):"down"===r&&(o.activeSprite===c?(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=n,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a):(e=o.activeSprite.x,t=o.activeSprite.y,i=o.activeSprite.gridX,a=o.activeSprite.gridY,o.activeSprite=c,o.activeSprite.x=e,o.activeSprite.y=t,o.activeSprite.gridX=i,o.activeSprite.gridY=a),o.activeSprite.visible=!0,o.setVisible())}}export{scene,gridDimension,stepWidth,standard,setScene,moveScene};