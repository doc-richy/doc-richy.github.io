function keyboard(e){let t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function makePointer(e,t=1){t={element:e,scale:t,_x:0,_y:0,dragSprite:null,dragOffsetX:0,dragOffsetY:0,get x(){return this._x/this.scale},get y(){return this._y/this.scale},get centerX(){return this.x},get centerY(){return this.y},get position(){return{x:this.x,y:this.y}},isDown:!1,isUp:!0,tapped:!1,downTime:0,lastDownTime:0,doubleClick:!1,elapsedTime:0,press:void 0,release:void 0,tap:void 0,moveHandler(e){var t=e.target;return this._x=e.pageX-t.offsetLeft,this._y=e.pageY-t.offsetTop,e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},touchmoveHandler(e){var t=e.target;return this._x=e.targetTouches[0].pageX-t.offsetLeft,this._y=e.targetTouches[0].pageY-t.offsetTop,e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},downHandler(e){return Math.abs(this.lastDownTime-Date.now())<=200?this.doubleClick=!0:this.doubleClick=!1,this.isDown=!0,this.isUp=!1,this.tapped=!1,this.press&&this.press(),this.lastDownTime=Date.now(),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},touchstartHandler(e){var t=e.target;return this._x=e.targetTouches[0].pageX-t.offsetLeft,this._y=e.targetTouches[0].pageY-t.offsetTop,this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},upHandler(e){return this.elapsedTime=Math.abs(this.lastDownTime-Date.now()),this.elapsedTime<=120&&!1===this.tapped&&(this.tapped=!0,this.tap)&&this.tap(),this.isUp=!0,this.isDown=!1,this.release&&this.release(),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},touchendHandler(e){return this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<200&&!1===this.tapped&&(this.tapped=!0,this.tap)&&this.tap(),this.isUp=!0,this.isDown=!1,this.release&&this.release(),e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),!1},hitTestSprite(e){let t=!1;var s,i,r,a;return t=e.circular?(i=this.x-(e.gx+e.radius),r=this.y-(e.gy+e.radius),Math.sqrt(i*i+r*r)<e.radius):(i=Math.abs(e.pivotX*e.width*(1-e.scaleX)),r=Math.abs((1-e.pivotX)*e.width*(1-e.scaleX)),a=Math.abs(e.pivotY*e.height*(1-e.scaleY)),s=Math.abs((1-e.pivotY)*e.height*(1-e.scaleY)),i=1===e.scaleX?e.gx:e.scaleX<1?e.gx+i:e.gx-i,r=1===e.scaleX?e.gx+e.width:e.scaleX<1?e.gx+e.width-r:e.gx+e.width+r,a=1===e.scaleY?e.gy:e.scaleY<1?e.gy+a:e.gy-a,e=1===e.scaleY?e.gy+e.height:e.scaleY<1?e.gy+e.height-s:e.gy+e.height+s,this.x>i&&this.x<r&&this.y>a&&this.y<e)},hitTestPolygon(t){let e,s=void 0,i=void 0,r=void 0,a=this.x,n=this.y;if(t.length<=2)return!1;e=(n-t[0].y)*(t[1].x-t[0].x)-(a-t[0].x)*(t[1].y-t[0].y),s=e<0?"right":"left";for(let e=1;e<t.length-1;e++)if(i=(n-t[e].y)*(t[e+1].x-t[e].x)-(a-t[e].x)*(t[e+1].y-t[e].y),(r=i<0?"right":"left")!==s)return!1;return i=(n-t[t.length-1].y)*(t[0].x-t[t.length-1].x)-(a-t[t.length-1].x)*(t[0].y-t[t.length-1].y),(r=i<0?"right":"left")===s},updateDragAndDrop(t){if(this.isDown)if(null===this.dragSprite)for(let e=t.length-1;-1<e;e--){var s=t[e];if(this.hitTestSprite(s)&&s.draggable){this.dragOffsetX=this.x-s.gx,this.dragOffsetY=this.y-s.gy;var i=(this.dragSprite=s).parent.children;i.splice(i.indexOf(s),1),i.push(s),t.splice(t.indexOf(s),1),t.push(s);break}}else this.dragSprite.x=this.x-this.dragOffsetX,this.dragSprite.y=this.y-this.dragOffsetY;this.isUp&&(this.dragSprite=null),t.some(e=>this.hitTestSprite(e)&&e.draggable?(this.element.style.cursor="grab",!0):!(this.element.style.cursor="auto"))}};return e.addEventListener("mousemove",t.moveHandler.bind(t),!1),e.addEventListener("mousedown",t.downHandler.bind(t),!1),window.addEventListener("mouseup",t.upHandler.bind(t),!1),e.addEventListener("touchmove",t.touchmoveHandler.bind(t),!1),e.addEventListener("touchstart",t.touchstartHandler.bind(t),!1),window.addEventListener("touchend",t.touchendHandler.bind(t),!1),e.style.touchAction="none",t}export{keyboard,makePointer};